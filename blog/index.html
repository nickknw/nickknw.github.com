<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
    <head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
        <meta name="description" content="The latest blog posts by Nick Knowlson.">

        <meta name="twitter:card" content="summary">
        <meta name="twitter:url" content="http://nickknowlson.com/blog/index.html">
        <meta name="twitter:title" content="Blog">
        <meta name="twitter:description" content="The latest blog posts by Nick Knowlson.">
        <meta name="twitter:image" content="http://nickknowlson.com/img/logos/logox50.png">
        <meta name="twitter:site" content="@nickknw">

        <meta property="og:title" content="Blog" >
        <meta property="og:type" content="blog" >
        <meta property="og:image" content="http://nickknowlson.com/img/logos/logox200.png" >
        <meta property="og:url" content="http://nickknowlson.com/blog/index.html">
        <meta property="og:site_name" content="Nick Knowlson dot com">
        <meta property="og:description" content="The latest blog posts by Nick Knowlson.">
        <meta property="fb:admins" content="717055264" />

        <title>Blog - Nick Knowlson</title>

        <link rel="stylesheet" type="text/css" href="/css/site.css" >
        <link rel="stylesheet" type="text/css" href="/css/syntax.css" >
	<link rel="shortcut icon" href="/favicon.ico" />
	<link rel="apple-touch-icon-precomposed" href="/favicon.ico" >
        <link href="http://feeds.feedburner.com/NickKnowlson" type="application/atom+xml" rel="alternate" title="Blog ATOM Feed" />
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>
        <script type="text/javascript">
        if (typeof jQuery == 'undefined')
        {
            document.write(decodeURIComponent("%3Cscript src='/js/jquery-1.6.1.min.js' type='text/javascript'%3E%3C/script%3E"));
        }
        </script>
        

        
        <script type="text/javascript">
        // TODO: convert to css hover sometime
        $(document).ready(function () {
            $("#rss-nav-icon img").hover(function () {
                $(this).attr("src","/img/rss-icon-lit.png");
            }, function() {
                $(this).attr("src","/img/rss-icon-dim.png");
            });
            $("#twitter-nav-icon img").hover(function () {
                $(this).attr("src","/img/twitter-icon-lit.png");
            }, function() {
                $(this).attr("src","/img/twitter-icon-dim.png");
            });
        });
        </script>

        <!-- Google Analytics -->
        <script type="text/javascript">
          var _gaq = _gaq || [];

          if (document.location.hostname !== "localhost") {
              _gaq.push(['_setAccount', 'UA-24781362-1']);
              _gaq.push(['_trackPageview']);

              (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
              })();
          }
        </script>
    </head>
    <body>
	<div id="header" class="grid grid-16">
            <a href="/"><img src="/img/logos/logo6.png" alt="logo" /></a>
            <ul id="nav">
                <li><a class=" nav-link" href="/">Home</a></li>
                <li><a class=" nav-link" href="/about/">About</a></li>
                <li><a class=" nav-link" href="/projects/">Projects</a></li>
                <li><a class="selected nav-link" href="/blog/">Blog</a></li>
                <li><a class=" nav-link" href="/contact/">Contact</a></li>
                <li><a id="rss-nav-icon" href="http://feeds.feedburner.com/NickKnowlson"><img src="/img/rss-icon-dim.png" alt="link to feedburner rss" /></a></li>
                <li><a id="twitter-nav-icon" href="http://twitter.com/#!/nickknw"><img src="/img/twitter-icon-dim.png" alt="link to twitter" /></a></li>
            </ul>
	</div>

        <div id="content" class="grid grid-16" style="background-color:white; clear:both;">
            <div id="content-padding">
                <div style="text-align:center; margin-bottom:1em;"><b>Latest Posts</b> | <a href="/blog/archive/">Archive</a></div>

  <div>
  <h1 style="margin:0px"><a href="/blog/2013/04/16/why-maybe-is-better-than-null/">
  The Definitive Reference To Why Maybe Is Better Than Null
  </a></h1>
  <div class="faded" style="font-size:14px; margin-bottom:5px;">16 Apr 2013</div>
    <p>This article is divided into two parts: <a href='#explanation'>Explanation</a> and <a href='#faq'>FAQ</a>. The explanation shows the reasons why a bunch of people think Maybe is way more useful than <code>null</code>. The FAQ is a list of my responses to common arguments I&#8217;ve seen about the shortcomings of Maybe.</p>

<p>I&#8217;m going to try to not go overboard with details here - my aim is to make it accessible to as many programmers as possible, not to be as thorough as possible.</p>
<h2 id='explanation'>Explanation</h2><h3>Motivation</h3>
<p>Tony Hoare, the inventor of <code>null</code>, <a href='http://qconlondon.com/london-2009/presentation/Null+References:+The+Billion+Dollar+Mistake'>has gone on record calling it his &#8216;billion-dollar mistake&#8217;</a>. So what should replace it?</p>

<p>Maybe, at its core, is a construct that allows programmers to <strong>move null checks into the type system</strong>, so they can be enforced at <em>compile-time</em>. Instead of forgetting to deal with a null check and finding out with an exception at run-time, you forget to deal with a null check and <em>find out with an error at compile-time,</em> before anyone else even sees it! And that&#8217;s <strong>not just some null checks</strong>, that&#8217;s <strong>all of them, guaranteed!</strong></p>
<h3>Details</h3>
<p>There are two components to an environment free of null pointer exceptions:</p>

<ol>
<li>The elimination of <code>null</code>. This means that all types (even reference types!) become non-nullable.</li>

<li>An alternative representation for the idea of &#8220;may contain an empty or invalid value&#8221;. This is what Maybe is for.</li>
</ol>

<p>So how does Maybe accomplish this, and how does it achieve all those benefits listed above? It&#8217;s actually very straightforward.</p>

<p>In object-oriented terms, think of <code>Maybe</code> as a generic interface that has exactly two implementing classes: <code>Just</code> and <code>Nothing</code>. The <code>Just</code> class wraps a value of some other type and the <code>Nothing</code> class doesn&#8217;t. There are a variety of ways to extract the value safely, but I&#8217;m going to omit these for now, as they&#8217;re not the point. When you receive an object of type <code>Maybe&lt;String&gt;</code> (for example) you now have the type system helping you out, telling you &#8220;there <em>might</em> be a String here but it <em>might</em> be empty&#8221;. You <strong>can&#8217;t</strong> perform operations on the String until you&#8217;ve safely extracted it and <em>made a choice</em> about what to do in the case that its empty.</p>

<p>By itself (without point <strong>#1</strong>) this is nice but not fantastic. The benefit really kicks in when you also have non-nullable types. It simplifies the 80% of the cases that don&#8217;t involve <code>null</code> and gives significance and meaning to the times when you do deal with objects wrapped in <code>Maybe&lt;T&gt;</code>. It lets you say both <strong>&#8220;I know that this value will <em>literally never</em> be null&#8221;</strong> and <strong>&#8220;It is immediately obvious to me that I need to handle the case of an empty value here&#8221;</strong>.</p>
<h3>Conclusion</h3>
<p>It&#8217;s not that dealing with any given instance of null is particularly hard, it&#8217;s that it is <a href='http://james-iry.blogspot.ca/2013/03/king-null-stubborn.html'>so easy to miss one</a>. Removing this concern and encoding the information in the type system means programmers have less things to keep track of and simplifies control flow across the entire program. Like with memory management: when you don&#8217;t have to keep track of it manually it is just plain easier to write code. More importantly, it is easier to write <strong>more robust</strong> code. For all programmers, not just the experienced or talented.</p>

<p>And that is something I am firmly in favour of. A product is never the result of a single person&#8217;s code - everything has dependencies. Improvements to the code of others benefits all of us.</p>
<h3>Addendum</h3>
<p>There are two more points I&#8217;d like to address about Maybe that are separate from actually explaining why it is useful.</p>

<p><strong>First</strong>, I&#8217;ve been a bit inaccurate on purpose when just referring to this idea as Maybe. There is an implementation of this idea in Haskell called Maybe, but implementations in different languages have different names.</p>

<ul>
<li>ML, Scala, F#, Rust: Option</li>

<li>Fantom, Kotlin: ? appended to type</li>

<li>C#: Nullable or ? appended to type</li>
</ul>

<p><strong>Second</strong>, not all languages with Maybe have non-nullable types. This makes Maybe less valuable in those environments (since you lose the <strong>very</strong> useful &#8220;I know this value will never contain <code>null</code>&#8221; guarantee&#8221;) and ends up confusing people who are skeptical of Maybe&#8217;s benefits.</p>

<p>To help clarify this: I agree that in a language where you don&#8217;t have the guarantee provided by non-nullable types, Maybe <em>just isn&#8217;t as useful</em>. But it is not use<i>less</i> either and depending on the environment may still provide some benefit.</p>
<h2 id='faq'>FAQ</h2>
<p>Posts like these are tricky. To explain something understandably and (relatively) concisely I can&#8217;t qualify every statement and address all the holes inline. Here is where I&#8217;ll address the bits I skipped as well as some common sentiments I&#8217;ve previously seen on this topic.</p>

<p>I have made each headline a link as well so each question/answer combo can be linked to individually.</p>

<ol>
<li><a href='#maybe-shortcomings'>Maybe isn&#8217;t the be-all end-all.</a></li>

<li><a href='#ide-plugin'>My IDE plugin already does this.</a></li>

<li><a href='#hiding'>NPEs are the proper response to a missing value you forgot to consider.</a></li>

<li><a href='#real-problem'>The real problem is people not properly reasoning about their functions.</a></li>

<li><a href='#default-value'>What if a value cannot have any meaningful default value?</a></li>

<li><a href='#same-thing'>So you&#8217;re still testing against null, except that it&#8217;s called Nothing.</a></li>

<li><a href='#safe-navigation'>I think the safe navigation operator in Groovy etc. is better than Maybe.</a></li>

<li><a href='#fantom-kotlin'>What about Fantom &#38; Kotlin?</a></li>

<li><a href='#option-scala'>But Option in Scala DOESN&#8217;T save you from null!</a></li>

<li><a href='#unsafe-methods'>Safety ISN&#8217;T guaranteed because of the existence of unsafe extraction methods.</a></li>

<li><a href='#overhead'>Using Maybe is not worth the overhead.</a></li>

<li><a href='#examples'>Enough vague, high-level information. Show me some examples!</a></li>
</ol>
<h4><a class='header_link' href='#maybe-shortcomings' id='maybe-shortcomings'>Maybe isn't the be-all
end-all.</a> </h4>
<p>I definitely agree. For one thing, I haven&#8217;t even mentioned <a href='http://www.haskell.org/ghc/docs/6.12.2/html/libraries/base-4.2.0.1/Data-Either.html'>Either</a>! This article is for people who aren&#8217;t even convinced of the benefits of Maybe yet. In order to get my point across effectively I want to avoid overwhelming the reader with information, so I restricted the topics brought up here.</p>

<p>If you want a higher level perspective on this issue, take a look at <a href='http://lambda-the-ultimate.org/node/3186#comment-46637'>dmbarbour&#8217;s view:</a></p>
<blockquote>
<p>There are two mistakes. One mistake is providing a 'sum' type (eqv. to Just
Object | Nothing) without recognition of the typechecker. The other mistake
is joining this sum type at the hip with the idea of references, such that
you cannot have one without the other.</p>

<p>These mistakes may, and I suspect should, be resolved independently.
Thinking there's just one mistake, and thus just one language feature to
solve it, might very well be a third mistake.</p>
</blockquote>
<p>Beautifully stated! This is a much more general (and elegant) way to look at it. It&#8217;s a somewhat harder sentiment to communicate effectively to a lot of people though.</p>
<h4><a class='header_link' href='#ide-plugin' id='ide-plugin'>My IDE plugin already does this.</a> </h4>
<p>Yes, there are some IDEs and plugins that provide limited null reference analysis. The key though, is that it <strong>is</strong> limited. As far as I know (and I&#8217;ve looked) none of them provide the same system-wide elimination of <code>null</code> that encoding it in the type-system can guarantee.</p>

<p>And so, you still don&#8217;t get the same reassurances of &#8220;I know this value will <em>literally never</em> be null&#8221; and &#8220;It is immediately obvious that I have to handle the case of an empty value here&#8221;.</p>
<h4><a class='header_link' href='#hiding' id='hiding'>NPEs are the proper
response to a missing value you forgot to consider. You should be notified when
something goes wrong, not hide it with Maybe.</a> </h4>
<p>I&#8217;ve got good news for you - we fundamentally agree in our approach to how errors should be handled! You might have seen some bad examples of Maybe usage, since proper usage would lead to these errors being caught <em>even earlier</em> than a NullPointerException would have.</p>

<p>You can still choose to do the equivalent of <code>if (null) return;</code> and some examples <em>will do that</em>, because it makes sense to do in some contexts. What matters is that Maybe forces you to think about it at the time of <em>writing</em> the code, and to be <em>explicit</em> about it.</p>

<p>Instead of you being notified when things go wrong, Maybe forces you to <strong>think things through</strong> in the first place and make an explicit choice about what to do (at least as far as possibly empty values are concerned).</p>

<p>And finally, for those of you who really love exceptions, implementations of Maybe usually provide an unsafe retrieval method, so you can replicate the behaviour of null (run-time exceptions and all) <em>if</em> that is what you <em>choose</em> to do.</p>
<h4><a class='header_link' href='#real-problem' id='real-problem'>The real
problem is people not properly reasoning about their functions, that isn't the
fault of null.</a> </h4>
<p>Sure, that is one way to look at it: it&#8217;s not <code>null</code>&#8217;s fault, it is the programmer&#8217;s fault. If you take this view then <code>null</code> is just one of the tools used to represent emptiness and invalid values. But it isn&#8217;t a very good tool, or at least not as good as it could be.</p>

<p>Maybe is a tool that fills the same gap as <code>null</code> but is much more helpful to programmers. It helps directly address the core problem of &#8220;people not properly reasoning about their functions&#8221; by pointing out mistakes in reasoning earlier. With it you can statically verify that all null checks are made, and eliminate an entire class of run-time errors.</p>

<p>I&#8217;m not claiming it is a silver bullet, but it <strong>is</strong> a better tool.</p>
<h4><a class='header_link' href='#default-value' id='default-value'>Null is meaningful! What if a value cannot have any meaningful default value?</a> </h4>
<p>Then either wait until it has a meaningful value to put in it or wrap it in Maybe and give it a value of Nothing. That&#8217;s what Maybe is for - To provide a type-checkable alternative to <code>null</code>!</p>
<h4><a class='header_link' href='#same-thing' id='same-thing'>So you're still testing against null, except that it's called Nothing. What have we gained?</a> </h4>
<p>We have gained earlier detection of an entire class of errors! Now if there is a missed check for an empty value you will find out at compile-time rather than run-time. Using Maybe forces you to be <em>explicit</em> about possibly-empty values and <em>deal with</em> the case where they are empty.</p>

<p>The user doesn&#8217;t see <strong>any</strong> null reference exceptions, they are all fixed before they even get outside the developer&#8217;s computer.</p>
<h4><a class='header_link' href='#safe navigation' id='safe navigation'>I think the safe navigation operator in Groovy/Kotlin/Fantom/CoffeeScript is better than Maybe.</a> </h4>
<p>I&#8217;m going to talk about Kotlin and Fantom separately in the next section because they&#8217;re special.</p>

<p>In Groovy/CoffeeScript, the safe navigation operator (<code>?.</code>) lets you safely call a method or access a field on an object that may be <code>null</code>. If the object IS <code>null</code> then the method/field just returns <code>null</code> as well, instead of an exception being thrown.</p>

<p>I agree that the safe navigation operator is certainly convenient but it is solving a different problem. If you compare it directly to Maybe, it&#8217;s only solving the &#8216;retrieve value from possibly empty object&#8217; part of Maybe. This is a nice thing to have, but isn&#8217;t nearly as interesting as moving a whole class of run-time exceptions to compile-time.</p>

<p>Which is fine, it doesn&#8217;t have to be as good as Maybe to still be useful. Just don&#8217;t misrepresent it as being anything more than <strong>a convenient syntax for null checks</strong>.</p>
<h4><a class='header_link' href='#fantom-kotlin' id='fantom-kotlin'>What about Fantom &amp; Kotlin?</a> </h4>
<p>Fantom and Kotlin are different because they are both languages that have non-nullable reference types and have built Maybe in as a language feature. In both languages (<a href='http://fantom.org/doc/docLang/TypeSystem.html#nullableTypes'>Fantom</a>, <a href='http://confluence.jetbrains.com/display/Kotlin/Null-safety'>Kotlin</a>), you can distinguish a reference that may hold <code>null</code> by appending a ? to its type (i.e. <code>String?</code>). The compiler can then keep track of it as if it were a <code>Maybe&lt;String&gt;</code> and is able to prevent you from unsafely accessing its contents. They provide safe navigation and elvis operators to extract the value like Groovy does.</p>

<p>This is probably where opinions will start to differ among people who think Maybe is a good idea.</p>

<p>I personally am thrilled by the steps Fantom and Kotlin have taken and think that they are a great solution to eliminating null reference exceptions. They use the fact that they&#8217;ve implemented it as a language feature to provide really convenient and easy to understand syntax. So easy to understand, in fact, that it might not be obvious that <strong>it is the same damn thing as Maybe</strong>. The only differences are that Fantom and Kotlin have a special syntax for it baked in, and that (in exchange) it is a little bit more limited than Maybe as a library is.</p>

<p>The only downsides to this approach are related to the fact that it is specialized. When you stretch against the limits of Maybe you can&#8217;t drop in <a href='http://www.haskell.org/ghc/docs/6.12.2/html/libraries/base-4.2.0.1/Data-Either.html'>Either</a> instead. You also can&#8217;t wrap Maybes in another Maybe (<code>Maybe&lt;Maybe&lt;String&gt;&gt;</code>), which you might do when you have nested calls that could fail.</p>

<p>I can&#8217;t speak to how often this ends up being an issue for people working in Fantom/Kotlin and what alternatives the language provides because, frankly, I am pretty unfamiliar with them. If anyone with experience would like to speak up I&#8217;d be happy to annotate this section with their information.</p>
<h4><a class='header_link' href='#option-scala' id='option-scala'>But Option in Scala DOESN'T save you from null!</a> </h4>
<p>Yes, in Scala you can still get NullPointerExceptions. Scala doesn&#8217;t have non-nullable reference types because Martin Odersky (for what were probably good reasons - I&#8217;m guessing related to java interop) decided to include <code>null</code> in his language. That doesn&#8217;t invalidate all the other implementations of Maybe and it doesn&#8217;t mean it can&#8217;t still be somewhat useful in Scala.</p>

<p>Feel free to point out to people that Scala&#8217;s implementation of Option still allows for NullPointerExceptions, just don&#8217;t generalize it to &#8220;Maybe and Option aren&#8217;t useful&#8221;.</p>
<h4><a class='header_link' href='#unsafe-methods' id='unsafe-methods'>Safety ISN'T guaranteed because of the existence of unsafe extraction methods.</a> </h4>
<p>Often implementations of Maybe will include more than just safe extraction methods. Haskell&#8217;s <code>fromJust</code> and Scala&#8217;s <code>get</code> are both retrieval functions that throw runtime errors if the value wrapped in Maybe doesn&#8217;t exist. Just like how <code>null</code> usually works.</p>

<p>So it <strong>is</strong> possible to shoot yourself in the foot if you want to. The difference is you have to <strong>explicitly ask</strong> for this behaviour, it cannot sneak in by accident.</p>

<p>Whenever I claim Maybe can move null reference exceptions to compile-time, it comes with the assumption that you&#8217;re using the built-in safe extraction methods and that you&#8217;re not <em>requesting</em> run-time exceptions.</p>
<h4><a class='header_link' href='#overhead' id='overhead'>Using Maybe is not worth the overhead.</a> </h4>
<p>This is a hard question to answer without getting specific. If this was said about a specific language or kind of application and the person saying it has done their due diligence or has some working code to back it up, then I can&#8217;t address that here.</p>

<p>If it is a less qualified statement however, I have some counterpoints that I can share.</p>

<p><strong>1. Bugs are expensive, even more so the later on they are caught.</strong></p>

<p>It takes developer time to find and fix bugs - the more bugs the more time it takes. For each bug, overhead is introduced in the form of finding, tracking, fixing, and testing it. Worse, bugs that make it all the way to production impact your users and can have even more expensive consequences like data corruption. For some applications small amounts of bug-related downtime could cost thousands (or millions!) of dollars.</p>

<p>This is the whole reason why we have test suites, type systems, static analysis tools, code reviews, even exceptions! We want to catch bugs earlier.</p>

<p>Maybe lets you catch one of the most common bugs, null reference exceptions, at compile-time instead of run-time. So if you say &#8216;it is not worth the overhead&#8217;, think about what null reference exceptions are costing you first, and make sure you really <strong>do</strong> know how much it is worth.</p>

<p><strong>Unless&#8230;</strong> you are one of those lucky few who says that null reference exceptions really are just not an issue for you. Maybe your other bug prevention measures combined are good enough and when you tracked your faults you found you don&#8217;t end up dealing with null reference exceptions very much. For you guys, keep in mind that <a href='https://twitter.com/ID_AA_Carmack/status/324998304045879296'>you are probably not in the majority</a>.</p>

<p><strong>2. There might not be as much syntactic overhead as you think. In many cases it actually reduces overhead.</strong></p>

<p>Languages that provide Maybe usually provide many convenient ways to extract values which are actually often shorter than the null checks you would otherwise be writing. On top of that, code that <em>doesn&#8217;t deal</em> with possibly-empty values <em>doesn&#8217;t need</em> to use Maybe (or check for null!) at all.</p>

<p>Check out the <a href='#examples'>examples section</a> below and see for yourself what code that uses Maybe looks like.</p>

<p>For those of you that are talking about having to mark too many properties as optional and having to deal with Maybe everywhere, think about it like this: You would have had to deal with the same amount of possibly-empty values either way, the only difference is that now you have the compiler helping you out. If your code is meant to be robust it will need null checks anyway. For the cost of adding a little wrapper around your types you can replace those easy-to-forget null checks with their equivalent compiler-checked Maybe extraction methods.</p>

<p>You also get perfect safety and ease of mind when dealing with values that cannot logically be empty.</p>
<h4><a class='header_link' href='#examples' id='examples'>Enough vague,
high-level information. Show me some examples!</a> </h4>
<p>I intentionally avoided showing examples in the explanation section to avoid taking attention away from the main points. For a topic like this one, as soon as you show some code it is like sticking a bikeshedding magnet right in the middle of your article. But since this post is aiming to be a definitive reference, it could use at least a few examples.</p>

<p>Another measure I am going to be taking to avoid stirring up unnecessary arguments is <em>comparing like with like</em>. I will show a scenario where null checks are used to deal with an empty value in a certain way, then I will show what that example would look like in a language with good support for Maybe.</p>

<p>The languages I picked are:</p>

<ul>
<li><strong>Java:</strong> to represent the traditional ways of handling nulls that most people are hopefully familiar with.</li>

<li><strong>Kotlin:</strong> to represent languages with non-nullable references and support for Maybe baked into the language.</li>

<li><strong>Haskell:</strong> to represent languages with non-nullable references and support for Maybe as a library.</li>
</ul>

<p>The scenarios follow:</p>

<p><strong>Dealing with it explicitly</strong></p>
<p class='code-header'>Java:</p><div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kd'>static</span> <span class='kt'>void</span> <span class='nf'>retrieveInfoExplicit</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='n'>String</span> <span class='n'>information</span> <span class='o'>=</span> <span class='k'>new</span> <span class='n'>Random</span><span class='o'>().</span><span class='na'>nextInt</span><span class='o'>(</span><span class='mi'>2</span><span class='o'>)</span> <span class='o'>==</span> <span class='mi'>0</span> <span class='o'>?</span> <span class='s'>&quot;a,b,c&quot;</span> <span class='o'>:</span> <span class='kc'>null</span><span class='o'>;</span>

    <span class='k'>if</span> <span class='o'>(</span><span class='n'>information</span> <span class='o'>==</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='n'>System</span><span class='o'>.</span><span class='na'>out</span><span class='o'>.</span><span class='na'>println</span><span class='o'>(</span><span class='s'>&quot;No information received.&quot;</span><span class='o'>);</span>
    <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
        <span class='n'>System</span><span class='o'>.</span><span class='na'>out</span><span class='o'>.</span><span class='na'>println</span><span class='o'>(</span><span class='n'>Arrays</span><span class='o'>.</span><span class='na'>toString</span><span class='o'>(</span><span class='n'>parseInfo</span><span class='o'>(</span><span class='n'>information</span><span class='o'>)));</span>
    <span class='o'>}</span>
<span class='o'>}</span>
</code></pre></div><p class='code-header'>Kotlin:</p><div class='highlight'><pre><code class='kotlin'><span class='k'>fun</span> <span class='nf'>retrieveInfoExplicit</span><span class='p'>()</span> <span class='p'>:</span> <span class='n'>Unit</span> <span class='p'>{</span>
    <span class='k'>val</span> <span class='n'>information</span> <span class='p'>=</span> <span class='k'>if</span> <span class='p'>(</span><span class='n'>Random</span><span class='p'>().</span><span class='n'>nextInt</span><span class='p'>(</span><span class='m'>2</span><span class='p'>)</span> <span class='p'>==</span> <span class='m'>0</span><span class='p'>)</span> <span class='s'>&quot;a,b,c&quot;</span> <span class='k'>else</span> <span class='k'>null</span>

    <span class='k'>if</span> <span class='p'>(</span><span class='n'>information</span> <span class='p'>==</span> <span class='k'>null</span><span class='p'>)</span>
        <span class='n'>println</span><span class='p'>(</span><span class='s'>&quot;No information received.&quot;</span><span class='p'>)</span>
    <span class='k'>else</span>
        <span class='nf'>safeParseInfo</span><span class='p'>(</span><span class='n'>information</span><span class='p'>)</span> <span class='n'>forEach</span> <span class='p'>{</span> <span class='n'>println</span><span class='p'>(</span><span class='n'>it</span><span class='p'>)</span> <span class='p'>}</span>
<span class='p'>}</span>
</code></pre></div><p class='code-header'>Haskell:</p><div class='highlight'><pre><code class='haskell'><span class='nf'>retrieveInfoExplicit</span> <span class='ow'>::</span> <span class='kt'>IO</span> <span class='nb'>()</span>
<span class='nf'>retrieveInfoExplicit</span> <span class='ow'>=</span> <span class='kr'>do</span>
    <span class='n'>num</span> <span class='ow'>&lt;-</span> <span class='n'>randomRIO</span> <span class='p'>(</span><span class='mi'>0</span><span class='p'>,</span> <span class='mi'>1</span><span class='p'>)</span>
    <span class='kr'>let</span> <span class='n'>information</span> <span class='ow'>=</span> <span class='kr'>if</span> <span class='p'>(</span><span class='n'>num</span> <span class='ow'>::</span> <span class='kt'>Int</span><span class='p'>)</span> <span class='o'>==</span> <span class='mi'>0</span> <span class='kr'>then</span> <span class='p'>(</span><span class='kt'>Just</span> <span class='s'>&quot;a,b,c&quot;</span><span class='p'>)</span> <span class='kr'>else</span> <span class='kt'>Nothing</span>
    <span class='kr'>case</span> <span class='n'>information</span> <span class='kr'>of</span>
        <span class='kt'>Nothing</span> <span class='ow'>-&gt;</span> <span class='n'>putStrLn</span> <span class='s'>&quot;No information retrieved.&quot;</span>
        <span class='kt'>Just</span> <span class='n'>i</span> <span class='ow'>-&gt;</span> <span class='n'>putStrLn</span> <span class='o'>$</span> <span class='n'>show</span> <span class='o'>$</span> <span class='n'>safeParseInfo</span> <span class='n'>i</span>
</code></pre></div>
<p><strong>Dealing with it implicitly</strong></p>
<p class='code-header'>Java:</p><div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>retrieveInfo</span><span class='o'>()</span> <span class='o'>{</span>
    <span class='n'>String</span> <span class='n'>information</span> <span class='o'>=</span> <span class='n'>Random</span><span class='o'>().</span><span class='na'>nextInt</span><span class='o'>(</span><span class='mi'>2</span><span class='o'>)</span> <span class='o'>==</span> <span class='mi'>0</span> <span class='o'>?</span> <span class='s'>&quot;a,b,c&quot;</span> <span class='o'>:</span> <span class='kc'>null</span>
    <span class='n'>parseInfo</span><span class='o'>(</span><span class='n'>information</span><span class='o'>);</span>
<span class='o'>}</span>
</code></pre></div><p class='code-header'>Kotlin:</p><div class='highlight'><pre><code class='kotlin'><span class='k'>fun</span> <span class='nf'>retrieveInfo</span><span class='p'>()</span> <span class='p'>:</span> <span class='n'>Unit</span> <span class='p'>{</span>
    <span class='k'>val</span> <span class='n'>information</span> <span class='p'>=</span> <span class='k'>if</span> <span class='p'>(</span><span class='n'>Random</span><span class='p'>().</span><span class='n'>nextInt</span><span class='p'>(</span><span class='m'>2</span><span class='p'>)</span> <span class='p'>==</span> <span class='m'>0</span><span class='p'>)</span> <span class='s'>&quot;a,b,c&quot;</span> <span class='k'>else</span> <span class='k'>null</span>
    <span class='n'>parseInfo</span><span class='p'>(</span><span class='n'>information</span><span class='p'>)?.</span><span class='n'>forEach</span> <span class='p'>{</span> <span class='n'>println</span><span class='p'>(</span><span class='n'>it</span><span class='p'>)</span> <span class='p'>}</span>
<span class='p'>}</span>
</code></pre></div><p class='code-header'>Haskell:</p><div class='highlight'><pre><code class='haskell'><span class='nf'>retrieveInfo</span> <span class='ow'>::</span> <span class='kt'>IO</span> <span class='nb'>()</span>
<span class='nf'>retrieveInfo</span> <span class='ow'>=</span> <span class='kr'>do</span>
    <span class='n'>num</span> <span class='ow'>&lt;-</span> <span class='n'>randomRIO</span> <span class='p'>(</span><span class='mi'>0</span><span class='p'>,</span> <span class='mi'>1</span><span class='p'>)</span>
    <span class='kr'>let</span> <span class='n'>information</span> <span class='ow'>=</span> <span class='kr'>if</span> <span class='p'>(</span><span class='n'>num</span> <span class='ow'>::</span> <span class='kt'>Int</span><span class='p'>)</span> <span class='o'>==</span> <span class='mi'>0</span> <span class='kr'>then</span> <span class='p'>(</span><span class='kt'>Just</span> <span class='s'>&quot;a,b,c&quot;</span><span class='p'>)</span> <span class='kr'>else</span> <span class='kt'>Nothing</span>
    <span class='n'>putStrLn</span> <span class='o'>$</span> <span class='n'>show</span> <span class='o'>$</span> <span class='n'>parseInfo</span> <span class='n'>information</span>
</code></pre></div>
<p><strong>Returning null as well (e.g. guard statements)</strong></p>
<p class='code-header'>Java:</p><div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='n'>String</span><span class='o'>[]</span> <span class='nf'>parseInfo</span><span class='o'>(</span><span class='n'>String</span> <span class='n'>information</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='k'>if</span> <span class='o'>(</span><span class='n'>information</span> <span class='o'>==</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='k'>return</span> <span class='kc'>null</span><span class='o'>;</span>
    <span class='o'>}</span>

    <span class='k'>return</span> <span class='n'>information</span><span class='o'>.</span><span class='na'>split</span><span class='o'>(</span><span class='s'>&quot;,&quot;</span><span class='o'>);</span>
<span class='o'>}</span>
</code></pre></div><p class='code-header'>Kotlin:</p><div class='highlight'><pre><code class='kotlin'><span class='c1'>// Can choose to imitate java...</span>
<span class='k'>fun</span> <span class='nf'>parseInfo</span><span class='p'>(</span><span class='n'>information</span> <span class='p'>:</span> <span class='n'>String</span><span class='p'>?)</span> <span class='p'>:</span> <span class='n'>Array</span><span class='p'>&lt;</span><span class='n'>String</span><span class='p'>&gt;?</span> <span class='p'>{</span>
    <span class='k'>if</span> <span class='p'>(</span><span class='n'>information</span> <span class='p'>==</span> <span class='k'>null</span><span class='p'>)</span> <span class='p'>{</span>
        <span class='k'>return</span> <span class='k'>null</span>
    <span class='p'>}</span>

    <span class='k'>return</span> <span class='n'>information</span><span class='p'>.</span><span class='n'>split</span><span class='p'>(</span><span class='s'>&quot;,&quot;</span><span class='p'>)</span>
<span class='p'>}</span>

<span class='c1'>// ...Or take advantage of the safe navigation operator</span>
<span class='k'>fun</span> <span class='nf'>parseInfo</span><span class='p'>(</span><span class='n'>information</span> <span class='p'>:</span> <span class='n'>String</span><span class='p'>?)</span> <span class='p'>:</span> <span class='n'>Array</span><span class='p'>&lt;</span><span class='n'>String</span><span class='p'>&gt;?</span> <span class='p'>{</span>
    <span class='k'>return</span> <span class='n'>information</span><span class='p'>?.</span><span class='n'>split</span><span class='p'>(</span><span class='s'>&quot;,&quot;</span><span class='p'>)</span>
<span class='p'>}</span>
</code></pre></div><p class='code-header'>Haskell:</p><div class='highlight'><pre><code class='haskell'><span class='c1'>-- Can do it with pattern matching...</span>
<span class='nf'>parseInfo</span> <span class='ow'>::</span> <span class='kt'>Maybe</span> <span class='kt'>String</span> <span class='ow'>-&gt;</span> <span class='kt'>Maybe</span> <span class='p'>[</span><span class='kt'>String</span><span class='p'>]</span>
<span class='nf'>parseInfo</span> <span class='kt'>Nothing</span> <span class='ow'>=</span> <span class='kt'>Nothing</span>
<span class='nf'>parseInfo</span> <span class='p'>(</span><span class='kt'>Just</span> <span class='n'>information</span><span class='p'>)</span> <span class='ow'>=</span> <span class='kt'>Just</span> <span class='p'>(</span><span class='n'>splitOn</span> <span class='s'>&quot;,&quot;</span> <span class='n'>information</span><span class='p'>)</span>

<span class='c1'>-- ...Or with do notation...</span>
<span class='nf'>parseInfo</span> <span class='ow'>::</span> <span class='kt'>Maybe</span> <span class='kt'>String</span> <span class='ow'>-&gt;</span> <span class='kt'>Maybe</span> <span class='p'>[</span><span class='kt'>String</span><span class='p'>]</span>
<span class='nf'>parseInfo</span> <span class='n'>information</span> <span class='ow'>=</span> <span class='kr'>do</span> <span class='n'>i</span> <span class='ow'>&lt;-</span> <span class='n'>information</span>
                            <span class='kt'>Just</span> <span class='p'>(</span><span class='n'>splitOn</span> <span class='s'>&quot;,&quot;</span> <span class='n'>i</span><span class='p'>)</span>

<span class='c1'>-- ...Or with fmap</span>
<span class='nf'>parseInfo</span> <span class='ow'>::</span> <span class='kt'>Maybe</span> <span class='kt'>String</span> <span class='ow'>-&gt;</span> <span class='kt'>Maybe</span> <span class='p'>[</span><span class='kt'>String</span><span class='p'>]</span>
<span class='nf'>parseInfo</span> <span class='n'>information</span> <span class='ow'>=</span> <span class='n'>fmap</span> <span class='p'>(</span><span class='n'>splitOn</span> <span class='s'>&quot;,&quot;</span><span class='p'>)</span> <span class='n'>information</span>
</code></pre></div><!-- **Executing several operations that could fail in a row** -->
<p><strong>Giving something a default value</strong></p>
<p class='code-header'>Java:</p><div class='highlight'><pre><code class='java'><span class='n'>String</span> <span class='n'>name</span> <span class='o'>=</span> <span class='o'>(</span><span class='n'>author</span> <span class='o'>==</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>?</span> <span class='s'>&quot;Anonymous&quot;</span> <span class='o'>:</span> <span class='n'>author</span><span class='o'>;</span>
</code></pre></div><p class='code-header'>Kotlin:</p><div class='highlight'><pre><code class='kotlin'><span class='k'>val</span> <span class='n'>name</span> <span class='p'>=</span> <span class='n'>author</span> <span class='p'>?:</span> <span class='s'>&quot;Anonymous&quot;</span>
</code></pre></div><p class='code-header'>Haskell:</p><div class='highlight'><pre><code class='haskell'><span class='kr'>let</span> <span class='n'>name</span> <span class='ow'>=</span> <span class='n'>fromMaybe</span> <span class='s'>&quot;Anonymous&quot;</span> <span class='n'>author</span>
</code></pre></div>
<p><strong>Throwing an exception</strong></p>
<p class='code-header'>Java:</p><div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='n'>String</span><span class='o'>[]</span> <span class='nf'>parseInfo</span><span class='o'>(</span><span class='n'>String</span> <span class='n'>information</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='k'>return</span> <span class='n'>information</span><span class='o'>.</span><span class='na'>split</span><span class='o'>(</span><span class='s'>&quot;,&quot;</span><span class='o'>);</span>
<span class='o'>}</span>
</code></pre></div><p class='code-header'>Kotlin:</p><div class='highlight'><pre><code class='kotlin'><span class='k'>fun</span> <span class='nf'>parseInfo</span><span class='p'>(</span><span class='n'>information</span> <span class='p'>:</span> <span class='n'>String</span><span class='p'>?)</span> <span class='p'>:</span> <span class='n'>Array</span><span class='p'>&lt;</span><span class='n'>String</span><span class='p'>&gt;</span> <span class='p'>{</span>
    <span class='k'>return</span> <span class='n'>information</span><span class='p'>!!.</span><span class='n'>split</span><span class='p'>(</span><span class='s'>&quot;,&quot;</span><span class='p'>)</span>
<span class='p'>}</span>
</code></pre></div><p class='code-header'>Haskell:</p><div class='highlight'><pre><code class='haskell'><span class='nf'>parseInfo</span> <span class='ow'>::</span> <span class='kt'>Maybe</span> <span class='kt'>String</span> <span class='ow'>-&gt;</span> <span class='kt'>Maybe</span> <span class='p'>[</span><span class='kt'>String</span><span class='p'>]</span>
<span class='nf'>parseInfo</span> <span class='n'>information</span> <span class='ow'>=</span> <span class='kt'>Just</span> <span class='p'>(</span><span class='n'>splitOn</span> <span class='s'>&quot;,&quot;</span> <span class='p'>(</span><span class='n'>fromJust</span> <span class='n'>information</span><span class='p'>))</span>
</code></pre></div>
<p><strong>Not having to check for null</strong></p>

<p>Java: Does not have this option, you always have to deal with null.</p>
<p class='code-header'>Kotlin:</p><div class='highlight'><pre><code class='kotlin'><span class='c1'>// note: no ? appended to types</span>
<span class='k'>fun</span> <span class='nf'>safeParseInfo</span><span class='p'>(</span><span class='n'>information</span> <span class='p'>:</span> <span class='n'>String</span><span class='p'>)</span> <span class='p'>:</span> <span class='n'>Array</span><span class='p'>&lt;</span><span class='n'>String</span><span class='p'>&gt;</span> <span class='p'>{</span>
    <span class='k'>return</span> <span class='n'>information</span><span class='p'>.</span><span class='n'>split</span><span class='p'>(</span><span class='s'>&quot;,&quot;</span><span class='p'>)</span>
<span class='p'>}</span>
</code></pre></div><p class='code-header'>Haskell:</p><div class='highlight'><pre><code class='haskell'><span class='c1'>-- and these types are not wrapped in Maybe</span>
<span class='nf'>safeParseInfo</span> <span class='ow'>::</span> <span class='kt'>String</span> <span class='ow'>-&gt;</span> <span class='p'>[</span><span class='kt'>String</span><span class='p'>]</span>
<span class='nf'>safeParseInfo</span> <span class='n'>information</span> <span class='ow'>=</span> <span class='n'>splitOn</span> <span class='s'>&quot;,&quot;</span> <span class='n'>information</span>
</code></pre></div>
<p>The nice thing about this last example is that if the code changes and this function now needs to be called with a value that might be <code>null</code>, the code won&#8217;t compile until the developer has revisited <code>safeParseInfo</code> and explicitly chosen to deal with <code>null</code> in one of the ways shown above.</p>

<p>In case you want to run the examples yourself:</p>

<ul>
<li>The Java examples import <code>java.util.Arrays</code> and <code>java.util.Random</code></li>

<li>The Kotlin examples import <code>java.util.Random</code></li>

<li>The Haskell examples import <code>System.Random</code>, <code>Data.List.Split</code>, and <code>Data.Maybe</code></li>
</ul>

<p>That&#8217;s it, that&#8217;s the end of both the <a href='#faq'>FAQ</a> and this article. Hope you enjoyed it!</p>
    <div style="margin-top:1.5em">
        <a href="/blog/2013/04/16/why-maybe-is-better-than-null/" style="font-size:18px;">Read More</a>
        â€”
        <a style="font-size:14px;" href="/blog/2013/04/16/why-maybe-is-better-than-null/#disqus_thread" data-disqus-identifier="/blog/2013/04/16/why-maybe-is-better-than-null">Comments</a>
    </div>
  </div>

  <hr class="fancyrule" />

  <div>
  <h1 style="margin:0px"><a href="/blog/2013/04/10/seven-languages-week-4-day-2/">
  Seven Languages: Week 4 (Scala) - Day 2
  </a></h1>
  <div class="faded" style="font-size:14px; margin-bottom:5px;">10 Apr 2013</div>
    <p>Day 2 of Scala focused on its functional programming prowess. Since this is the first time functional programming has been introduced in this book only the basics were talked about this chapter, and I&#8217;m already pretty familiar with those so this was an easy chapter for me.</p>

<p>The exercises were a lot shorter than the previous day&#8217;s, although <a href='/projects/arbitrarily-sized-tic-tac-toe/'>me going overboard</a> last time probably had something to do with that! Today the main exercise was a small task that makes sure you know how to use Traits, Maps, and read files.</p>

<p>My familiarity with the topics in this chapter and the shorter exercises both mean this will be a shorter post than last time.</p>
<div class='interjection'><p>
(This article is part of a series of posts I am doing about my journey through the exercises of the book <a href='http://pragprog.com/book/btlang/seven-languages-in-seven-weeks'>Seven Languages In Seven Weeks</a>. The article previous to this one is <a href='/blog/2013/03/28/seven-languages-week-4-day-1/'>Week 4 (Scala) - Day 1</a>. For an overview see the <a href='/projects/seven-languages-in-seven-weeks/'>Seven Languages project page</a>.)
</p></div>
<h2 id='topics_covered'>Topics Covered</h2>

<p>Topics in Day 2 included functional programming, immutability, higher order functions, collections, and the representation of empty values (Null, null, Nothing, Nil, None and Unit).</p>
<h3>Functional Programming</h3>
<p>Scala has thorough support for functional programming. It has closures, convenient syntax for anonymous functions, <a href='http://www.scala-lang.org/node/135'>currying</a>, a focus on immutability, pattern-matching, <a href='http://gleichmann.wordpress.com/2011/01/30/functional-scala-algebraic-datatypes-enumerated-types/'>algebraic data types</a>, <a href='http://www.sidewayscoding.com/2011/01/introduction-to-type-classes-in-scala.html'>type classes</a>, and it has <a href='http://www.scala-lang.org/api/current/index.html#scala.collection.Iterable'>many higher-order functions</a> defined for its collections.</p>

<p>A somewhat lengthy but very interesting read on this topic is <a href='https://www.bionicspirit.com/blog/2012/11/02/scala-functional-programming-type-classes.html'>On Scala, Functional Programming and Type-Classes</a> by Alexandru Nedelcu.</p>
<h3>Collections</h3>
<p>Scala has great collections. Scala doesn&#8217;t do anything revolutionary with collections. These statements are both true and it&#8217;s not a bad thing! If anything it&#8217;s a reflection of the growing number of great collections libraries in modern languages. What it does mean is that it is harder for me to point to one or two features and say &#8220;Here, you see? That is why this is so good.&#8221;</p>

<p>Scala&#8217;s collections have obviously had a lot of effort and attention to detail put into them. You&#8217;ve got good default implementations of the basics (sequences, sets, maps) and many implementations of each kind that have different performance characteristics, all of which are nicely documented. There are lots of useful helper functions defined at appropriate levels in the well-organized class hierarchy. Functional programmers will be happy to know that any String is also an IndexedSeq!</p>

<p>Here&#8217;s what the abstract part of the collections class hierarchy looks like:</p>

<p><img alt='Scala collections class hierarchy' src='/img/scala-collections.png' /></p>

<p>A ton of general useful collection methods are defined high up on <a href='http://www.scala-lang.org/api/current/index.html#scala.collection.Traversable'>Traversable</a> and <a href='http://www.scala-lang.org/api/current/index.html#scala.collection.Iterable'>Iterable</a> so that all can use them. It makes using them very consistent and convenient.</p>

<p>One of these that is worth pointing out is <code>par</code>, which lets you turn sequential operations on collections into parallel ones with a single word. There are a growing number of languages that have this capability now: Haskell, C#, F#, Scala, and soon Java 8 (I have undoubtedly missed a few, please let me know if another comes to mind).</p>
<h3>Null, null, Nothing, Nil, None and Unit in Scala</h3>
<p>This book tried to explain this, but the explanation only served to confuse me further. I read a few other explanations online and between them pieced together the higher-level information I wanted to know.</p>

<p>This resulted in me making a reference post that gives a Cliff&#8217;s Notes version of <a href='/blog/2013/03/31/representing-empty-in-scala/'>emptiness in Scala</a>. Null and Nothing basically only exist as support for the other values, and Unit isn&#8217;t as easy to confuse with the others. That leaves null, Nil and None which all have similar names and represent &#8220;empty&#8221; in some way. Fortunately, all three of these concepts are fairly distinct and even have direct analogues in other languages.</p>

<ul>
<li><strong>null</strong> - Exactly the same as <code>null</code> in other languages.</li>

<li><strong>Nil</strong> - Empty list. <code>[]</code> in other languages, same as <code>List()</code> in Scala.</li>

<li><strong>None</strong> - The empty case of Option, also called <code>Nothing</code> in Haskell.</li>
</ul>

<p>If you want more information, see my <a href='/blog/2013/03/31/representing-empty-in-scala/'>full post about this</a>, there are links to more detailed information in there as well.</p>

<h2 id='highlights_from_exercises'>Highlights From Exercises</h2>

<p>The exercises this week were a lot simpler than my <a href='/projects/arbitrarily-sized-tic-tac-toe/'>jumped up Tic Tac Toe</a> from last time. On one hand, it was nice because it took less time to finish. On the other&#8230; I have less to write about now!</p>

<p>So let&#8217;s evaluate this method I wrote and see if we can make it better:</p>
<div class='highlight'><pre><code class='scala'><span class='k'>def</span> <span class='n'>censorThyselfVillain</span> <span class='o'>(</span><span class='n'>suspectPhrase</span> <span class='k'>:</span> <span class='kt'>String</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>String</span> <span class='o'>=</span> <span class='o'>{</span>
   <span class='k'>var</span> <span class='n'>wholesomePhrase</span> <span class='k'>=</span> <span class='n'>suspectPhrase</span>

   <span class='k'>for</span> <span class='o'>((</span><span class='n'>key</span><span class='o'>,</span> <span class='n'>value</span><span class='o'>)</span> <span class='k'>&lt;-</span> <span class='n'>curseWords</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='n'>wholesomePhrase</span> <span class='k'>=</span> <span class='n'>wholesomePhrase</span><span class='o'>.</span><span class='n'>replaceAll</span><span class='o'>(</span><span class='n'>key</span><span class='o'>,</span> <span class='n'>value</span><span class='o'>)</span>
   <span class='o'>}</span>

   <span class='k'>return</span> <span class='n'>wholesomePhrase</span>
<span class='o'>}</span>
</code></pre></div>
<p>Its purpose is to replace &#8216;offensive&#8217; words with a chosen set of &#8216;less offensive&#8217; ones. As far as imperative solutions go I&#8217;d say it is pretty easy to read - it&#8217;s straightforward and not unnecessarily wordy.</p>

<p>But Scala is a hybrid language - it&#8217;s capable of functional programming too, not just OO or imperative. Does that help in this particular case? Let&#8217;s see:</p>
<div class='highlight'><pre><code class='scala'><span class='k'>def</span> <span class='n'>censorThyselfVillain2</span> <span class='o'>(</span><span class='n'>suspectPhrase</span> <span class='k'>:</span> <span class='kt'>String</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>String</span> <span class='o'>=</span> <span class='o'>{</span>
    <span class='n'>curseWords</span><span class='o'>.</span><span class='n'>foldLeft</span><span class='o'>(</span><span class='n'>suspectPhrase</span><span class='o'>)((</span><span class='n'>acc</span><span class='o'>,</span> <span class='n'>pair</span><span class='o'>)</span> <span class='k'>=&gt;</span> <span class='n'>acc</span><span class='o'>.</span><span class='n'>replaceAll</span><span class='o'>(</span><span class='n'>pair</span><span class='o'>.</span><span class='n'>_1</span><span class='o'>,</span> <span class='n'>pair</span><span class='o'>.</span><span class='n'>_2</span><span class='o'>))</span>
<span class='o'>}</span>
</code></pre></div>
<p>This function can be reduced to a simple fold. As easy to understand as the previous example was, this one (provided you&#8217;re already familiar with fold) is even nicer. It is good to have options.</p>

<h2 id='full_solutions'>Full Solutions</h2>

<p>Here is a nicely formatted version of my solutions to the exercises from Day 2 of Scala. The home of the following code is <a href='https://github.com/nickknw/seven-languages-in-seven-weeks/blob/master/week-4-scala/day2.scala'>on github</a> with the other exercises.</p>
<div id='formatted_solutions'>

<h3>Find:</h3>

<div class='question'><b>1.</b> A discussion on how to use Scala files</div>

<p> I'm not entirely clear what this question is looking for. Maybe something
<a href='http://www.scala-lang.org/node/166'>like this</a>?</p>

<div class='question'><b>2.</b> What makes a closure different from a code block</div>

<p>I'm not sure I've got my terminology straight here, but I will give it a go.
In Scala, a code block is a piece of syntax that creates closures.</p>

<h3>Do:</h3>

<div class='question'><b>1.</b> Use foldLeft to compute the total size of a list of strings.</div>


<div class='highlight'><pre><code class='scala'><span class='k'>var</span> <span class='n'>stringList</span> <span class='k'>=</span> <span class='nc'>List</span><span class='o'>(</span><span class='s'>&quot;here&quot;</span><span class='o'>,</span> <span class='s'>&quot;is&quot;</span><span class='o'>,</span> <span class='s'>&quot;a&quot;</span><span class='o'>,</span> <span class='s'>&quot;list&quot;</span><span class='o'>,</span> <span class='s'>&quot;of&quot;</span><span class='o'>,</span> <span class='s'>&quot;strings&quot;</span><span class='o'>)</span>
<span class='k'>var</span> <span class='n'>totalStringSize</span> <span class='k'>=</span> <span class='n'>stringList</span><span class='o'>.</span><span class='n'>foldLeft</span><span class='o'>(</span><span class='mi'>0</span><span class='o'>)((</span><span class='n'>total</span><span class='o'>,</span> <span class='n'>string</span><span class='o'>)</span> <span class='k'>=&gt;</span> <span class='n'>total</span> <span class='o'>+</span> <span class='n'>string</span><span class='o'>.</span><span class='n'>length</span><span class='o'>)</span>
<span class='k'>var</span> <span class='n'>totalStringSize2</span> <span class='k'>=</span> <span class='o'>(</span><span class='mi'>0</span> <span class='o'>/:</span> <span class='n'>stringList</span><span class='o'>)</span> <span class='o'>{(</span><span class='n'>total</span><span class='o'>,</span> <span class='n'>string</span><span class='o'>)</span> <span class='k'>=&gt;</span> <span class='n'>total</span> <span class='o'>+</span> <span class='n'>string</span><span class='o'>.</span><span class='n'>length</span> <span class='o'>}</span>

<span class='n'>println</span><span class='o'>(</span><span class='n'>totalStringSize</span><span class='o'>)</span>
<span class='n'>println</span><span class='o'>(</span><span class='n'>totalStringSize2</span><span class='o'>)</span>
</code></pre></div>


<div class='question'><b>2.</b> Write a Censor trait with a method that will replace the curse words Shoot and Darn with Pucky and Beans alternatives. Use a map to store the curse words and their alternatives.</div>


<div class='highlight'><pre><code class='scala'><span class='k'>import</span> <span class='nn'>scala.collection.mutable.HashMap</span>

<span class='k'>trait</span> <span class='nc'>Censor</span> <span class='o'>{</span>

    <span class='k'>var</span> <span class='n'>curseWords</span> <span class='k'>=</span> <span class='nc'>Map</span><span class='o'>(</span>
        <span class='s'>&quot;(?i)Shoot&quot;</span> <span class='o'>-&gt;</span> <span class='s'>&quot;Pucky&quot;</span><span class='o'>,</span>
        <span class='s'>&quot;(?i)Darn&quot;</span> <span class='o'>-&gt;</span> <span class='s'>&quot;Beans&quot;</span>
    <span class='o'>)</span>

    <span class='k'>def</span> <span class='n'>setCurseWords</span><span class='o'>(</span><span class='n'>newCurseWords</span> <span class='k'>:</span> <span class='kt'>Map</span><span class='o'>[</span><span class='kt'>String</span>, <span class='kt'>String</span><span class='o'>])</span> <span class='k'>=</span> <span class='o'>{</span>
        <span class='n'>curseWords</span> <span class='k'>=</span> <span class='n'>newCurseWords</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>censorThyselfVillain</span> <span class='o'>(</span><span class='n'>suspectPhrase</span> <span class='k'>:</span> <span class='kt'>String</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>String</span> <span class='o'>=</span> <span class='o'>{</span>
       <span class='k'>var</span> <span class='n'>wholesomePhrase</span> <span class='k'>=</span> <span class='n'>suspectPhrase</span>

       <span class='k'>for</span> <span class='o'>((</span><span class='n'>key</span><span class='o'>,</span> <span class='n'>value</span><span class='o'>)</span> <span class='k'>&lt;-</span> <span class='n'>curseWords</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='n'>wholesomePhrase</span> <span class='k'>=</span> <span class='n'>wholesomePhrase</span><span class='o'>.</span><span class='n'>replaceAll</span><span class='o'>(</span><span class='n'>key</span><span class='o'>,</span> <span class='n'>value</span><span class='o'>)</span>
       <span class='o'>}</span>

       <span class='k'>return</span> <span class='n'>wholesomePhrase</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>censorThyselfVillain2</span> <span class='o'>(</span><span class='n'>suspectPhrase</span> <span class='k'>:</span> <span class='kt'>String</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>String</span> <span class='o'>=</span> <span class='o'>{</span>
        <span class='n'>curseWords</span><span class='o'>.</span><span class='n'>foldLeft</span><span class='o'>(</span><span class='n'>suspectPhrase</span><span class='o'>)((</span><span class='n'>acc</span><span class='o'>,</span> <span class='n'>pair</span><span class='o'>)</span> <span class='k'>=&gt;</span> <span class='n'>acc</span><span class='o'>.</span><span class='n'>replaceAll</span><span class='o'>(</span><span class='n'>pair</span><span class='o'>.</span><span class='n'>_1</span><span class='o'>,</span> <span class='n'>pair</span><span class='o'>.</span><span class='n'>_2</span><span class='o'>))</span>
    <span class='o'>}</span>
<span class='o'>}</span>

<span class='k'>class</span> <span class='nc'>PolitenessEnforcer</span> <span class='k'>extends</span> <span class='nc'>Censor</span>

<span class='k'>var</span> <span class='n'>enforcer</span> <span class='k'>=</span> <span class='k'>new</span> <span class='nc'>PolitenessEnforcer</span><span class='o'>()</span>

<span class='k'>val</span> <span class='n'>rudePhrase</span> <span class='k'>=</span> <span class='s'>&quot;Shoot, my darn head is stuck in the dumb freaking door. Holy gosh Batman!&quot;</span>

<span class='n'>println</span><span class='o'>(</span><span class='s'>&quot;Spoken frankly: &quot;</span><span class='o'>)</span>
<span class='n'>println</span><span class='o'>(</span><span class='n'>rudePhrase</span><span class='o'>)</span>

<span class='n'>println</span><span class='o'>(</span><span class='s'>&quot;The enforcer menaces with spikes of brass: &quot;</span><span class='o'>)</span>
<span class='n'>println</span><span class='o'>(</span><span class='n'>enforcer</span><span class='o'>.</span><span class='n'>censorThyselfVillain</span><span class='o'>(</span><span class='n'>rudePhrase</span><span class='o'>))</span>
</code></pre></div>


<div class='question'><b>3.</b> Load the curse words and alternatives from a file.</div>


<div class='highlight'><pre><code class='scala'><span class='k'>import</span> <span class='nn'>scala.io.Source._</span>

<span class='k'>var</span> <span class='n'>cursesFromFile</span> <span class='k'>=</span> <span class='nc'>Map</span><span class='o'>.</span><span class='n'>empty</span><span class='o'>[</span><span class='kt'>String</span>, <span class='kt'>String</span><span class='o'>]</span>

<span class='n'>fromFile</span><span class='o'>(</span><span class='s'>&quot;curseWords.txt&quot;</span><span class='o'>).</span><span class='n'>getLines</span><span class='o'>.</span><span class='n'>foreach</span> <span class='o'>{</span> <span class='n'>line</span> <span class='k'>=&gt;</span>
    <span class='k'>val</span> <span class='n'>curseWordPair</span> <span class='k'>=</span> <span class='n'>line</span><span class='o'>.</span><span class='n'>split</span><span class='o'>(</span><span class='sc'>&#39;|&#39;</span><span class='o'>)</span>
    <span class='k'>if</span><span class='o'>(</span><span class='n'>curseWordPair</span><span class='o'>.</span><span class='n'>length</span> <span class='o'>==</span> <span class='mi'>2</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='n'>cursesFromFile</span> <span class='o'>+=</span> <span class='o'>(</span><span class='s'>&quot;(?i)&quot;</span> <span class='o'>+</span> <span class='n'>curseWordPair</span><span class='o'>(</span><span class='mi'>0</span><span class='o'>).</span><span class='n'>trim</span><span class='o'>)</span> <span class='o'>-&gt;</span> <span class='n'>curseWordPair</span><span class='o'>(</span><span class='mi'>1</span><span class='o'>).</span><span class='n'>trim</span>
    <span class='o'>}</span>
<span class='o'>}</span>

<span class='k'>val</span> <span class='n'>stricterEnforcer</span> <span class='k'>=</span> <span class='k'>new</span> <span class='nc'>PolitenessEnforcer</span><span class='o'>()</span>
<span class='n'>stricterEnforcer</span><span class='o'>.</span><span class='n'>setCurseWords</span><span class='o'>(</span><span class='n'>cursesFromFile</span><span class='o'>)</span>

<span class='n'>println</span><span class='o'>(</span><span class='s'>&quot;The enforcer menaces with spikes of onyx: &quot;</span><span class='o'>)</span>
<span class='n'>println</span><span class='o'>(</span><span class='n'>stricterEnforcer</span><span class='o'>.</span><span class='n'>censorThyselfVillain</span><span class='o'>(</span><span class='n'>rudePhrase</span><span class='o'>))</span>
</code></pre></div>


</div>
<p>Next in this series: Day 3 of Scala (coming soon).</p>
    <div style="margin-top:1.5em">
        <a href="/blog/2013/04/10/seven-languages-week-4-day-2/" style="font-size:18px;">Read More</a>
        â€”
        <a style="font-size:14px;" href="/blog/2013/04/10/seven-languages-week-4-day-2/#disqus_thread" data-disqus-identifier="/blog/2013/04/10/seven-languages-week-4-day-2">Comments</a>
    </div>
  </div>

  <hr class="fancyrule" />

  <div>
  <h1 style="margin:0px"><a href="/blog/2013/03/31/representing-empty-in-scala/">
  Representing Emptiness In Scala (with Null, null, Nothing, Nil, None, and Unit)
  </a></h1>
  <div class="faded" style="font-size:14px; margin-bottom:5px;">31 Mar 2013</div>
    <p>There are a <a href='http://lousycoder.com/index.php?/archives/92-Scala-So-many-ways-to-say-nothing.html'>couple</a> of <a href='http://oldfashionedsoftware.com/2008/08/20/a-post-about-nothing/'>explanations</a> of these terms out there already, but my needs weren&#8217;t quite satisfied by them. Detail is great, but I wanted concise high level descriptions that explain what the primary purpose for each construct is and emphasize the ones you&#8217;re most likely to see in practice. This explanation is intended to <em>complement</em> ones with more detail, not replace them.</p>
<h4>null</h4>
<p>Scala&#8217;s <code>null</code> is the same as in Java. Any reference type can be <code>null</code>, like Strings, Objects, or your own classes. Also just like Java, value types like Ints can&#8217;t be <code>null</code>. <strong>Odds are you'll see this
one.</strong></p>
<h4>Null</h4>
<p><a href='http://www.scala-lang.org/api/current/index.html#scala.Null'>Null</a> is a trait whose only instance is <code>null</code>. It is a subtype of all reference types, but not of value types. It purpose in existing is to make it so reference types can be assigned <code>null</code> and value types can&#8217;t. <strong>Don't worry about this one.</strong></p>
<h4>Nothing</h4>
<p><a href='http://www.scala-lang.org/api/current/index.html#scala.Nothing'>Nothing</a> is a trait that is guaranteed to have <em>zero</em> instances. It is a subtype of all other types. It has two main reasons for existing: to provide a return type for methods that <strong>never</strong> return normally (i.e. a method that always throws an exception). The other reason is to provide a type for Nil (explained below). <strong>Don't worry about this
one.</strong></p>
<h4>Nil</h4>
<p><a href='http://www.scala-lang.org/api/current/index.html#scala.collection.immutable.Nil$'>Nil</a> is just an empty list, exactly like the result of <code>List()</code>. It is of type <code>List[Nothing]</code>. And since we know there are no instances of Nothing, we now have a list that is statically verifiable as empty. Nice to have. <strong>Odds are you'll see this one.</strong></p>
<h4>None</h4>
<p><a href='http://www.scala-lang.org/api/current/index.html#scala.None$'>None</a> is the counterpart to <a href='http://www.scala-lang.org/api/current/index.html#scala.Some'>Some</a>, used when you&#8217;re using Scala&#8217;s <a href='http://www.scala-lang.org/api/current/index.html#scala.Option'>Option</a> class to help avoid <code>null</code> references. If you&#8217;re not familiar with the idea of Option or Maybe, here&#8217;s an <a href='http://blog.danielwellman.com/2008/03/using-scalas-op.html'>introduction to Option</a>. <strong>Odds are you'll see this one.</strong></p>
<h4>Unit</h4>
<p><a href='http://www.scala-lang.org/api/current/index.html#scala.Unit'>Unit</a> in Scala is the equivalent of <code>void</code> in Java. It&#8217;s used in a function&#8217;s signature when that function doesn&#8217;t return a value. <strong>Odds are you'll see this one.</strong></p>

<p>Hope this has helped!</p>
    <div style="margin-top:1.5em">
        <a href="/blog/2013/03/31/representing-empty-in-scala/" style="font-size:18px;">Read More</a>
        â€”
        <a style="font-size:14px;" href="/blog/2013/03/31/representing-empty-in-scala/#disqus_thread" data-disqus-identifier="/blog/2013/03/31/representing-empty-in-scala">Comments</a>
    </div>
  </div>

  <hr class="fancyrule" />

  <div>
  <h1 style="margin:0px"><a href="/blog/2013/03/28/seven-languages-week-4-day-1/">
  Seven Languages: Week 4 (Scala) - Day 1
  </a></h1>
  <div class="faded" style="font-size:14px; margin-bottom:5px;">28 Mar 2013</div>
    <p>I have to admit Day 1 of Scala was a bit of a relief. Forcing myself to think through the perspective of Prolog was enlightening but still a bit of a struggle. It&#8217;s nice to come back to paradigms I&#8217;m familiar with again. Scala is a hybrid language, with great support for both object-oriented and functional programming, both of which I&#8217;m fairly comfortable with.</p>

<p>That&#8217;s not to say everything went smoothly however - danger lies in overfamiliarity. At first I was writing Java in Scala, then when I tried to fix it I realized I was now trying to write Haskell in Scala. Neither approach felt very good.</p>

<p>The beauty of Scala (in my eyes) is its flexibility and practicality. It pushes you towards immutability and is capable of very succinct functional code, but it also has that mutable imperative escape hatch, and a good set of tools for working with problems that suit code like that. It will let you write in the style that is most appropriate for the problem you are trying to solve.</p>

<p>The collection libraries in 2.8+ also deserve special mention: a lot of work has been put into them and it shows!</p>
<div class='interjection'><p>
(This article is part of a series of posts I am doing about my journey through the exercises of the book <a href='http://pragprog.com/book/btlang/seven-languages-in-seven-weeks'>Seven Languages In Seven Weeks</a>. The article previous to this one is <a href='/blog/2012/08/06/seven-languages-week-3-day-3/'>Week 3 (Prolog) - Day 3</a>. For an overview see the <a href='/projects/seven-languages-in-seven-weeks/'>Seven Languages project page</a>.)
</p></div>
<h2 id='topics_covered'>Topics Covered</h2>
<h3>Syntax</h3>
<p>In Day 1 we went over the basics of Scala syntax and some object-oriented features. Scala is loosely based around traditional C-style curly brace syntax with some helpful differences. The first is that you don&#8217;t need semicolons at the end of the line, woohoo! Also, in <a href='http://docs.scala-lang.org/style/method-invocation.html#suffix_notation'>certain situations</a> you can use whitespace instead of a <code>.</code> for method calls, Haskell-style.</p>

<p>In order to declare a variable, you must make a choice right away whether you want it to be immutable or not. Declarations using <code>val</code> are immutable, declarations using <code>var</code> are mutable. There are mutable and immutable versions of most of the collections in the standard library as well, but the default is immutable (you need to be explicit if you want mutable versions). As someone who is a fan of Haskell and made generous use of <code>final</code> in Java, I really appreciate making it so easy to use immutability in Scala.</p>

<p>Another couple of differences have to do with type information. Type information is now attached to variables with a colon and is optional in many cases (when it can be inferred from context).</p>
<div class='highlight'><pre><code class='scala'><span class='k'>val</span> <span class='n'>i</span><span class='k'>:</span> <span class='kt'>Int</span> <span class='o'>=</span> <span class='mi'>1</span>  <span class='c1'>// explicit type info</span>
<span class='k'>val</span> <span class='n'>i</span> <span class='k'>=</span> <span class='mi'>1</span>       <span class='c1'>// using type inference</span>
</code></pre></div>
<p>Scala also has <a href='http://www.matthicks.com/2009/10/loops-in-scala.html'>several helpful looping constructs</a>, <a href='http://www.scala-lang.org/api/current/index.html#scala.collection.immutable.Range'>ranges</a>, and <a href='http://codemonkeyism.com/tuples-scala-goodness/'>tuples</a>, but I don&#8217;t want to focus on them right now. Moving on!</p>
<h3>Object-Oriented Features</h3><h4>Classes and Companion Objects</h4>
<p>Like any good object-oriented language Scala has classes, where you can put your state and instance methods. Static methods (class methods if you prefer) are treated a bit differently - they must all reside in a static Companion Object. This is unusual but I&#8217;ve found the separation kind of nice so far. Here&#8217;s a stripped-down version of my TicTacToeBoard class from the exercise:</p>

<p>(Heads up: this example depends on a few classes (Player, X, O, Blank) that are defined below under &#8216;Case Classes&#8217;)</p>
<div class='highlight'><pre><code class='scala'><span class='k'>class</span> <span class='nc'>TicTacToeBoard</span><span class='o'>(</span><span class='n'>board</span> <span class='k'>:</span> <span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]])</span> <span class='o'>{</span>

    <span class='k'>val</span> <span class='n'>rowCount</span> <span class='k'>=</span> <span class='n'>board</span><span class='o'>.</span><span class='n'>length</span>
    <span class='k'>val</span> <span class='n'>columnCount</span> <span class='k'>=</span> <span class='k'>if</span> <span class='o'>(</span><span class='n'>board</span><span class='o'>.</span><span class='n'>isEmpty</span><span class='o'>)</span> <span class='mi'>0</span> <span class='k'>else</span> <span class='n'>board</span><span class='o'>(</span><span class='mi'>0</span><span class='o'>).</span><span class='n'>length</span>

    <span class='k'>def</span> <span class='n'>validMove</span><span class='o'>(</span><span class='n'>row</span> <span class='k'>:</span> <span class='kt'>Int</span><span class='o'>,</span> <span class='n'>col</span> <span class='k'>:</span> <span class='kt'>Int</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>Boolean</span> <span class='o'>=</span> <span class='o'>{</span>
        <span class='k'>return</span> <span class='n'>row</span> <span class='o'>&lt;</span> <span class='n'>rowCount</span> <span class='o'>&amp;&amp;</span> <span class='n'>row</span> <span class='o'>&gt;=</span> <span class='mi'>0</span> <span class='o'>&amp;&amp;</span> <span class='n'>col</span> <span class='o'>&lt;</span> <span class='n'>columnCount</span> <span class='o'>&amp;&amp;</span> <span class='n'>col</span> <span class='o'>&gt;=</span> <span class='mi'>0</span> <span class='o'>&amp;&amp;</span> <span class='n'>board</span><span class='o'>(</span><span class='n'>row</span><span class='o'>)(</span><span class='n'>col</span><span class='o'>)</span> <span class='o'>==</span> <span class='nc'>Blank</span>
    <span class='o'>}</span>
<span class='o'>}</span>

<span class='k'>object</span> <span class='nc'>TicTacToeBoard</span> <span class='o'>{</span>
    <span class='k'>def</span> <span class='n'>getPlayersFromString</span><span class='o'>(</span><span class='n'>row</span> <span class='k'>:</span> <span class='kt'>String</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]</span> <span class='k'>=</span> <span class='o'>{</span>
        <span class='n'>row</span><span class='o'>.</span><span class='n'>map</span><span class='o'>(</span><span class='n'>char</span> <span class='k'>=&gt;</span> <span class='o'>{</span> 
            <span class='k'>if</span><span class='o'>(</span><span class='n'>char</span> <span class='o'>==</span> <span class='-Symbol'>&#39;X</span><span class='err'>&#39;</span><span class='o'>)</span> <span class='n'>X</span> <span class='k'>:</span> <span class='kt'>Player</span> 
            <span class='k'>else</span> <span class='k'>if</span><span class='o'>(</span><span class='n'>char</span> <span class='o'>==</span> <span class='-Symbol'>&#39;O</span><span class='err'>&#39;</span><span class='o'>)</span> <span class='n'>O</span> <span class='k'>:</span> <span class='kt'>Player</span> 
            <span class='k'>else</span> <span class='nc'>Blank</span> <span class='k'>:</span> <span class='kt'>Player</span> <span class='o'>}</span> 
        <span class='o'>).</span><span class='n'>toArray</span>
    <span class='o'>}</span>
<span class='o'>}</span>
</code></pre></div>
<p>You could use this class like so:</p>
<div class='highlight'><pre><code class='scala'><span class='k'>val</span> <span class='n'>board</span> <span class='k'>=</span> <span class='k'>new</span> <span class='nc'>TicTacToeBoard</span><span class='o'>(</span><span class='nc'>Array</span><span class='o'>(</span>
    <span class='s'>&quot;XOX&quot;</span><span class='o'>,</span>
    <span class='s'>&quot;OO &quot;</span><span class='o'>,</span>
    <span class='s'>&quot;XXO&quot;</span><span class='o'>).</span><span class='n'>map</span><span class='o'>(</span><span class='n'>row</span> <span class='k'>=&gt;</span> <span class='nc'>TicTacToeBoard</span><span class='o'>.</span><span class='n'>getPlayersFromString</span><span class='o'>(</span><span class='n'>row</span><span class='o'>)))</span>

<span class='n'>println</span><span class='o'>(</span><span class='n'>board</span><span class='o'>.</span><span class='n'>validMove</span><span class='o'>(</span><span class='mi'>0</span><span class='o'>,</span> <span class='mi'>0</span><span class='o'>))</span> <span class='c1'>// false</span>
<span class='n'>println</span><span class='o'>(</span><span class='n'>board</span><span class='o'>.</span><span class='n'>validMove</span><span class='o'>(</span><span class='mi'>1</span><span class='o'>,</span> <span class='mi'>2</span><span class='o'>))</span> <span class='c1'>// true</span>
</code></pre></div><h4>Case Classes</h4>
<p><a href='http://www.scala-lang.org/node/107'>Case Classes</a> are a great addition to Scala, they&#8217;re really convenient. They are basically a shortcut to define simple data holding classes with a few <a href='http://stackoverflow.com/questions/2312881/what-is-the-difference-between-scalas-case-class-and-class'>extra features</a>. The big one is that you can use case classes with pattern matching. If you&#8217;re coming from Haskell, you&#8217;ll be interested to know that they let you imitate algebraic datatypes smoothly and easily!</p>

<p>Here I&#8217;m using case classes (although technically they are case objects) to represent the ownership of squares on my tic tac toe board. With this code the example above is now functional and runnable.</p>
<div class='highlight'><pre><code class='scala'><span class='k'>sealed</span> <span class='k'>abstract</span> <span class='k'>class</span> <span class='nc'>Player</span>
<span class='k'>case</span> <span class='k'>object</span> <span class='nc'>X</span> <span class='k'>extends</span> <span class='nc'>Player</span>
<span class='k'>case</span> <span class='k'>object</span> <span class='nc'>O</span> <span class='k'>extends</span> <span class='nc'>Player</span>
<span class='k'>case</span> <span class='k'>object</span> <span class='nc'>Blank</span> <span class='k'>extends</span> <span class='nc'>Player</span> <span class='o'>{</span>
    <span class='k'>override</span> <span class='k'>def</span> <span class='n'>toString</span> <span class='k'>=</span> <span class='s'>&quot; &quot;</span>
<span class='o'>}</span>
</code></pre></div>
<p>This segment of code gives me pretty much what you&#8217;d expect: three classes that share an abstract parent Player class. Since X, O, and Blank are defined using <code>object</code> this results in three singleton objects <code>X</code>, <code>O</code>, and <code>Blank</code>. I also get sensible default toString implementations for X and O, and I can pattern match against the classes (which I do in <a href='https://github.com/nickknw/seven-languages-in-seven-weeks/blob/master/week-4-scala/day1.scala#L112'>TicTacToeBoard.determineWinner</a>).</p>

<p>Instead of interfaces Scala has <a href='http://www.scala-lang.org/node/126'>traits</a> which are great but will be talked about next post, where I will be able to show you an example from the exercise.</p>

<h2 id='highlights_from_exercises'>Highlights From Exercises</h2>

<p>The exercise this week was quite fun, although I did go a bit overboard with it. The aim was to create a 3x3 Tic Tac Toe game, but I thought it would be more fun to do arbitrarily large boards. I checked the rules for <a href='http://en.wikipedia.org/wiki/M,n,k-game'>m,n,k games</a> and put a few limits in so that depending on the board size you choose you&#8217;re playing <a href='http://en.wikipedia.org/wiki/Tic_Tac_Toe'>Tic Tac Toe</a>, <a href='http://en.wikipedia.org/wiki/Gomoku'>Gomoku</a>, <a href='http://en.wikipedia.org/wiki/Connect6'>Connect6</a>, or some custom variation in between.</p>

<p>Unfortunately, because of this feature creep one of my favourite bits of code from this exercise is now obsolete! I had written a really simple three in a row checking function using pattern matching, and I was (still am!) quite happy with it.</p>

<p>It only works if you know at compile-time how many in a row you&#8217;re checking for, so it sadly had to be replaced for me to expand to arbitrarily sized games. But here it is:</p>
<div class='highlight'><pre><code class='scala'><span class='k'>def</span> <span class='n'>threeInARow</span><span class='o'>(</span><span class='n'>list</span> <span class='k'>:</span> <span class='kt'>List</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>])</span> <span class='k'>:</span> <span class='kt'>Option</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]</span> <span class='k'>=</span> <span class='n'>list</span> <span class='k'>match</span> <span class='o'>{</span>
    <span class='k'>case</span> <span class='nc'>Nil</span> <span class='k'>=&gt;</span> <span class='nc'>None</span>
    <span class='k'>case</span> <span class='n'>x</span> <span class='o'>::</span> <span class='n'>y</span> <span class='o'>::</span> <span class='n'>z</span> <span class='o'>::</span> <span class='k'>_</span> <span class='k'>if</span> <span class='n'>x</span> <span class='o'>==</span> <span class='n'>y</span> <span class='o'>&amp;&amp;</span> <span class='n'>y</span> <span class='o'>==</span> <span class='n'>z</span> <span class='o'>&amp;&amp;</span> <span class='n'>z</span> <span class='o'>!=</span> <span class='nc'>Blank</span> <span class='k'>=&gt;</span> <span class='nc'>Some</span><span class='o'>(</span><span class='n'>z</span><span class='o'>)</span>
    <span class='k'>case</span> <span class='k'>_</span> <span class='o'>::</span> <span class='n'>tail</span> <span class='k'>=&gt;</span> <span class='n'>threeInARow</span><span class='o'>(</span><span class='n'>tail</span><span class='o'>)</span>
<span class='o'>}</span>
</code></pre></div>
<p>The code behind <a href='https://github.com/nickknw/seven-languages-in-seven-weeks/blob/master/week-4-scala/day1.scala#L112'>determineWinner</a> is also pretty cool looking, although I don&#8217;t know enough about Scala style yet to know whether it&#8217;s good or not! Anyway, I define a local function called <code>checkForWinner</code> and the rest of the method becomes really readable:</p>
<div class='highlight'><pre><code class='scala'><span class='n'>rows</span> <span class='n'>foreach</span> <span class='n'>checkForWinner</span>
<span class='n'>columns</span> <span class='n'>foreach</span> <span class='n'>checkForWinner</span>
<span class='n'>diagonalsLTR</span> <span class='n'>foreach</span> <span class='n'>checkForWinner</span>
<span class='n'>diagonalsRTL</span> <span class='n'>foreach</span> <span class='n'>checkForWinner</span>

<span class='k'>if</span><span class='o'>(</span><span class='n'>board</span><span class='o'>.</span><span class='n'>map</span><span class='o'>(</span><span class='n'>row</span> <span class='k'>=&gt;</span> <span class='n'>row</span><span class='o'>.</span><span class='n'>contains</span><span class='o'>(</span><span class='nc'>Blank</span><span class='o'>)).</span><span class='n'>contains</span><span class='o'>(</span><span class='kc'>true</span><span class='o'>))</span> <span class='o'>{</span>
    <span class='k'>return</span> <span class='nc'>GameResult</span><span class='o'>.</span><span class='nc'>NoResult</span>
<span class='o'>}</span>

<span class='k'>return</span> <span class='nc'>GameResult</span><span class='o'>.</span><span class='nc'>Tie</span>
</code></pre></div>
<p>I actually went overboard in another way on this exercise - I spent a lot of time making it solid and usable. I mean, it&#8217;s just command-line Tic Tac Toe, but hopefully it&#8217;s the best damn command-line Tic Tac Toes it could be.</p>

<p>Anyway, I decided it may as well have a permanent home and I gave it its own project page: <a href='/projects/arbitrarily-sized-tic-tac-toe/'>Arbitrarily-Sized Tic Tac Toe</a>!</p>

<p>Here&#8217;s a peek at the regular size:</p>
<div class='symmetrical_line_height'>
<pre><code>
Player X's turn.
Enter square: (e.g. A0): a2

     A   B   C   
   â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
0  â”‚ X â”‚ X â”‚ O â”‚
   â”‚â”€â”€â”€â”‚â”€â”€â”€â”‚â”€â”€â”€â”‚
1  â”‚   â”‚ O â”‚   â”‚
   â”‚â”€â”€â”€â”‚â”€â”€â”€â”‚â”€â”€â”€â”‚
2  â”‚ X â”‚   â”‚   â”‚
   â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
</code></pre>
</div>
<p>If you want to see how it handles bigger boards, go ahead and <a href='/projects/arbitrarily-sized-tic-tac-toe/'>try it out</a>!</p>

<h2 id='full_solutions'>Full solutions</h2>

<p>Here is a nicely formatted version of my solutions to the exercises from Day 1 of Scala. The home of the following code is <a href='https://github.com/nickknw/seven-languages-in-seven-weeks/blob/master/week-4-scala/day1.scala'>on github</a> with the other exercises.</p>
<div id='formatted_solutions'>

<h3>Find:</h3>

<div class='question'><b>1.</b> The Scala API</div>

<p><a href='http://www.scala-lang.org/api/current/index.html'>http://www.scala-lang.org/api/current/index.html</a></p>

<div class='question'><b>2.</b> A comparison of Java and Scala</div>

<ul>
   <li>Quite a nice article, well-written, good detail level</li>
   <ul><li><li><a href='http://www.ibm.com/developerworks/java/library/j-scala01228/index.html'>http://www.ibm.com/developerworks/java/library/j-scala01228/index.html</a></li></li></ul>

   <li>Overiew/summary level comparison of Java, Scala, Groovy, Clojure</li>
   <ul><li><li><a href='http://stackoverflow.com/questions/1314732/scala-vs-groovy-vs-clojure'>http://stackoverflow.com/questions/1314732/scala-vs-groovy-vs-clojure</a></li></li></ul>

   <li>This is funny and kind of revealing, even if the question leads to a bit of a biased picture.</li>
   <ul><li><li><a href='http://stackoverflow.com/questions/2952732/samples-of-scala-and-java-code-where-scala-code-looks-simpler-has-fewer-lines'>http://stackoverflow.com/questions/2952732/samples-of-scala-and-java-code-where-scala-code-looks-simpler-has-fewer-lines</a></li></li></ul>

   <li>More low-level comparison</li>
   <ul><li><li><a href='http://blogs.sun.com/sundararajan/entry/scala_for_java_programmers'>http://blogs.sun.com/sundararajan/entry/scala_for_java_programmers</a></li></li></ul>

   <li>Some more</li>
   <ul><li><li><a href='http://www.artima.com/scalazine/articles/scalable-language.html'>http://www.artima.com/scalazine/articles/scalable-language.html</a></li></li>
   <li><li><a href='http://www.ibm.com/developerworks/java/library/j-scala01228/index.html'>http://www.ibm.com/developerworks/java/library/j-scala01228/index.html</a></li></li></ul>
</ul>

<div class='question'><b>3.</b> A discussion of val versus var</div>

<p><a href='http://stackoverflow.com/questions/1791408/what-is-the-difference-between-a-var-and-val-definition-in-scala'>http://stackoverflow.com/questions/1791408/what-is-the-difference-between-a-var-and-val-definition-in-scala</a></p>

<h3>Do:</h3>

<div class='question'><b>1.</b> Write a game that will take a tic-tac-toe board with X, O, and blank characters and detect the winner or whether there is a tie or no winner yet.  Use classes where appropriate.</div>


<div class='highlight'><pre><code class='scala'><span class='c1'>// Run this file with &#39;scala -Dfile.encoding=UTF-8 day1.scala&#39;</span>

<span class='k'>sealed</span> <span class='k'>abstract</span> <span class='k'>class</span> <span class='nc'>Player</span>
<span class='k'>case</span> <span class='k'>object</span> <span class='nc'>X</span> <span class='k'>extends</span> <span class='nc'>Player</span>
<span class='k'>case</span> <span class='k'>object</span> <span class='nc'>O</span> <span class='k'>extends</span> <span class='nc'>Player</span>
<span class='k'>case</span> <span class='k'>object</span> <span class='nc'>Blank</span> <span class='k'>extends</span> <span class='nc'>Player</span> <span class='o'>{</span>
    <span class='k'>override</span> <span class='k'>def</span> <span class='n'>toString</span> <span class='k'>=</span> <span class='s'>&quot; &quot;</span>
<span class='o'>}</span>

<span class='k'>object</span> <span class='nc'>GameResult</span> <span class='k'>extends</span> <span class='nc'>Enumeration</span> <span class='o'>{</span>
    <span class='k'>type</span> <span class='kt'>GameResult</span> <span class='o'>=</span> <span class='nc'>Value</span>
    <span class='k'>val</span> <span class='n'>X</span><span class='o'>,</span> <span class='n'>O</span><span class='o'>,</span> <span class='nc'>Tie</span><span class='o'>,</span> <span class='nc'>NoResult</span> <span class='k'>=</span> <span class='nc'>Value</span>

    <span class='k'>def</span> <span class='n'>displayGameResult</span><span class='o'>(</span><span class='n'>gameResult</span><span class='k'>:</span> <span class='kt'>GameResult</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>String</span> <span class='o'>=</span> <span class='o'>{</span>
        <span class='k'>val</span> <span class='n'>winnerText</span> <span class='k'>=</span> <span class='s'>&quot;Player %s won!&quot;</span>

        <span class='n'>gameResult</span> <span class='k'>match</span> <span class='o'>{</span>
            <span class='k'>case</span> <span class='nc'>GameResult</span><span class='o'>.</span><span class='nc'>NoResult</span> <span class='k'>=&gt;</span> <span class='s'>&quot;No winner yet!&quot;</span>
            <span class='k'>case</span> <span class='nc'>GameResult</span><span class='o'>.</span><span class='nc'>Tie</span> <span class='k'>=&gt;</span> <span class='s'>&quot;It&#39;s a tie!&quot;</span>
            <span class='k'>case</span> <span class='n'>player</span> <span class='k'>=&gt;</span> <span class='n'>winnerText</span><span class='o'>.</span><span class='n'>format</span><span class='o'>(</span><span class='n'>player</span><span class='o'>)</span>
        <span class='o'>}</span>
    <span class='o'>}</span>
<span class='o'>}</span>

<span class='k'>class</span> <span class='nc'>TicTacToeBoard</span><span class='o'>(</span><span class='n'>board</span> <span class='k'>:</span> <span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]])</span> <span class='o'>{</span>

    <span class='k'>def</span> <span class='k'>this</span><span class='o'>(</span><span class='n'>stringBoard</span><span class='k'>:</span> <span class='kt'>Array</span><span class='o'>[</span><span class='kt'>String</span><span class='o'>])</span> <span class='k'>=</span> <span class='k'>this</span><span class='o'>(</span><span class='n'>stringBoard</span><span class='o'>.</span><span class='n'>map</span><span class='o'>(</span><span class='n'>row</span> <span class='k'>=&gt;</span> <span class='nc'>TicTacToeBoard</span><span class='o'>.</span><span class='n'>getPlayersFromString</span><span class='o'>(</span><span class='n'>row</span><span class='o'>)))</span>
    <span class='k'>def</span> <span class='k'>this</span><span class='o'>(</span><span class='n'>rows</span><span class='k'>:</span> <span class='kt'>Int</span><span class='o'>,</span> <span class='n'>cols</span><span class='k'>:</span> <span class='kt'>Int</span><span class='o'>)</span> <span class='k'>=</span> <span class='k'>this</span><span class='o'>(</span><span class='nc'>Array</span><span class='o'>.</span><span class='n'>fill</span><span class='o'>(</span><span class='n'>rows</span><span class='o'>,</span> <span class='n'>cols</span><span class='o'>)(</span><span class='nc'>Blank</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]])</span>
    <span class='k'>def</span> <span class='k'>this</span><span class='o'>(</span><span class='n'>size</span><span class='k'>:</span> <span class='kt'>Int</span><span class='o'>)</span> <span class='k'>=</span> <span class='k'>this</span><span class='o'>(</span><span class='n'>size</span><span class='o'>,</span> <span class='n'>size</span><span class='o'>)</span>

    <span class='k'>val</span> <span class='n'>rowCount</span> <span class='k'>=</span> <span class='n'>board</span><span class='o'>.</span><span class='n'>length</span>
    <span class='k'>val</span> <span class='n'>columnCount</span> <span class='k'>=</span> <span class='k'>if</span> <span class='o'>(</span><span class='n'>board</span><span class='o'>.</span><span class='n'>isEmpty</span><span class='o'>)</span> <span class='mi'>0</span> <span class='k'>else</span> <span class='n'>board</span><span class='o'>(</span><span class='mi'>0</span><span class='o'>).</span><span class='n'>length</span>
    <span class='k'>val</span> <span class='n'>columnNameMapping</span> <span class='k'>=</span> <span class='o'>(</span><span class='mi'>0</span> <span class='n'>until</span> <span class='mi'>5</span><span class='o'>*</span><span class='n'>columnCount</span><span class='o'>).</span><span class='n'>map</span><span class='o'>(</span><span class='n'>n</span> <span class='k'>=&gt;</span> <span class='o'>(</span><span class='nc'>TicTacToeBoard</span><span class='o'>.</span><span class='n'>numToAlpha</span><span class='o'>(</span><span class='n'>n</span><span class='o'>),</span> <span class='n'>n</span><span class='o'>)).</span><span class='n'>toMap</span>

    <span class='k'>val</span> <span class='n'>numInARowNeeded</span> <span class='k'>:</span> <span class='kt'>Int</span> <span class='o'>=</span> <span class='o'>{</span>
        <span class='c1'>// numbers chosen rather arbitrarily by me. I looked at this: http://en.wikipedia.org/wiki/M,n,k-game</span>
        <span class='c1'>// and tried to pick numbers that more or less made sense</span>
        <span class='k'>if</span><span class='o'>(</span><span class='n'>rowCount</span> <span class='o'>&lt;=</span> <span class='mi'>3</span><span class='o'>||</span> <span class='n'>columnCount</span> <span class='o'>&lt;=</span> <span class='mi'>3</span><span class='o'>)</span>
        <span class='o'>{</span>
            <span class='c1'>// tic tac toe or bizarre tiny variants</span>
            <span class='n'>scala</span><span class='o'>.</span><span class='n'>math</span><span class='o'>.</span><span class='n'>min</span><span class='o'>(</span><span class='n'>rowCount</span><span class='o'>,</span> <span class='n'>columnCount</span><span class='o'>)</span>
        <span class='o'>}</span> <span class='k'>else</span> <span class='k'>if</span><span class='o'>(</span><span class='n'>rowCount</span> <span class='o'>&lt;=</span> <span class='mi'>5</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='c1'>// connect 4, sort of</span>
            <span class='mi'>4</span>
        <span class='o'>}</span> <span class='k'>else</span> <span class='k'>if</span><span class='o'>(</span><span class='n'>rowCount</span> <span class='o'>&lt;=</span> <span class='mi'>14</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='c1'>// gomoku</span>
            <span class='mi'>5</span>
        <span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
            <span class='c1'>// connect6. Seems like a good place to leave it</span>
            <span class='mi'>6</span>
        <span class='o'>}</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>rows</span><span class='k'>:</span> <span class='kt'>Seq</span><span class='o'>[</span><span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]]</span> <span class='k'>=</span> <span class='o'>{</span>
        <span class='k'>for</span><span class='o'>(</span><span class='n'>r</span> <span class='k'>&lt;-</span> <span class='mi'>0</span> <span class='n'>until</span> <span class='n'>rowCount</span><span class='o'>)</span> 
            <span class='k'>yield</span> <span class='n'>board</span><span class='o'>(</span><span class='n'>r</span><span class='o'>)</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>columns</span><span class='k'>:</span> <span class='kt'>Seq</span><span class='o'>[</span><span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]]</span> <span class='k'>=</span> <span class='o'>{</span>
        <span class='k'>for</span><span class='o'>(</span><span class='n'>c</span> <span class='k'>&lt;-</span> <span class='mi'>0</span> <span class='n'>until</span> <span class='n'>columnCount</span><span class='o'>)</span> <span class='k'>yield</span> <span class='o'>(</span>
            <span class='k'>for</span><span class='o'>(</span><span class='n'>r</span> <span class='k'>&lt;-</span> <span class='o'>(</span><span class='mi'>0</span> <span class='n'>until</span> <span class='n'>rowCount</span><span class='o'>))</span> 
                <span class='k'>yield</span> <span class='n'>board</span><span class='o'>(</span><span class='n'>r</span><span class='o'>)(</span><span class='n'>c</span><span class='o'>)).</span><span class='n'>toArray</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>diagonalsLTR</span><span class='k'>:</span> <span class='kt'>Seq</span><span class='o'>[</span><span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]]</span> <span class='k'>=</span> <span class='o'>{</span>
        <span class='k'>for</span><span class='o'>(</span><span class='n'>offset</span> <span class='k'>&lt;-</span> <span class='o'>(</span><span class='mi'>1</span><span class='o'>-</span><span class='n'>columnCount</span><span class='o'>)</span> <span class='n'>until</span> <span class='n'>columnCount</span><span class='o'>)</span> <span class='k'>yield</span> <span class='o'>(</span>
            <span class='k'>for</span><span class='o'>(</span><span class='n'>row</span> <span class='k'>&lt;-</span> <span class='mi'>0</span> <span class='n'>until</span> <span class='n'>rowCount</span> <span class='k'>if</span> <span class='n'>offset</span> <span class='o'>+</span> <span class='n'>row</span> <span class='o'>&lt;</span> <span class='n'>columnCount</span> <span class='o'>&amp;&amp;</span> <span class='n'>offset</span> <span class='o'>+</span> <span class='n'>row</span> <span class='o'>&gt;</span> <span class='o'>-</span><span class='mi'>1</span><span class='o'>)</span>
                <span class='k'>yield</span><span class='o'>(</span><span class='n'>board</span><span class='o'>(</span><span class='n'>row</span><span class='o'>)(</span><span class='n'>row</span><span class='o'>+</span><span class='n'>offset</span><span class='o'>))).</span><span class='n'>toArray</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>diagonalsRTL</span><span class='k'>:</span> <span class='kt'>Seq</span><span class='o'>[</span><span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]]</span>  <span class='k'>=</span> <span class='o'>{</span>
        <span class='k'>for</span><span class='o'>(</span><span class='n'>offset</span> <span class='k'>&lt;-</span> <span class='mi'>0</span> <span class='n'>until</span> <span class='n'>rowCount</span> <span class='o'>+</span> <span class='n'>rowCount</span> <span class='o'>-</span> <span class='mi'>1</span><span class='o'>)</span> <span class='k'>yield</span> <span class='o'>(</span>
            <span class='k'>for</span><span class='o'>(</span><span class='n'>col</span> <span class='k'>&lt;-</span> <span class='mi'>0</span> <span class='n'>until</span> <span class='n'>columnCount</span> <span class='k'>if</span> <span class='n'>offset</span> <span class='o'>-</span> <span class='n'>col</span> <span class='o'>&lt;</span> <span class='n'>rowCount</span> <span class='o'>&amp;&amp;</span> <span class='n'>offset</span> <span class='o'>-</span> <span class='n'>col</span> <span class='o'>&gt;</span> <span class='o'>-</span><span class='mi'>1</span><span class='o'>)</span>
                <span class='k'>yield</span><span class='o'>(</span><span class='n'>board</span><span class='o'>(</span><span class='n'>offset</span> <span class='o'>-</span> <span class='n'>col</span><span class='o'>)(</span><span class='n'>col</span><span class='o'>))).</span><span class='n'>toArray</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>determineWinner</span> <span class='k'>:</span> <span class='kt'>GameResult.Value</span> <span class='o'>=</span> <span class='o'>{</span>
        <span class='k'>val</span> <span class='n'>winnerText</span> <span class='k'>=</span> <span class='s'>&quot;Player %s won!&quot;</span>
        <span class='k'>val</span> <span class='n'>checkForWinner</span> <span class='k'>=</span> <span class='o'>{</span> <span class='n'>array</span> <span class='k'>:</span> <span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]</span> <span class='k'>=&gt;</span>
            <span class='nc'>TicTacToeBoard</span><span class='o'>.</span><span class='n'>nInARow</span><span class='o'>(</span><span class='n'>numInARowNeeded</span><span class='o'>,</span> <span class='n'>array</span><span class='o'>)</span> <span class='k'>match</span> <span class='o'>{</span>
                <span class='k'>case</span> <span class='nc'>Some</span><span class='o'>(</span><span class='n'>player</span><span class='o'>)</span> <span class='k'>=&gt;</span> <span class='k'>return</span> <span class='n'>player</span> <span class='k'>match</span> <span class='o'>{</span> <span class='c1'>// non-local return!</span>
                    <span class='k'>case</span> <span class='n'>X</span> <span class='k'>=&gt;</span> <span class='nc'>GameResult</span><span class='o'>.</span><span class='n'>X</span>
                    <span class='k'>case</span> <span class='n'>O</span> <span class='k'>=&gt;</span> <span class='nc'>GameResult</span><span class='o'>.</span><span class='n'>O</span>
                    <span class='k'>case</span> <span class='n'>other</span> <span class='k'>=&gt;</span> <span class='k'>throw</span> <span class='k'>new</span> <span class='nc'>Exception</span><span class='o'>(</span><span class='s'>&quot;Error, &#39;&quot;</span> <span class='o'>+</span> <span class='n'>other</span> <span class='o'>+</span> <span class='s'>&quot;&#39; is not a player.&quot;</span><span class='o'>)</span>
                <span class='o'>}</span>
                <span class='k'>case</span> <span class='nc'>None</span> <span class='k'>=&gt;</span> <span class='c1'>// do nothing</span>
            <span class='o'>}</span>
        <span class='o'>}</span>

        <span class='n'>rows</span> <span class='n'>foreach</span> <span class='n'>checkForWinner</span>
        <span class='n'>columns</span> <span class='n'>foreach</span> <span class='n'>checkForWinner</span>
        <span class='n'>diagonalsLTR</span> <span class='n'>foreach</span> <span class='n'>checkForWinner</span>
        <span class='n'>diagonalsRTL</span> <span class='n'>foreach</span> <span class='n'>checkForWinner</span>

        <span class='k'>if</span><span class='o'>(</span><span class='n'>board</span><span class='o'>.</span><span class='n'>map</span><span class='o'>(</span><span class='n'>row</span> <span class='k'>=&gt;</span> <span class='n'>row</span><span class='o'>.</span><span class='n'>contains</span><span class='o'>(</span><span class='nc'>Blank</span><span class='o'>)).</span><span class='n'>contains</span><span class='o'>(</span><span class='kc'>true</span><span class='o'>))</span> <span class='o'>{</span>
            <span class='k'>return</span> <span class='nc'>GameResult</span><span class='o'>.</span><span class='nc'>NoResult</span>
        <span class='o'>}</span>

        <span class='k'>return</span> <span class='nc'>GameResult</span><span class='o'>.</span><span class='nc'>Tie</span>
    <span class='o'>}</span>

    <span class='k'>override</span> <span class='k'>def</span> <span class='n'>toString</span> <span class='k'>:</span> <span class='kt'>String</span> <span class='o'>=</span> <span class='o'>{</span>
        <span class='k'>var</span> <span class='n'>boardRepresentation</span> <span class='k'>=</span> <span class='s'>&quot;&quot;</span>

        <span class='k'>def</span> <span class='n'>p</span> <span class='k'>=</span> <span class='o'>{</span> <span class='n'>str</span> <span class='k'>:</span> <span class='kt'>String</span> <span class='o'>=&gt;</span> <span class='n'>boardRepresentation</span> <span class='k'>=</span> <span class='n'>boardRepresentation</span><span class='o'>.</span><span class='n'>concat</span><span class='o'>(</span><span class='n'>str</span> <span class='o'>+</span> <span class='s'>&quot;\n&quot;</span><span class='o'>)</span> <span class='o'>}</span>

        <span class='k'>val</span> <span class='n'>topLine</span> <span class='k'>=</span> <span class='o'>(</span><span class='mi'>1</span> <span class='n'>until</span> <span class='n'>columnCount</span><span class='o'>).</span><span class='n'>foldLeft</span><span class='o'>(</span><span class='s'>&quot;   â”Œ&quot;</span><span class='o'>)((</span><span class='n'>acc</span><span class='o'>,</span> <span class='n'>c</span><span class='o'>)</span> <span class='k'>=&gt;</span> <span class='n'>acc</span><span class='o'>.</span><span class='n'>concat</span><span class='o'>(</span><span class='s'>&quot;â”€â”€â”€â”¬&quot;</span><span class='o'>)).</span><span class='n'>concat</span><span class='o'>(</span><span class='s'>&quot;â”€â”€â”€â”&quot;</span><span class='o'>)</span>
        <span class='k'>val</span> <span class='n'>middleLine</span> <span class='k'>=</span> <span class='o'>(</span><span class='mi'>0</span> <span class='n'>until</span> <span class='n'>columnCount</span><span class='o'>).</span><span class='n'>foldLeft</span><span class='o'>(</span><span class='s'>&quot;   â”‚&quot;</span><span class='o'>)((</span><span class='n'>acc</span><span class='o'>,</span> <span class='n'>c</span><span class='o'>)</span> <span class='k'>=&gt;</span> <span class='n'>acc</span><span class='o'>.</span><span class='n'>concat</span><span class='o'>(</span><span class='s'>&quot;â”€â”€â”€â”‚&quot;</span><span class='o'>))</span>
        <span class='k'>val</span> <span class='n'>bottomLine</span> <span class='k'>=</span> <span class='o'>(</span><span class='mi'>1</span> <span class='n'>until</span> <span class='n'>columnCount</span><span class='o'>).</span><span class='n'>foldLeft</span><span class='o'>(</span><span class='s'>&quot;   â””&quot;</span><span class='o'>)((</span><span class='n'>acc</span><span class='o'>,</span> <span class='n'>c</span><span class='o'>)</span> <span class='k'>=&gt;</span> <span class='n'>acc</span><span class='o'>.</span><span class='n'>concat</span><span class='o'>(</span><span class='s'>&quot;â”€â”€â”€â”´&quot;</span><span class='o'>)).</span><span class='n'>concat</span><span class='o'>(</span><span class='s'>&quot;â”€â”€â”€â”˜&quot;</span><span class='o'>)</span>

        <span class='n'>p</span><span class='o'>(</span><span class='s'>&quot;&quot;</span><span class='o'>)</span>
        <span class='n'>p</span><span class='o'>((</span><span class='mi'>0</span> <span class='n'>until</span> <span class='n'>columnCount</span><span class='o'>).</span><span class='n'>foldLeft</span><span class='o'>(</span><span class='s'>&quot;     &quot;</span><span class='o'>)((</span><span class='n'>acc</span><span class='o'>,</span> <span class='n'>n</span><span class='o'>)</span> <span class='k'>=&gt;</span> <span class='n'>acc</span><span class='o'>.</span><span class='n'>concat</span><span class='o'>(</span><span class='s'>&quot;%-4s&quot;</span><span class='o'>.</span><span class='n'>format</span><span class='o'>(</span><span class='nc'>TicTacToeBoard</span><span class='o'>.</span><span class='n'>numToAlpha</span><span class='o'>(</span><span class='n'>n</span><span class='o'>)))))</span>
        <span class='n'>p</span><span class='o'>(</span><span class='n'>topLine</span><span class='o'>)</span>
        <span class='k'>for</span><span class='o'>(</span><span class='n'>r</span> <span class='k'>&lt;-</span> <span class='mi'>0</span> <span class='n'>until</span> <span class='n'>rowCount</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='k'>var</span> <span class='n'>rowString</span> <span class='k'>=</span> <span class='s'>&quot;%-3d&quot;</span><span class='o'>.</span><span class='n'>format</span><span class='o'>(</span><span class='n'>r</span><span class='o'>).</span><span class='n'>concat</span><span class='o'>(</span><span class='s'>&quot;â”‚&quot;</span><span class='o'>)</span>
            <span class='k'>for</span><span class='o'>(</span><span class='n'>c</span> <span class='k'>&lt;-</span> <span class='mi'>0</span> <span class='n'>until</span> <span class='n'>columnCount</span><span class='o'>)</span> <span class='o'>{</span>
                <span class='n'>rowString</span> <span class='k'>=</span> <span class='n'>rowString</span><span class='o'>.</span><span class='n'>concat</span><span class='o'>(</span><span class='s'>&quot; %s â”‚&quot;</span><span class='o'>.</span><span class='n'>format</span><span class='o'>(</span><span class='n'>board</span><span class='o'>(</span><span class='n'>r</span><span class='o'>)(</span><span class='n'>c</span><span class='o'>)))</span>
            <span class='o'>}</span>
            <span class='n'>p</span><span class='o'>(</span><span class='n'>rowString</span><span class='o'>)</span>
            <span class='k'>if</span><span class='o'>(</span><span class='n'>r</span> <span class='o'>&lt;</span> <span class='n'>rowCount</span><span class='o'>-</span><span class='mi'>1</span><span class='o'>)</span> <span class='o'>{</span>
                <span class='n'>p</span><span class='o'>(</span><span class='n'>middleLine</span><span class='o'>)</span>
            <span class='o'>}</span>
        <span class='o'>}</span>
        <span class='n'>p</span><span class='o'>(</span><span class='n'>bottomLine</span><span class='o'>)</span>
        <span class='n'>p</span><span class='o'>(</span><span class='s'>&quot;&quot;</span><span class='o'>)</span>

        <span class='k'>return</span> <span class='n'>boardRepresentation</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>validMove</span><span class='o'>(</span><span class='n'>row</span> <span class='k'>:</span> <span class='kt'>Int</span><span class='o'>,</span> <span class='n'>col</span> <span class='k'>:</span> <span class='kt'>Int</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>Boolean</span> <span class='o'>=</span> <span class='o'>{</span>
        <span class='k'>return</span> <span class='n'>row</span> <span class='o'>&lt;</span> <span class='n'>rowCount</span> <span class='o'>&amp;&amp;</span> <span class='n'>row</span> <span class='o'>&gt;=</span> <span class='mi'>0</span> <span class='o'>&amp;&amp;</span> <span class='n'>col</span> <span class='o'>&lt;</span> <span class='n'>columnCount</span> <span class='o'>&amp;&amp;</span> <span class='n'>col</span> <span class='o'>&gt;=</span> <span class='mi'>0</span> <span class='o'>&amp;&amp;</span> <span class='n'>board</span><span class='o'>(</span><span class='n'>row</span><span class='o'>)(</span><span class='n'>col</span><span class='o'>)</span> <span class='o'>==</span> <span class='nc'>Blank</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>update</span><span class='o'>(</span><span class='n'>row</span> <span class='k'>:</span> <span class='kt'>Int</span><span class='o'>,</span> <span class='n'>col</span> <span class='k'>:</span> <span class='kt'>Int</span><span class='o'>,</span> <span class='n'>player</span> <span class='k'>:</span> <span class='kt'>Player</span><span class='o'>)</span> <span class='k'>=</span> <span class='o'>{</span>
        <span class='n'>board</span><span class='o'>(</span><span class='n'>row</span><span class='o'>)(</span><span class='n'>col</span><span class='o'>)</span> <span class='k'>=</span> <span class='n'>player</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>columnNumber</span><span class='o'>(</span><span class='n'>columnName</span> <span class='k'>:</span> <span class='kt'>String</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>Int</span> <span class='o'>=</span> <span class='o'>{</span>
        <span class='k'>return</span> <span class='n'>columnNameMapping</span><span class='o'>(</span><span class='n'>columnName</span><span class='o'>)</span>
    <span class='o'>}</span>
<span class='o'>}</span>

<span class='k'>object</span> <span class='nc'>TicTacToeBoard</span> <span class='o'>{</span>

    <span class='k'>def</span> <span class='n'>numToAlpha</span><span class='o'>(</span><span class='n'>number</span> <span class='k'>:</span> <span class='kt'>Int</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>String</span> <span class='o'>=</span> <span class='o'>{</span>
        <span class='k'>var</span> <span class='n'>dividend</span> <span class='k'>=</span> <span class='n'>number</span> <span class='o'>+</span> <span class='mi'>1</span> <span class='c1'>// internally, treat 1 as A - just makes it easier</span>
        <span class='k'>var</span> <span class='n'>letters</span> <span class='k'>=</span> <span class='s'>&quot;&quot;</span>
        <span class='k'>var</span> <span class='n'>modulo</span> <span class='k'>=</span> <span class='mi'>0</span>

        <span class='k'>while</span><span class='o'>(</span><span class='n'>dividend</span> <span class='o'>&gt;</span> <span class='mi'>0</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='n'>modulo</span> <span class='k'>=</span> <span class='o'>(</span><span class='n'>dividend</span> <span class='o'>-</span> <span class='mi'>1</span><span class='o'>)</span> <span class='o'>%</span> <span class='mi'>26</span>
            <span class='n'>letters</span> <span class='k'>=</span> <span class='o'>(</span><span class='mi'>65</span> <span class='o'>+</span> <span class='n'>modulo</span><span class='o'>).</span><span class='n'>toChar</span> <span class='o'>+</span> <span class='n'>letters</span>
            <span class='n'>dividend</span> <span class='k'>=</span> <span class='o'>(</span><span class='n'>dividend</span> <span class='o'>-</span> <span class='n'>modulo</span><span class='o'>)</span> <span class='o'>/</span> <span class='mi'>26</span>
        <span class='o'>}</span>

        <span class='k'>return</span> <span class='n'>letters</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>getPlayersFromString</span><span class='o'>(</span><span class='n'>row</span> <span class='k'>:</span> <span class='kt'>String</span><span class='o'>)</span> <span class='k'>:</span> <span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]</span> <span class='k'>=</span> <span class='o'>{</span>
        <span class='n'>row</span><span class='o'>.</span><span class='n'>map</span><span class='o'>(</span><span class='n'>char</span> <span class='k'>=&gt;</span> <span class='o'>{</span> <span class='k'>if</span><span class='o'>(</span><span class='n'>char</span> <span class='o'>==</span> <span class='-Symbol'>&#39;X</span><span class='err'>&#39;</span><span class='o'>)</span> <span class='n'>X</span> <span class='k'>:</span> <span class='kt'>Player</span> <span class='kt'>else</span> <span class='kt'>if</span><span class='o'>(</span><span class='kt'>char</span> <span class='o'>==</span> <span class='-Symbol'>&#39;O</span><span class='err'>&#39;</span><span class='o'>)</span> <span class='n'>O</span> <span class='k'>:</span> <span class='kt'>Player</span> <span class='kt'>else</span> <span class='kt'>Blank</span> <span class='kt'>:</span> <span class='kt'>Player</span> <span class='o'>}</span> <span class='o'>).</span><span class='n'>toArray</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>threeInARow</span><span class='o'>(</span><span class='n'>list</span> <span class='k'>:</span> <span class='kt'>List</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>])</span> <span class='k'>:</span> <span class='kt'>Option</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]</span> <span class='k'>=</span> <span class='n'>list</span> <span class='k'>match</span> <span class='o'>{</span>
        <span class='k'>case</span> <span class='nc'>Nil</span> <span class='k'>=&gt;</span> <span class='nc'>None</span>
        <span class='k'>case</span> <span class='n'>x</span> <span class='o'>::</span> <span class='n'>y</span> <span class='o'>::</span> <span class='n'>z</span> <span class='o'>::</span> <span class='n'>tail</span> <span class='k'>if</span> <span class='n'>x</span> <span class='o'>==</span> <span class='n'>y</span> <span class='o'>&amp;&amp;</span> <span class='n'>y</span> <span class='o'>==</span> <span class='n'>z</span> <span class='o'>&amp;&amp;</span> <span class='n'>z</span> <span class='o'>!=</span> <span class='nc'>Blank</span> <span class='k'>=&gt;</span> <span class='nc'>Some</span><span class='o'>(</span><span class='n'>z</span><span class='o'>)</span>
        <span class='k'>case</span> <span class='k'>_</span> <span class='o'>::</span> <span class='n'>tail</span> <span class='k'>=&gt;</span> <span class='n'>threeInARow</span><span class='o'>(</span><span class='n'>tail</span><span class='o'>)</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>nInARow</span><span class='o'>(</span><span class='n'>n</span> <span class='k'>:</span> <span class='kt'>Int</span><span class='o'>,</span> <span class='n'>array</span> <span class='k'>:</span> <span class='kt'>Array</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>])</span> <span class='k'>:</span> <span class='kt'>Option</span><span class='o'>[</span><span class='kt'>Player</span><span class='o'>]</span> <span class='k'>=</span> <span class='o'>{</span>
        <span class='k'>for</span><span class='o'>(</span><span class='n'>i</span> <span class='k'>&lt;-</span> <span class='mi'>0</span> <span class='n'>until</span> <span class='n'>array</span><span class='o'>.</span><span class='n'>length</span> <span class='o'>-</span> <span class='o'>(</span><span class='n'>n</span><span class='o'>-</span><span class='mi'>1</span><span class='o'>))</span> <span class='o'>{</span>
            <span class='k'>var</span> <span class='n'>allTrue</span> <span class='k'>=</span> <span class='kc'>true</span><span class='o'>;</span>
            <span class='k'>for</span><span class='o'>(</span><span class='n'>j</span> <span class='k'>&lt;-</span> <span class='n'>i</span><span class='o'>+</span><span class='mi'>1</span> <span class='n'>until</span> <span class='n'>i</span><span class='o'>+</span><span class='n'>n</span><span class='o'>)</span> <span class='o'>{</span>
                <span class='n'>allTrue</span> <span class='o'>&amp;=</span> <span class='n'>array</span><span class='o'>(</span><span class='n'>j</span><span class='o'>-</span><span class='mi'>1</span><span class='o'>)</span> <span class='o'>==</span> <span class='n'>array</span><span class='o'>(</span><span class='n'>j</span><span class='o'>)</span>
            <span class='o'>}</span>
            <span class='k'>if</span><span class='o'>(</span><span class='n'>allTrue</span> <span class='o'>&amp;&amp;</span> <span class='n'>array</span><span class='o'>(</span><span class='n'>i</span><span class='o'>)</span> <span class='o'>!=</span> <span class='nc'>Blank</span><span class='o'>)</span> <span class='o'>{</span>
                <span class='k'>return</span> <span class='nc'>Some</span><span class='o'>(</span><span class='n'>array</span><span class='o'>(</span><span class='n'>i</span><span class='o'>))</span>
            <span class='o'>}</span>
        <span class='o'>}</span>

        <span class='k'>return</span> <span class='nc'>None</span>
    <span class='o'>}</span>

<span class='o'>}</span>
</code></pre></div>


<div class='question'><b>2.</b> Bonus Problem: Let two players play tic-tac-toe.</div>


<div class='highlight'><pre><code class='scala'><span class='k'>object</span> <span class='nc'>Game</span> <span class='o'>{</span>
    <span class='k'>val</span> <span class='nc'>Position</span> <span class='k'>=</span> <span class='s'>&quot;&quot;&quot;([A-Za-z]+)\s*(\d+)&quot;&quot;&quot;</span><span class='o'>.</span><span class='n'>r</span>

    <span class='k'>def</span> <span class='n'>main</span><span class='o'>(</span><span class='n'>args</span><span class='k'>:</span><span class='kt'>Array</span><span class='o'>[</span><span class='kt'>String</span><span class='o'>])</span> <span class='o'>{</span>
        <span class='k'>val</span> <span class='n'>size</span> <span class='k'>=</span> <span class='n'>readBoardSize</span>
        <span class='k'>var</span> <span class='n'>board</span> <span class='k'>=</span> <span class='k'>new</span> <span class='nc'>TicTacToeBoard</span><span class='o'>(</span><span class='n'>size</span><span class='o'>)</span>
        <span class='n'>println</span><span class='o'>(</span><span class='s'>&quot;\n&quot;</span> <span class='o'>+</span> <span class='n'>board</span><span class='o'>.</span><span class='n'>numInARowNeeded</span> <span class='o'>+</span> <span class='s'>&quot; in a row to win (&quot;</span> <span class='o'>+</span> <span class='n'>size</span> <span class='o'>+</span> <span class='s'>&quot;x&quot;</span> <span class='o'>+</span> <span class='n'>size</span> <span class='o'>+</span> <span class='s'>&quot; board)&quot;</span><span class='o'>)</span>

        <span class='k'>var</span> <span class='n'>player</span> <span class='k'>:</span> <span class='kt'>Player</span> <span class='o'>=</span> <span class='n'>X</span>
        <span class='k'>while</span><span class='o'>(</span><span class='n'>board</span><span class='o'>.</span><span class='n'>determineWinner</span> <span class='o'>==</span> <span class='nc'>GameResult</span><span class='o'>.</span><span class='nc'>NoResult</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='n'>println</span><span class='o'>(</span><span class='n'>board</span><span class='o'>)</span>
            <span class='n'>println</span><span class='o'>(</span><span class='s'>&quot;Player %s&#39;s turn.&quot;</span><span class='o'>.</span><span class='n'>format</span><span class='o'>(</span><span class='n'>player</span><span class='o'>))</span>

            <span class='k'>val</span> <span class='o'>(</span><span class='n'>row</span><span class='o'>,</span> <span class='n'>col</span><span class='o'>)</span> <span class='k'>=</span> <span class='n'>readNextMove</span><span class='o'>(</span><span class='n'>board</span><span class='o'>)</span>
            <span class='n'>board</span><span class='o'>.</span><span class='n'>update</span><span class='o'>(</span><span class='n'>row</span><span class='o'>,</span> <span class='n'>col</span><span class='o'>,</span> <span class='n'>player</span><span class='o'>)</span>

            <span class='n'>player</span> <span class='k'>=</span> <span class='k'>if</span><span class='o'>(</span><span class='n'>player</span> <span class='o'>==</span> <span class='n'>X</span><span class='o'>)</span> <span class='n'>O</span> <span class='k'>else</span> <span class='n'>X</span>
        <span class='o'>}</span>

        <span class='n'>println</span><span class='o'>(</span><span class='n'>board</span><span class='o'>)</span>
        <span class='n'>println</span><span class='o'>(</span><span class='nc'>GameResult</span><span class='o'>.</span><span class='n'>displayGameResult</span><span class='o'>(</span><span class='n'>board</span><span class='o'>.</span><span class='n'>determineWinner</span><span class='o'>))</span>
        <span class='n'>println</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>readBoardSize</span><span class='k'>:</span> <span class='kt'>Int</span> <span class='o'>=</span> <span class='o'>{</span>
        <span class='k'>var</span> <span class='n'>size</span> <span class='k'>=</span> <span class='o'>-</span><span class='mi'>1</span>

        <span class='k'>while</span><span class='o'>(</span><span class='n'>size</span> <span class='o'>&lt;</span> <span class='mi'>1</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='k'>try</span> <span class='o'>{</span>
                <span class='n'>print</span><span class='o'>(</span><span class='s'>&quot;Enter board size: &quot;</span><span class='o'>)</span>
                <span class='n'>size</span> <span class='k'>=</span> <span class='nc'>Console</span><span class='o'>.</span><span class='n'>readInt</span>
            <span class='o'>}</span> <span class='k'>catch</span> <span class='o'>{</span>
                <span class='k'>case</span> <span class='n'>e</span> <span class='k'>=&gt;</span> <span class='o'>{</span> <span class='n'>size</span> <span class='k'>=</span> <span class='o'>-</span><span class='mi'>1</span> <span class='o'>}</span>
            <span class='o'>}</span>
            <span class='k'>if</span> <span class='o'>(</span><span class='n'>size</span> <span class='o'>&lt;</span> <span class='mi'>1</span><span class='o'>)</span> <span class='o'>{</span>
                <span class='n'>println</span><span class='o'>(</span><span class='s'>&quot;Invalid board size. Please enter a number greater than 0.&quot;</span><span class='o'>)</span>
            <span class='o'>}</span>
        <span class='o'>}</span>

        <span class='k'>return</span> <span class='n'>size</span>
    <span class='o'>}</span>

    <span class='k'>def</span> <span class='n'>readNextMove</span><span class='o'>(</span><span class='n'>board</span><span class='k'>:</span> <span class='kt'>TicTacToeBoard</span><span class='o'>)</span><span class='k'>:</span> <span class='o'>(</span><span class='kt'>Int</span><span class='o'>,</span> <span class='kt'>Int</span><span class='o'>)</span> <span class='k'>=</span> <span class='o'>{</span>
        <span class='k'>var</span> <span class='n'>validMove</span> <span class='k'>=</span> <span class='kc'>false</span>
        <span class='k'>var</span> <span class='n'>col</span> <span class='k'>=</span> <span class='o'>-</span><span class='mi'>1</span>
        <span class='k'>var</span> <span class='n'>row</span> <span class='k'>=</span> <span class='o'>-</span><span class='mi'>1</span>
        <span class='k'>while</span><span class='o'>(!</span><span class='n'>validMove</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='k'>var</span> <span class='n'>input</span> <span class='k'>=</span> <span class='s'>&quot;&quot;</span>
            <span class='k'>try</span> <span class='o'>{</span>
                <span class='n'>print</span><span class='o'>(</span><span class='s'>&quot;Enter square: (e.g. A0): &quot;</span><span class='o'>)</span>
                <span class='n'>input</span> <span class='k'>=</span> <span class='nc'>Console</span><span class='o'>.</span><span class='n'>readLine</span>
                <span class='k'>val</span> <span class='nc'>Position</span><span class='o'>(</span><span class='n'>columnName</span><span class='o'>,</span> <span class='n'>rowNumber</span><span class='o'>)</span> <span class='k'>=</span> <span class='n'>input</span>
                <span class='n'>row</span> <span class='k'>=</span> <span class='n'>rowNumber</span><span class='o'>.</span><span class='n'>toInt</span>
                <span class='n'>col</span> <span class='k'>=</span> <span class='n'>board</span><span class='o'>.</span><span class='n'>columnNumber</span><span class='o'>(</span><span class='n'>columnName</span><span class='o'>.</span><span class='n'>toUpperCase</span><span class='o'>)</span>
            <span class='o'>}</span> <span class='k'>catch</span> <span class='o'>{</span>
                <span class='k'>case</span> <span class='n'>e</span> <span class='k'>=&gt;</span> <span class='o'>{</span> <span class='n'>println</span><span class='o'>(</span><span class='s'>&quot;Error reading input: Could not understand \&quot;&quot;</span> <span class='o'>+</span> <span class='n'>input</span> <span class='o'>+</span> <span class='s'>&quot;\&quot;&quot;</span><span class='o'>)</span> <span class='o'>}</span>
            <span class='o'>}</span>

            <span class='n'>validMove</span> <span class='k'>=</span> <span class='n'>board</span><span class='o'>.</span><span class='n'>validMove</span><span class='o'>(</span><span class='n'>row</span><span class='o'>,</span> <span class='n'>col</span><span class='o'>)</span>
            <span class='k'>if</span><span class='o'>(!</span><span class='n'>validMove</span><span class='o'>)</span> <span class='o'>{</span>
                <span class='n'>println</span><span class='o'>(</span><span class='s'>&quot;Can&#39;t move there, try again!\n&quot;</span><span class='o'>)</span>
            <span class='o'>}</span>
        <span class='o'>}</span>

        <span class='k'>return</span> <span class='o'>(</span><span class='n'>row</span><span class='o'>,</span> <span class='n'>col</span><span class='o'>)</span>
    <span class='o'>}</span>

<span class='o'>}</span>

<span class='nc'>Game</span><span class='o'>.</span><span class='n'>main</span><span class='o'>(</span><span class='kc'>null</span><span class='o'>)</span>
</code></pre></div>

</div>
<p>Phew! That was a long one, eh? Once again, you can see more about the project by going to the <a href='/projects/arbitrarily-sized-tic-tac-toe/'>Tic Tac Toe project page</a> and you can learn more about this series of posts by going to the <a href='/projects/seven-languages-in-seven-weeks/'>Seven Languages project page</a>.</p>

<p>Next in this series: <a href='/blog/2013/04/10/seven-languages-week-4-day-2/'>Day 2 of Scala</a>.</p>
    <div style="margin-top:1.5em">
        <a href="/blog/2013/03/28/seven-languages-week-4-day-1/" style="font-size:18px;">Read More</a>
        â€”
        <a style="font-size:14px;" href="/blog/2013/03/28/seven-languages-week-4-day-1/#disqus_thread" data-disqus-identifier="/blog/2013/03/28/seven-languages-week-4-day-1">Comments</a>
    </div>
  </div>

  <hr class="fancyrule" />

  <div>
  <h1 style="margin:0px"><a href="/blog/2013/03/10/counting-powers-of-two/">
  Counting Powers of Two - A Neat Pattern
  </a></h1>
  <div class="faded" style="font-size:14px; margin-bottom:5px;">10 Mar 2013</div>
    <p>A little while ago I was going for a walk and searching for something to occupy my mind for a while. Something that would take my mind away from other problems and give it a simple, solvable, repetitive activity to do for a while. I hit upon counting up by powers of two.</p>

<p>Why? I&#8217;m a programmer, and powers of two are important and prevalent numbers in this field. By this point 128, 256 and 512 seem like nice round numbers to me, and I wouldn&#8217;t mind feeling the same way about 65,536 and 131,072. Also, counting powers of two has the virtue of getting hard before getting boring.</p>

<p>As I counted I noticed a neat pattern starting at the higher numbers. I thought it was pretty cool and maybe even a bit easier than doubling the numbers in the standard fashion (once you&#8217;re out of memorized territory anyway).</p>

<p>From what I&#8217;ve seen of this pattern it only works at and above 1024 (2<sup>10</sup>) so that&#8217;s what I&#8217;ll focus on.</p>

<h2 id='the_pattern'>The Pattern</h2>

<p>Take the number 1024 and split it into two parts, 1000 and 24. Keep on doing this:</p>

<pre><code>1000 and 24
2000 and 48
4000 and 96
8000 and 192</code></pre>

<p>There&#8217;s an interesting relationship between the thousands digit and the rest (well, there&#8217;s a few), do you see any yet?</p>

<p>What if I represent it like this:</p>

<pre><code>1000 + (25 - 1)
2000 + (50 - 2)
4000 + (100 - 4)
8000 + (200 - 8)</code></pre>

<p>You can just keep on going, doubling both numbers and subtracting the thousands digit from the other number. It is a pretty quick mental operation to double 200 and subtract 16. This isn&#8217;t the only way to express this relationship though:</p>

<pre><code>1000 + (24 * 1)
2000 + (24 * 2)
4000 + (24 * 4)
8000 + (24 * 8)</code></pre>

<p>It&#8217;s a simpler expression of the relationship but lacks the calculation shortcut the first one has. So what does these look like if you generalize them one step more&#8230;?</p>

<h2 id='the_formulas'>The Formulas</h2>

<p>Where <code>x</code> represents the thousands digits and is equal to 1 or greater (multiple digits work fine but substituting 0 in doesn&#8217;t end up making any sense):</p>

<pre><code>(x * 1000) + ((25 * x) - x)</code></pre>

<p>This can be simplified to:</p>

<pre><code>(x * 1000) + (24 * x)</code></pre>

<p>An interesting benefit is that now you can answer the question &#8220;Okay, <code>64kB</code>&#8230; 64 thousand and <em>how many</em> bytes?&#8221;</p>

<p>Well using the first formula it is <code>(25 * 64) - 64</code> bytes, but that&#8217;s easier to do with rounder numbers. The number you&#8217;re multiplying 25 by will always be easily divisible by 4 <sup><strong>note 1</strong></sup> and 100 is easier to multiply by than 25, so let&#8217;s multiply 25 by 4 and divide 64 by 4 to get <code>100 * 16</code>. It&#8217;s easy to instantly see that&#8217;s <code>1,600</code>. Now the subtraction: <code>1,600 - 64 = 1,536</code>. The answer is 64 thousand and <code>1,536</code> bytes, or <code>65,536</code> bytes. For those like me who were wondering, that&#8217;s 2<sup>16</sup>!</p>

<h2 id='in_closing'>In Closing</h2>

<p>I feel like this formula is only partway to somewhere - sure it&#8217;s a neat pattern but it is a bit awkward. I&#8217;d love to hear about any more cool patterns or neat mathematical tricks, if you know any and would like to share!</p>
<p><strong>note 1</strong> - Unless it's smaller than 4 in which case it doesn't matter, don't get too pedantic on me :)</p>
    <div style="margin-top:1.5em">
        <a href="/blog/2013/03/10/counting-powers-of-two/" style="font-size:18px;">Read More</a>
        â€”
        <a style="font-size:14px;" href="/blog/2013/03/10/counting-powers-of-two/#disqus_thread" data-disqus-identifier="/blog/2013/03/10/counting-powers-of-two">Comments</a>
    </div>
  </div>

  <hr class="fancyrule" />


<a href="/blog/archive/">â† Older posts</a>

  <script type="text/javascript">
      var disqus_shortname = 'nickknowlson'; 
  
      (function () {
          var s = document.createElement('script'); s.async = true;
          s.type = 'text/javascript';
          s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
          (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
  </script>

            </div>
        </div>
        <div id="footer">&copy; Copyright 2013 Nick Knowlson</div>
        <div style="display: none;">Content by Nick Knowlson: <a href="https://plus.google.com/104462106474002996122?rel=author" rel="me">Google+</a></div>
        <!--hacky way of reducing image loading lag when hovering over rss and
            twitter icons for now --><span style="display: none;"><img src="/img/rss-icon-lit.png" alt="rss" /><img src="/img/twitter-icon-lit.png" alt="twitter" /></span>
    <!-- HitTail Code -->
    <script type="text/javascript">
            (function(){ var ht = document.createElement('script');ht.async = true;
              ht.type='text/javascript';ht.src = '//103757.hittail.com/mlt.js';
              var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ht, s);})();
    </script>
    </body>
</html>
