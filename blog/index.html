<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
    <head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
        <meta name="description" content="The latest blog posts by Nick Knowlson.">

        <title>Blog | Nick Knowlson</title>

        <link rel="stylesheet" type="text/css" href="/css/site.css" >
        <link rel="stylesheet" type="text/css" href="/css/syntax.css" >
	<link rel="shortcut icon" href="/favicon.ico" />
	<link rel="apple-touch-icon-precomposed" href="/favicon.ico" >
        <link href="http://feeds.feedburner.com/NickKnowlson" type="application/atom+xml" rel="alternate" title="Blog ATOM Feed" />
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>

        
        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-24781362-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>
    </head>
    <body>
	<div id="header" class="grid grid-16">
            <a href="/"><img src="/img/logos/logo6.png" alt="logo" /></a>
            <ul id="nav">
                <li><a class="" href="/">Home</a></li>
                <li><a class="" href="/about/">About</a></li>
                <li><a class="" href="/projects/">Projects</a></li>
                <li><a class="selected" href="/blog/">Blog</a></li>
                <li><a class="" href="/contact/">Contact</a></li>
            </ul>
	</div>

        <div id="content" class="grid grid-16" style="background-color:white; clear:both;">
            <div style="padding:25px">
                <div style="text-align:center;"><b>Latest Posts</b> | <a href="/blog/archive/">Archive</a></div>

  <div>
  <h1 style="margin:0px"><a href="/blog/2012/02/05/seven-languages-week-3-day-1/">
  Seven Languages: Week 3 (Prolog) - Day 1
  </a></h1>
  <div class="faded" style="font-size:14px; margin-bottom:5px;">05 Feb 2012</div>
  <p>Although I am not yet halfway through the book, I am pretty sure that Prolog will win the &#8216;most foreign language&#8217; category with ease. Going in, I knew Prolog was fairly old (born in 1972) and that it was a logic-based language, but I could not have estimated how, for lack of a better word, <em>picky</em> it would be.</p>

<p>My troubles started at installation - Bruce Tate uses GNU Prolog in the book, and I spent far too long trying to get that working only to discover that some library functions essential to the exercises (<code>fd_domain</code>, <code>fd_all_different</code>) just caused GNU Prolog to crash on my machine. I will elaborate on this more in Day 2, but for anyone encountering this post who is in a similar situation, just go use SWI Prolog instead.</p>

<p>Prolog heavily relies on recursion but making a recursive rule is not the same as making a recursive function in functional languages. It is subtly different, and way easier to get wrong; you have to have an <strong>extremely</strong> clear mental model of how Prolog operates (which I still don&#8217;t). I will expand more on this in a future post.</p>

<p>Despite all this, during the course of Week 3 I have been convinced that logic programming can be extremely powerful. If you know how to define a problem in terms that Prolog understands, then you can write a program that solves a problem without having the slightest idea of how to actually solve it (a good example is Sudoku, which shows up in Day 3). Logic languages are the closest I have seen to the unattainable ideal of &#8216;writing a program that will look at the problem and write a program to solve it for you&#8217;.</p>
<div class='interjection'><p>
(This article is part of a series of posts I am doing about my journey through the exercises of the book <a href='http://pragprog.com/book/btlang/seven-languages-in-seven-weeks'>Seven Languages In Seven Weeks</a>. The article previous to this one is <a href='/blog/2012/01/16/seven-languages-week-2-day-3/'>Week 2 (Io) - Day 3</a>. For an overview see the <a href='/projects/seven-languages-in-seven-weeks/'>project page</a>.)
</p></div>
<h2 id='topics_covered'>Topics covered</h2>

<p>Day 1 covered the basic structural elements of Prolog. There are three kinds of statements in a Prolog program: <strong>facts</strong>, <strong>rules</strong>, and <strong>queries</strong>.</p>

<p>A fact is a simple statement that essentially adds a nugget of information to a database. Here are some facts:</p>
<div class='highlight'><pre><code class='prolog'>    <span class='s-Atom'>daytime</span><span class='p'>.</span>
    <span class='s-Atom'>clear_skies</span><span class='p'>.</span>

    <span class='nf'>round</span><span class='p'>(</span><span class='s-Atom'>earth</span><span class='p'>).</span>
    <span class='nf'>round</span><span class='p'>(</span><span class='s-Atom'>ball</span><span class='p'>).</span>

    <span class='nf'>small</span><span class='p'>(</span><span class='s-Atom'>mouse</span><span class='p'>).</span>
    <span class='nf'>small</span><span class='p'>(</span><span class='s-Atom'>ball</span><span class='p'>).</span>
</code></pre>
</div>
<p>A rule is a statement that relates facts and rules together. You can almost (but not quite) think of them as functions. Here are some rules:</p>
<div class='highlight'><pre><code class='prolog'>    <span class='nf'>time_to_play</span> <span class='o'>:-</span> <span class='s-Atom'>daytime</span><span class='p'>,</span> <span class='s-Atom'>clear_skies</span><span class='p'>.</span>

    <span class='nf'>suitable_for_playing_with</span><span class='p'>(</span><span class='nv'>X</span><span class='p'>)</span> <span class='p'>:-</span> <span class='nf'>round</span><span class='p'>(</span><span class='nv'>X</span><span class='p'>),</span> <span class='nf'>small</span><span class='p'>(</span><span class='nv'>X</span><span class='p'>).</span>

    <span class='nf'>does_nick_want_to_play_with</span><span class='p'>(</span><span class='nv'>X</span><span class='p'>)</span> <span class='p'>:-</span> <span class='s-Atom'>time_to_play</span><span class='p'>,</span> <span class='nf'>suitable_for_playing_with</span><span class='p'>(</span><span class='nv'>X</span><span class='p'>).</span>
</code></pre>
</div>
<p>If you collect all of the preceding statements and put them in a <code>hello.pl</code> file then you have a valid Prolog program. To actually get some useful output from it, we can load this program into the prolog interpreter, and query this database we&#8217;ve built up like so:</p>
<div class='highlight'><pre><code class='prolog'>    <span class='s-Atom'>?-</span> <span class='p'>[</span><span class='s-Atom'>&#39;hello.pl&#39;</span><span class='p'>].</span>
    <span class='c1'>% hello.pl compiled 0.00 sec, 3,352 bytes</span>
    <span class='s-Atom'>true</span><span class='p'>.</span>

    <span class='c1'>% Let&#39;s test out the facts:</span>

    <span class='s-Atom'>?-</span> <span class='s-Atom'>daytime</span><span class='p'>.</span>
    <span class='s-Atom'>true</span><span class='p'>.</span>

    <span class='s-Atom'>?-</span> <span class='nf'>round</span><span class='p'>(</span><span class='s-Atom'>earth</span><span class='p'>).</span>
    <span class='s-Atom'>true</span><span class='p'>.</span>

    <span class='s-Atom'>?-</span> <span class='nf'>round</span><span class='p'>(</span><span class='s-Atom'>cube</span><span class='p'>).</span>
    <span class='s-Atom'>false</span><span class='p'>.</span>

    <span class='s-Atom'>?-</span> <span class='nf'>round</span><span class='p'>(</span><span class='nv'>What</span><span class='p'>).</span> <span class='c1'>% Notice the capital letter here. Uppercase = variable, lowercase = atom.</span>
    <span class='nv'>What</span> <span class='o'>=</span> <span class='s-Atom'>earth</span> <span class='p'>;</span>
    <span class='nv'>What</span> <span class='o'>=</span> <span class='s-Atom'>ball</span> <span class='p'>;</span>

    <span class='c1'>% And now for the rules:</span>

     <span class='s-Atom'>?-</span> <span class='s-Atom'>time_to_play</span><span class='p'>.</span>
    <span class='s-Atom'>true</span><span class='p'>.</span>

    <span class='s-Atom'>?-</span> <span class='nf'>suitable_for_playing_with</span><span class='p'>(</span><span class='s-Atom'>earth</span><span class='p'>).</span>
    <span class='s-Atom'>false</span><span class='p'>.</span>

    <span class='s-Atom'>?-</span> <span class='nf'>suitable_for_playing_with</span><span class='p'>(</span><span class='s-Atom'>ball</span><span class='p'>).</span>
    <span class='s-Atom'>true</span><span class='p'>.</span>

    <span class='s-Atom'>?-</span> <span class='nf'>does_nick_want_to_play_with</span><span class='p'>(</span><span class='s-Atom'>earth</span><span class='p'>).</span>
    <span class='s-Atom'>false</span><span class='p'>.</span>

    <span class='s-Atom'>?-</span> <span class='nf'>does_nick_want_to_play_with</span><span class='p'>(</span><span class='s-Atom'>ball</span><span class='p'>).</span>
    <span class='s-Atom'>true</span><span class='p'>.</span>

    <span class='s-Atom'>?-</span> <span class='nf'>does_nick_want_to_play_with</span><span class='p'>(</span><span class='nv'>What</span><span class='p'>).</span>
    <span class='nv'>What</span> <span class='o'>=</span> <span class='s-Atom'>ball</span><span class='p'>.</span>
</code></pre>
</div>
<h2 id='highlights_from_exercises'>Highlights from exercises</h2>

<p>The exercises in Day 1 aren&#8217;t terribly interesting, so instead I&#8217;ll show you an example from an earlier part of the book that threw me into confusion for a while. The goal of the following snippet of Prolog is to assign map colours such that no state borders on another state with the same colour.</p>

<p>When I read this I flipped through the next few pages looking for the rest of the program. But there isn&#8217;t any more - this is it!</p>
<div class='highlight'><pre><code class='prolog'>    <span class='nf'>different</span><span class='p'>(</span><span class='s-Atom'>red</span><span class='p'>,</span> <span class='s-Atom'>green</span><span class='p'>).</span> <span class='nf'>different</span><span class='p'>(</span><span class='s-Atom'>red</span><span class='p'>,</span> <span class='s-Atom'>blue</span><span class='p'>).</span>
    <span class='nf'>different</span><span class='p'>(</span><span class='s-Atom'>green</span><span class='p'>,</span> <span class='s-Atom'>red</span><span class='p'>).</span> <span class='nf'>different</span><span class='p'>(</span><span class='s-Atom'>green</span><span class='p'>,</span> <span class='s-Atom'>blue</span><span class='p'>).</span>
    <span class='nf'>different</span><span class='p'>(</span><span class='s-Atom'>blue</span><span class='p'>,</span> <span class='s-Atom'>red</span><span class='p'>).</span> <span class='nf'>different</span><span class='p'>(</span><span class='s-Atom'>blue</span><span class='p'>,</span> <span class='s-Atom'>green</span><span class='p'>).</span>

    <span class='nf'>coloring</span><span class='p'>(</span><span class='nv'>Alabama</span><span class='p'>,</span> <span class='nv'>Mississippi</span><span class='p'>,</span> <span class='nv'>Georgia</span><span class='p'>,</span> <span class='nv'>Tennessee</span><span class='p'>,</span> <span class='nv'>Florida</span><span class='p'>)</span> <span class='p'>:-</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>Mississippi</span><span class='p'>,</span> <span class='nv'>Tennessee</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>Mississippi</span><span class='p'>,</span> <span class='nv'>Alabama</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>Alabama</span><span class='p'>,</span> <span class='nv'>Tennessee</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>Alabama</span><span class='p'>,</span> <span class='nv'>Mississippi</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>Alabama</span><span class='p'>,</span> <span class='nv'>Georgia</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>Alabama</span><span class='p'>,</span> <span class='nv'>Florida</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>Georgia</span><span class='p'>,</span> <span class='nv'>Florida</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>Georgia</span><span class='p'>,</span> <span class='nv'>Tennessee</span><span class='p'>).</span>
</code></pre>
</div>
<p>This program aims to colour these <strong>five</strong> states with <strong>three</strong> colours (such that no states of the same colour share borders). When we query this we get:</p>
<div class='highlight'><pre><code class='prolog'>    <span class='s-Atom'>?-</span> <span class='nf'>coloring</span><span class='p'>(</span><span class='nv'>Alabama</span><span class='p'>,</span> <span class='nv'>Mississippi</span><span class='p'>,</span> <span class='nv'>Georgia</span><span class='p'>,</span> <span class='nv'>Tennessee</span><span class='p'>,</span> <span class='nv'>Florida</span><span class='p'>).</span>
    <span class='nv'>Alabama</span> <span class='o'>=</span> <span class='s-Atom'>blue</span><span class='p'>,</span>
    <span class='nv'>Mississippi</span> <span class='o'>=</span> <span class='nv'>Georgia</span><span class='p'>,</span> <span class='nv'>Georgia</span> <span class='o'>=</span> <span class='s-Atom'>red</span><span class='p'>,</span>
    <span class='nv'>Tennessee</span> <span class='o'>=</span> <span class='nv'>Florida</span><span class='p'>,</span> <span class='nv'>Florida</span> <span class='o'>=</span> <span class='s-Atom'>green</span> <span class='p'>.</span>
</code></pre>
</div>
<p><img src='/img/projects/seven-languages/state-colouring.png' alt='Coloured map of states showing Mississippi and Georgia = red, Tennessee and Florida = green, and Alabama = blue.' /></p>

<p>The program appears to be just the problem definition restated, and yet somehow Prolog can produce a correct answer!</p>

<p><strong>DISCLAIMER:</strong> I am not a Prolog expert and as such the following explanation will be a bit hand wavy. Please let me know if you spot any glaring inaccuracies.</p>

<p>Prolog is trying to unify both sides of our rule and answer the question &#8220;What values can I set these five variables to in order to make all of the following series of statements true&#8221;. It knows there are six facts about &#8220;different-ness&#8221; and keeps on trying different combinations of these facts.</p>

<p>Take as an example the first statement of the <strong>rule</strong> <code>different(Mississippi,
Tennessee)</code>. It might first try the <strong>fact</strong> <code>different(red, green)</code>, then continue on with the assumption that now <code>Mississippi = red</code> and <code>Tennessee =
green</code>, and see if it can still make the other statements true.</p>

<p>Hopefully that more or less makes sense. But in case it doesn&#8217;t, <strong>let&#8217;s take a different tack now</strong>. Pretend our rule is a mathematical equation: Prolog is trying to solve for five variables, given only a little bit of knowledge about numbers. As far as it is concerned, you may as well have given it this:</p>
<div class='highlight'><pre><code class='prolog'>    <span class='nf'>different</span><span class='p'>(</span><span class='m'>1</span><span class='p'>,</span> <span class='m'>2</span><span class='p'>).</span> <span class='nf'>different</span><span class='p'>(</span><span class='m'>1</span><span class='p'>,</span> <span class='m'>3</span><span class='p'>).</span>
    <span class='nf'>different</span><span class='p'>(</span><span class='m'>2</span><span class='p'>,</span> <span class='m'>1</span><span class='p'>).</span> <span class='nf'>different</span><span class='p'>(</span><span class='m'>2</span><span class='p'>,</span> <span class='m'>3</span><span class='p'>).</span>
    <span class='nf'>different</span><span class='p'>(</span><span class='m'>3</span><span class='p'>,</span> <span class='m'>1</span><span class='p'>).</span> <span class='nf'>different</span><span class='p'>(</span><span class='m'>3</span><span class='p'>,</span> <span class='m'>2</span><span class='p'>).</span>

    <span class='nf'>solve_for</span><span class='p'>(</span><span class='nv'>A</span><span class='p'>,</span> <span class='nv'>B</span><span class='p'>,</span> <span class='nv'>C</span><span class='p'>,</span> <span class='nv'>D</span><span class='p'>,</span> <span class='nv'>E</span><span class='p'>)</span> <span class='p'>:-</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>B</span><span class='p'>,</span> <span class='nv'>D</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>B</span><span class='p'>,</span> <span class='nv'>A</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>A</span><span class='p'>,</span> <span class='nv'>D</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>A</span><span class='p'>,</span> <span class='nv'>B</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>A</span><span class='p'>,</span> <span class='nv'>C</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>A</span><span class='p'>,</span> <span class='nv'>E</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>C</span><span class='p'>,</span> <span class='nv'>E</span><span class='p'>),</span>
        <span class='nf'>different</span><span class='p'>(</span><span class='nv'>C</span><span class='p'>,</span> <span class='nv'>D</span><span class='p'>).</span>
</code></pre>
</div>
<p>In which case you would receive an answer like:</p>
<div class='highlight'><pre><code class='prolog'>    <span class='s-Atom'>?-</span> <span class='nf'>solve_for</span><span class='p'>(</span><span class='nv'>A</span><span class='p'>,</span> <span class='nv'>B</span><span class='p'>,</span> <span class='nv'>C</span><span class='p'>,</span> <span class='nv'>D</span><span class='p'>,</span> <span class='nv'>E</span><span class='p'>).</span>
    <span class='nv'>A</span> <span class='o'>=</span> <span class='m'>3</span><span class='p'>,</span>
    <span class='nv'>B</span> <span class='o'>=</span> <span class='nv'>C</span><span class='p'>,</span> <span class='nv'>C</span> <span class='o'>=</span> <span class='m'>1</span><span class='p'>,</span>
    <span class='nv'>D</span> <span class='o'>=</span> <span class='nv'>E</span><span class='p'>,</span> <span class='nv'>E</span> <span class='o'>=</span> <span class='m'>2</span> <span class='p'>.</span>
</code></pre>
</div>
<p>Easy peasy, right?</p>

<h2 id='full_solutions'>Full solutions</h2>

<p>Here is a nicely formatted version of my solutions to the exercises from Day 1 of Prolog. The home of the following code is <a href='https://github.com/nickknw/seven-languages-in-seven-weeks/blob/master/week-3-prolog/day1.pl'>on github</a> with the other exercises.</p>
<h3>Find:</h3><h4>1. Some free Prolog tutorials</h4>
<ul>
<li><a href='http://www.lix.polytechnique.fr/~liberti/public/computing/prog/prolog/prolog-tutorial.html'>http://www.lix.polytechnique.fr/~liberti/public/computing/prog/prolog/prolog-tutorial.html</a></li>

<li><a href='http://www.csupomona.edu/~jrfisher/www/prolog_tutorial/contents.html'>http://www.csupomona.edu/~jrfisher/www/prolog_tutorial/contents.html</a></li>
</ul>
<h4>2. A support forum (there are several)</h4>
<ul>
<li><a href='http://old.nabble.com/SWI-Prolog-f448.html'>http://old.nabble.com/SWI-Prolog-f448.html</a></li>

<li><a href='http://mail.gnu.org/pipermail/users-prolog/'>http://mail.gnu.org/pipermail/users-prolog/</a></li>

<li><a href='http://www.reddit.com/r/prolog'>http://www.reddit.com/r/prolog</a></li>
</ul>
<h4>3. One online reference for the Prolog version you're using</h4>
<ul>
<li><a href='http://www.swi-prolog.org/pldoc/index.html'>http://www.swi-prolog.org/pldoc/index.html</a></li>
</ul>
<h3>Do:</h3><h4>1. Make a simple knowledge base. Represent some of your favorite books and authors.</h4><div class='highlight'><pre><code class='prolog'>    <span class='nf'>book</span><span class='p'>(</span><span class='s-Atom'>&#39;The Name Of The Wind&#39;</span><span class='p'>,</span> <span class='s-Atom'>&#39;Patrick Rothfuss&#39;</span><span class='p'>).</span>
    <span class='nf'>book</span><span class='p'>(</span><span class='s-Atom'>&#39;Anathem&#39;</span><span class='p'>,</span> <span class='s-Atom'>&#39;Neal Stephenson&#39;</span><span class='p'>).</span>
    <span class='nf'>book</span><span class='p'>(</span><span class='s-Atom'>&#39;The Skystone&#39;</span><span class='p'>,</span> <span class='s-Atom'>&#39;Jack Whyte&#39;</span><span class='p'>).</span>
    <span class='nf'>book</span><span class='p'>(</span><span class='s-Atom'>&#39;The Singing Sword&#39;</span><span class='p'>,</span> <span class='s-Atom'>&#39;Jack Whyte&#39;</span><span class='p'>).</span>
    <span class='nf'>book</span><span class='p'>(</span><span class='s-Atom'>&#39;Rapid Development&#39;</span><span class='p'>,</span> <span class='s-Atom'>&#39;Steve McConnell&#39;</span><span class='p'>).</span>
    <span class='nf'>book</span><span class='p'>(</span><span class='s-Atom'>&#39;The Pragmatic Programmer&#39;</span><span class='p'>,</span> <span class='s-Atom'>&#39;Andy Hunt &amp; Dave Thomas&#39;</span><span class='p'>).</span>
    <span class='nf'>book</span><span class='p'>(</span><span class='s-Atom'>&#39;Seven Languages In Seven Weeks&#39;</span><span class='p'>,</span> <span class='s-Atom'>&#39;Bruce Tate&#39;</span><span class='p'>).</span>
</code></pre>
</div><h4>2. Find all books in your knowledge base written by one author.</h4><div class='highlight'><pre><code class='prolog'>    <span class='s-Atom'>?-</span> <span class='nf'>book</span><span class='p'>(</span><span class='nv'>What</span><span class='p'>,</span> <span class='s-Atom'>&#39;Neal Stephenson&#39;</span><span class='p'>).</span>

    <span class='nv'>What</span> <span class='o'>=</span> <span class='s-Atom'>&#39;Anathem&#39;</span> <span class='s-Atom'>?</span> <span class='p'>;</span>

    <span class='s-Atom'>?-</span> <span class='nf'>book</span><span class='p'>(</span><span class='nv'>What</span><span class='p'>,</span> <span class='s-Atom'>&#39;Jack White&#39;</span><span class='p'>).</span>

    <span class='nv'>What</span> <span class='o'>=</span> <span class='s-Atom'>&#39;The Skystone&#39;</span> <span class='s-Atom'>?</span> <span class='p'>;</span>

    <span class='nv'>What</span> <span class='o'>=</span> <span class='s-Atom'>&#39;The Singing Sword&#39;</span> <span class='s-Atom'>?</span> <span class='p'>;</span>
</code></pre>
</div><h4>3. Make a knowledge base representing musicians and instruments. Also represent musicians and their genre of music.</h4><div class='highlight'><pre><code class='prolog'>    <span class='nf'>musician_instrument</span><span class='p'>(</span><span class='s-Atom'>&#39;Hansi Kursch&#39;</span><span class='p'>,</span> <span class='s-Atom'>vocals</span><span class='p'>).</span>
    <span class='nf'>musician_instrument</span><span class='p'>(</span><span class='s-Atom'>&#39;Hansi Kursch&#39;</span><span class='p'>,</span> <span class='s-Atom'>bass</span><span class='p'>).</span>
    <span class='nf'>musician_instrument</span><span class='p'>(</span><span class='s-Atom'>&#39;Andre Olbrich&#39;</span><span class='p'>,</span> <span class='s-Atom'>guitar</span><span class='p'>).</span>
    <span class='nf'>musician_instrument</span><span class='p'>(</span><span class='s-Atom'>&#39;Duke Ellington&#39;</span><span class='p'>,</span> <span class='s-Atom'>piano</span><span class='p'>).</span>
    <span class='nf'>musician_instrument</span><span class='p'>(</span><span class='s-Atom'>&#39;Jimi Hendrix&#39;</span><span class='p'>,</span> <span class='s-Atom'>guitar</span><span class='p'>).</span>

    <span class='nf'>musician_genre</span><span class='p'>(</span><span class='s-Atom'>&#39;Hansi Kurch&#39;</span><span class='p'>,</span> <span class='s-Atom'>metal</span><span class='p'>).</span>
    <span class='nf'>musician_genre</span><span class='p'>(</span><span class='s-Atom'>&#39;Andre Olbrich&#39;</span><span class='p'>,</span> <span class='s-Atom'>metal</span><span class='p'>).</span>
    <span class='nf'>musician_genre</span><span class='p'>(</span><span class='s-Atom'>&#39;Duke Ellington&#39;</span><span class='p'>,</span> <span class='s-Atom'>jazz</span><span class='p'>).</span>
    <span class='nf'>musician_genre</span><span class='p'>(</span><span class='s-Atom'>&#39;Jimi Hendrix&#39;</span><span class='p'>,</span> <span class='s-Atom'>rock</span><span class='p'>).</span>
</code></pre>
</div><h4>4. Find all musicians who play the guitar.</h4><div class='highlight'><pre><code class='prolog'>    <span class='s-Atom'>?-</span> <span class='nf'>musician_instrument</span><span class='p'>(</span><span class='nv'>What</span><span class='p'>,</span> <span class='s-Atom'>guitar</span><span class='p'>)</span>
    
    <span class='nv'>What</span> <span class='o'>=</span> <span class='s-Atom'>&#39;Andre Olbrich&#39;</span> <span class='s-Atom'>?</span> <span class='p'>;</span>
    
    <span class='nv'>What</span> <span class='o'>=</span> <span class='s-Atom'>&#39;Jimi Hendrix&#39;</span>
</code></pre>
</div>
<p>Next in this series: Day 2 of Prolog (coming soon)</p>
  </div>

  <div style="margin-top:20px; font-size:14px;">
    <a href="/blog/2012/02/05/seven-languages-week-3-day-1/#disqus_thread" data-disqus-identifier="/blog/2012/02/05/seven-languages-week-3-day-1">Comments</a>
  </div>

    <hr class="fancyrule" />

  <div>
  <h1 style="margin:0px"><a href="/blog/2012/01/16/seven-languages-week-2-day-3/">
  Seven Languages: Week 2 (Io) - Day 3
  </a></h1>
  <div class="faded" style="font-size:14px; margin-bottom:5px;">16 Jan 2012</div>
  <p>Since this is the last day of Io, I am going to reflect a bit on what I liked about it.</p>

<p>I learned that a small prototype-based language like Io can still be expressive and powerful. There are no classes or modules, but you don&#8217;t need them to put things together in a way that mimics classes or modules. It was very refreshing.</p>

<p>It also turned out that I got a practical result directly relevant to my current work from learning Io: it strengthened my understanding of javascript. The underlying way javascript works makes sense to me on a deeper level now. I am actually in the middle of reading <a href='http://shop.oreilly.com/product/9780596517748.do'>Javascript: The Good Parts</a>, and I can glance at the parts to do with explaining prototypes and think &#8220;Aha! This is obvious and makes total sense to me!&#8221; I am positive I would not have thought the same before this experience.</p>

<p>Io&#8217;s minimalism also whetted my appetite for learning a lisp. Clojure is coming up in a few chapters, and I am looking forward to it. Scheme is also on my horizon (if a bit farther out), but that&#8217;s a subject for another post.</p>
<div class='interjection'><p>
(This article is part of a series of posts I am doing about my journey through the exercises of the book <a href='http://pragprog.com/book/btlang/seven-languages-in-seven-weeks'>Seven Languages In Seven Weeks</a>. The article previous to this one is <a href='/blog/2012/01/11/seven-languages-week-2-day-2/'>Week 2 (Io) - Day 2</a>. For an overview see the <a href='/projects/seven-languages-in-seven-weeks/'>project page</a>.)
</p></div>
<h2 id='topics_covered'>Topics covered</h2>

<p>The last day of Io covered some more advanced language features, mostly focused on metaprogramming.</p>

<p><strong>Metaprogramming and internal DSLs</strong> were the main focus of the text, the examples, and the exercises. But for good reason! Again Io&#8217;s firm commitment to letting you do whatever you want to (even up to the point of allowing you to cripple core language features!) shows the power it can give.</p>

<p>You can create custom behavior for curly brackets just by sticking a method into the <code>curlyBrackets</code> slot. You can redefine the colon operator by calling <code>addAssignOperator</code> with <code>:</code> and the name of the method you want to use. Io also has an equivalent to Ruby&#8217;s <code>method_missing</code>, except in Io it is called <code>forward</code> and it is a crucial part of prototypal inheritance.</p>

<p><strong>Example time!</strong> Say you send a message called <code>fly</code> to an object we&#8217;ll call <code>Mallard</code>. In this example, <code>Mallard</code> is a clone of the <code>Duck</code> prototype, and has some additional slots we don&#8217;t care about right now. The important thing is that <code>Mallard</code> <em>doesn&#8217;t</em> have a <code>fly</code> slot (it is probably defined in <code>Duck</code> or somewhere else further up the chain), so when we send the <code>fly</code> message to <code>Mallard</code> it will say &#8220;Huh, can&#8217;t do anything with this&#8221; and <em>forward</em> that message to its prototype to deal with.</p>

<p>Putting a method in the <code>forward</code> slot of an object lets us customize what happens when an object receives a message it doesn&#8217;t know what to do with. Instead of forwarding the message on to its prototype (as in the example above), we can start to do some pretty interesting things, which you will see in my highlights from the exercises.</p>

<p><strong>Concurrency</strong> was also talked about, and Bruce showed how Io can handle that with <strong>coroutines, actors, and futures</strong>. Futures and coroutines I am already familiar with, and it was nice to see how seamless they were to use in Io. I am pretty sure I didn&#8217;t really grok the section on actors.</p>

<p>In Io you can make an object into an actor just by sending an asynchronous message to it (which you do with <code>@@</code>). This may be cool but I&#8217;m not sure, because I don&#8217;t understand the implications of actors yet. Once I get to the Erlang section is likely when I&#8217;ll start learning more about them and this will start to be impressive in retrospect.</p>

<h2 id='highlights_from_exercises'>Highlights from exercises</h2>

<p>These exercises focused on expanding on the XML DSL example that was used to demonstrate <code>forward</code> during this chapter.</p>

<p>I was not really satisfied with my solution - I couldn&#8217;t manage to make it feel as elegant as my previous ones. It might be because this problem is inherently a little bit messy, or more likely, there are still some bumps in my implementation that could be smoothed out.</p>

<p>Io&#8217;s <code>forward</code> method, reflection abilities, and ability to redefine operators all played key roles in making a problem like this possible to solve with an internal (as opposed to <a href=''>external</a>) DSL. This saved a ton of time and effort on my part.</p>
<h3>Forward</h3>
<p>This is a simple stripped down chunk from the XML DSL example from the book. It lets you make a rudimentary XML DSL. The following section of code will turn <code>Builder div</code> into <code>&lt;div&gt;&lt;/div&gt;</code>. The downside is, it will also turn <code>Builder
span</code> into <code>&lt;div&gt;&lt;/div&gt;</code>!</p>
<div class='highlight'><pre><code class='io'>    <span class='n'>Builder</span> <span class='o'>:=</span> <span class='n'>Object</span> <span class='k'>clone</span>

    <span class='n'>Builder</span> <span class='n'>forward</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
        <span class='n'>write</span><span class='o'>(</span><span class='s'>&quot;&lt;div&gt;&quot;</span><span class='o'>)</span>
        <span class='n'>write</span><span class='o'>(</span><span class='s'>&quot;&lt;/div&gt;&quot;</span><span class='o'>)</span>
    <span class='o'>)</span>
</code></pre>
</div><h3>Reflection</h3>
<p>Reflection in Io was covered in Day 2 of the book, but it is an important part of this example. It provides the ability to access the <em>name of the message</em> that was sent with <code>call message name</code>. It also lets us start nesting calls by passing another function call as an argument. This example is complete enough that we can do <code>Builder ul(li(&quot;One&quot;), li(&quot;Two&quot;), li(&quot;Three&quot;))</code> and it will correctly print out <code>&lt;ul&gt;&lt;li&gt;One&lt;/li&gt;&lt;li&gt;Two&lt;/li&gt;&lt;li&gt;Three&lt;/li&gt;&lt;/ul&gt;</code>.</p>
<div class='highlight'><pre><code class='io'>    <span class='n'>Builder</span> <span class='o'>:=</span> <span class='n'>Object</span> <span class='k'>clone</span>

    <span class='n'>Builder</span> <span class='n'>forward</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
        <span class='n'>write</span><span class='o'>(</span><span class='s'>&quot;&lt;&quot;</span><span class='o'>,</span> <span class='n'>call</span> <span class='n'>message</span> <span class='n'>name</span><span class='o'>,</span> <span class='s'>&quot;&gt;&quot;</span><span class='o'>)</span>
        <span class='n'>call</span> <span class='n'>message</span> <span class='n'>arguments</span> <span class='n'>foreach</span><span class='o'>(</span>
            <span class='n'>arg</span><span class='o'>,</span>
            <span class='n'>content</span> <span class='o'>:=</span> <span class='n'>self</span> <span class='n'>doMessage</span><span class='o'>(</span><span class='n'>arg</span><span class='o'>);</span>
            <span class='k'>if</span><span class='o'>(</span><span class='n'>content</span> <span class='n'>type</span> <span class='o'>==</span> <span class='s'>&quot;Sequence&quot;</span><span class='o'>,</span> <span class='n'>write</span><span class='o'>(</span><span class='n'>content</span><span class='o'>)))</span>
        <span class='n'>write</span><span class='o'>(</span><span class='s'>&quot;&lt;/&quot;</span><span class='o'>,</span> <span class='n'>call</span> <span class='n'>message</span> <span class='n'>name</span><span class='o'>,</span> <span class='s'>&quot;&gt;&quot;</span><span class='o'>))</span>
</code></pre>
</div>
<p>Let&#8217;s go over that middle chunk that begins with <code>call message arguments</code>. Just as <code>call message name</code> will return the name, <code>call message arguments</code> returns a list of the arguments. We iterate over that list with <code>foreach</code>, and for each <code>arg</code> we do two things:</p>

<ol>
<li>Execute it with <code>self doMessage</code>. If the argument is another method call like <code>li(&quot;One&quot;)</code> then <code>Builder li</code> gets executed, <code>Builder</code> can&#8217;t find a slot with that name, and <code>forward</code> gets called again. We are recursing now, and this will continue until we hit an argument that is a simple string, like <code>&quot;One&quot;</code>. When we do, <code>doMessage</code> will just turn that argument into a string. This leads to the second step:</li>

<li>If the executing argument is a simple string (<code>if(content type == &quot;Sequence&quot;,</code>) then print it out!</li>
</ol>

<p>That&#8217;s enough for a simple XML DSL in Io. The exercises are about taking this base and expanding it to handle attributes and generate xml with correct indentation. If you&#8217;re interested in seeing that, just scroll down to my full code listing!</p>
<h3>Operator Redefinition</h3>
<p>Now that you&#8217;ve made it through that, let&#8217;s close with something easy. Exercise #2 was simple and served as a hint for the next one. In Io you can override what <code>{1, 2, 3}</code> means by putting a method into <code>curlyBrackets</code>. The contents <code>1</code>, <code>2</code>, and <code>3</code> will be available as the arguments of the message. If you were paying attention before, you&#8217;ll realize that we already know how to turn the message arguments into a list:</p>
<div class='highlight'><pre><code class='io'>    <span class='c1'># 2. Create a list syntax that uses brackets</span>
    <span class='n'>curlyBrackets</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
        <span class='n'>call</span> <span class='n'>message</span> <span class='n'>arguments</span>
    <span class='o'>)</span>
</code></pre>
</div>
<p>So that&#8217;s all that is required to solve that! But that isn&#8217;t the typical way to redefine operators in Io. I&#8217;ll leave you with a final example that shows you how to tell Io &#8220;when I use the <code>:</code> operator, I really want you to call the <code>atPutNumber</code> method instead&#8221;.</p>
<div class='highlight'><pre><code class='io'>    <span class='n'>OperatorTable</span> <span class='n'>addAssignOperator</span><span class='o'>(</span><span class='s'>&quot;:&quot;</span><span class='o'>,</span> <span class='s'>&quot;atPutNumber&quot;</span><span class='o'>)</span>

    <span class='n'>Map</span> <span class='n'>atPutNumber</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
        <span class='c1'># your code goes here</span>
    <span class='o'>)</span>
</code></pre>
</div>
<h2 id='full_code_listing'>Full Code Listing</h2>

<p>Here is my full code listing for the exercises from Day 3 of Io. The home of this piece of code is with the other exercises <a href='https://github.com/nickknw/seven-languages-in-seven-weeks/blob/master/week-2-io/day3.io'>on github</a>.</p>
<div class='highlight'><pre><code class='io'><span class='n'>Builder</span> <span class='o'>:=</span> <span class='n'>Object</span> <span class='k'>clone</span>

<span class='n'>Builder</span> <span class='n'>forward</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
    <span class='n'>writeln</span><span class='o'>(</span><span class='s'>&quot;&lt;&quot;</span><span class='o'>,</span> <span class='n'>call</span> <span class='n'>message</span> <span class='n'>name</span><span class='o'>,</span> <span class='s'>&quot;&gt;&quot;</span><span class='o'>)</span>
    <span class='n'>call</span> <span class='n'>message</span> <span class='n'>arguments</span> <span class='n'>foreach</span><span class='o'>(</span>
        <span class='n'>arg</span><span class='o'>,</span>
        <span class='n'>content</span> <span class='o'>:=</span> <span class='n'>self</span> <span class='n'>doMessage</span><span class='o'>(</span><span class='n'>arg</span><span class='o'>);</span>
        <span class='k'>if</span><span class='o'>(</span><span class='n'>content</span> <span class='n'>type</span> <span class='o'>==</span> <span class='s'>&quot;Sequence&quot;</span><span class='o'>,</span> <span class='n'>writeln</span><span class='o'>(</span><span class='n'>content</span><span class='o'>)))</span>
    <span class='n'>writeln</span><span class='o'>(</span><span class='s'>&quot;&lt;/&quot;</span><span class='o'>,</span> <span class='n'>call</span> <span class='n'>message</span> <span class='n'>name</span><span class='o'>,</span> <span class='s'>&quot;&gt;&quot;</span><span class='o'>)</span>
<span class='o'>)</span>

<span class='c1'># Do: </span>
<span class='c1'>#</span>
<span class='c1'># 1. Enhance the XML program to add spaces to show the indentation structure</span>

<span class='n'>Builder</span> <span class='n'>indentLevel</span> <span class='o'>:=</span> <span class='mf'>0</span>

<span class='n'>Builder</span> <span class='n'>forward</span> <span class='o'>=</span> <span class='k'>method</span><span class='o'>(</span>
    <span class='n'>writeln</span><span class='o'>(</span><span class='n'>makeIndent</span><span class='o'>()</span> <span class='o'>..</span> <span class='s'>&quot;&lt;&quot;</span><span class='o'>,</span> <span class='n'>call</span> <span class='n'>message</span> <span class='n'>name</span><span class='o'>,</span> <span class='s'>&quot;&gt;&quot;</span><span class='o'>)</span>
    <span class='n'>indentLevel</span> <span class='o'>=</span> <span class='n'>indentLevel</span> <span class='o'>+</span> <span class='mf'>1</span>
    <span class='n'>call</span> <span class='n'>message</span> <span class='n'>arguments</span> <span class='n'>foreach</span><span class='o'>(</span>
        <span class='n'>arg</span><span class='o'>,</span>
        <span class='n'>content</span> <span class='o'>:=</span> <span class='n'>self</span> <span class='n'>doMessage</span><span class='o'>(</span><span class='n'>arg</span><span class='o'>);</span>
        <span class='k'>if</span><span class='o'>(</span><span class='n'>content</span> <span class='n'>type</span> <span class='o'>==</span> <span class='s'>&quot;Sequence&quot;</span><span class='o'>,</span> <span class='n'>writeln</span><span class='o'>(</span><span class='n'>makeIndent</span><span class='o'>()</span> <span class='o'>..</span> <span class='n'>content</span><span class='o'>))</span>
    <span class='o'>)</span>
    <span class='n'>indentLevel</span> <span class='o'>=</span> <span class='n'>indentLevel</span> <span class='o'>-</span> <span class='mf'>1</span>
    <span class='n'>writeln</span><span class='o'>(</span><span class='n'>makeIndent</span><span class='o'>()</span> <span class='o'>..</span> <span class='s'>&quot;&lt;/&quot;</span><span class='o'>,</span> <span class='n'>call</span> <span class='n'>message</span> <span class='n'>name</span><span class='o'>,</span> <span class='s'>&quot;&gt;&quot;</span><span class='o'>)</span>
<span class='o'>)</span>

<span class='n'>Builder</span> <span class='n'>makeIndent</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
    <span class='n'>spaces</span> <span class='o'>:=</span> <span class='s'>&quot;&quot;</span>
    <span class='n'>indentLevel</span> <span class='n'>repeat</span><span class='o'>(</span><span class='n'>spaces</span> <span class='o'>=</span> <span class='n'>spaces</span> <span class='o'>..</span> <span class='s'>&quot;  &quot;</span><span class='o'>)</span>
    <span class='n'>return</span> <span class='n'>spaces</span>
<span class='o'>)</span>

<span class='s'>&quot;\nIndented builder syntax:&quot;</span> <span class='n'>println</span>
<span class='n'>Builder</span> <span class='n'>ul</span><span class='o'>(</span>
            <span class='n'>li</span><span class='o'>(</span><span class='s'>&quot;Io&quot;</span><span class='o'>),</span>
            <span class='n'>li</span><span class='o'>(</span><span class='s'>&quot;Lua&quot;</span><span class='o'>),</span>
            <span class='n'>li</span><span class='o'>(</span><span class='s'>&quot;JavaScript&quot;</span><span class='o'>)</span>
        <span class='o'>)</span>

<span class='c1'># 2. Create a list syntax that uses brackets</span>

<span class='n'>curlyBrackets</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
    <span class='n'>call</span> <span class='n'>message</span> <span class='n'>arguments</span>
<span class='o'>)</span>

<span class='s'>&quot;\nBracket list syntax:&quot;</span> <span class='n'>println</span>
<span class='s'>&quot;{1,2,3,4,5} println&quot;</span> <span class='n'>println</span>
<span class='o'>{</span><span class='mf'>1</span><span class='o'>,</span><span class='mf'>2</span><span class='o'>,</span><span class='mf'>3</span><span class='o'>,</span><span class='mf'>4</span><span class='o'>,</span><span class='mf'>5</span><span class='o'>}</span> <span class='n'>println</span>
<span class='s'>&quot;{\&quot;a\&quot;, \&quot;b\&quot;, \&quot;c\&quot;, \&quot;d\&quot;, \&quot;e\&quot;} println&quot;</span> <span class='n'>println</span>
<span class='o'>{</span><span class='s'>&quot;a&quot;</span><span class='o'>,</span> <span class='s'>&quot;b&quot;</span><span class='o'>,</span> <span class='s'>&quot;c&quot;</span><span class='o'>,</span> <span class='s'>&quot;d&quot;</span><span class='o'>,</span> <span class='s'>&quot;e&quot;</span><span class='o'>}</span> <span class='n'>println</span>

<span class='c1'># that was unexpectedly easy and elegant. I almost feel like I&#39;ve missed something</span>


<span class='c1'># 3. Enhance the XML program to handle attributes: if the first argument is a</span>
<span class='c1'># map (use the curly brackets syntax), add attributes to the XML program. For</span>
<span class='c1'># example: book({&quot;author&quot;: &quot;Tate&quot;}...) would print &lt;book author=&quot;Tate&quot;&gt;</span>

<span class='n'>OperatorTable</span> <span class='n'>addAssignOperator</span><span class='o'>(</span><span class='s'>&quot;:&quot;</span><span class='o'>,</span> <span class='s'>&quot;atPutNumber&quot;</span><span class='o'>)</span>

<span class='n'>Map</span> <span class='n'>atPutNumber</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
    <span class='n'>self</span> <span class='n'>atPut</span><span class='o'>(</span>
        <span class='n'>call</span> <span class='n'>evalArgAt</span><span class='o'>(</span><span class='mf'>0</span><span class='o'>)</span> <span class='n'>asMutable</span> <span class='n'>removePrefix</span><span class='o'>(</span><span class='s'>&quot;\&quot;&quot;</span><span class='o'>)</span> <span class='n'>removeSuffix</span><span class='o'>(</span><span class='s'>&quot;\&quot;&quot;</span><span class='o'>),</span>
        <span class='n'>call</span> <span class='n'>evalArgAt</span><span class='o'>(</span><span class='mf'>1</span><span class='o'>)</span>
    <span class='o'>)</span>
<span class='o'>)</span>
        
<span class='n'>curlyBrackets</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
    <span class='n'>r</span> <span class='o'>:=</span> <span class='n'>Map</span> <span class='k'>clone</span>
    <span class='n'>call</span> <span class='n'>message</span> <span class='n'>arguments</span> <span class='n'>foreach</span><span class='o'>(</span><span class='n'>arg</span><span class='o'>,</span>
        <span class='n'>r</span> <span class='n'>doMessage</span><span class='o'>(</span><span class='n'>arg</span><span class='o'>)</span>
    <span class='o'>)</span>
    <span class='n'>r</span>
<span class='o'>)</span>

<span class='n'>Map</span> <span class='n'>printAsAttributes</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
    <span class='n'>self</span> <span class='n'>foreach</span><span class='o'>(</span><span class='n'>k</span><span class='o'>,</span> <span class='n'>v</span><span class='o'>,</span>
        <span class='n'>write</span><span class='o'>(</span><span class='s'>&quot; &quot;</span> <span class='o'>..</span> <span class='n'>k</span> <span class='o'>..</span> <span class='s'>&quot;=\&quot;&quot;</span> <span class='o'>..</span> <span class='n'>v</span> <span class='o'>..</span> <span class='s'>&quot;\&quot;&quot;</span><span class='o'>)</span>
    <span class='o'>)</span>
<span class='o'>)</span>

<span class='n'>Builder</span> <span class='n'>forward</span> <span class='o'>=</span> <span class='k'>method</span><span class='o'>(</span>
    <span class='n'>write</span><span class='o'>(</span><span class='n'>makeIndent</span><span class='o'>()</span> <span class='o'>..</span> <span class='s'>&quot;&lt;&quot;</span><span class='o'>,</span> <span class='n'>call</span> <span class='n'>message</span> <span class='n'>name</span><span class='o'>)</span>
    <span class='n'>indentLevel</span> <span class='o'>=</span> <span class='n'>indentLevel</span> <span class='o'>+</span> <span class='mf'>1</span>
    <span class='n'>isFirst</span> <span class='o'>:=</span> <span class='no'>true</span>
    <span class='n'>call</span> <span class='n'>message</span> <span class='n'>arguments</span> <span class='n'>foreach</span><span class='o'>(</span>
        <span class='n'>arg</span><span class='o'>,</span>
        <span class='k'>if</span><span class='o'>(</span><span class='n'>isFirst</span><span class='o'>,</span>
            <span class='k'>if</span><span class='o'>(</span><span class='n'>arg</span> <span class='n'>name</span> <span class='o'>==</span> <span class='s'>&quot;curlyBrackets&quot;</span><span class='o'>,</span> 
                <span class='o'>(</span><span class='n'>self</span> <span class='n'>doMessage</span><span class='o'>(</span><span class='n'>arg</span><span class='o'>))</span> <span class='n'>printAsAttributes</span>
            <span class='o'>)</span>

            <span class='n'>write</span><span class='o'>(</span><span class='s'>&quot;&gt;\n&quot;</span><span class='o'>)</span>
            <span class='n'>isFirst</span> <span class='o'>=</span> <span class='no'>false</span>
        <span class='o'>)</span>

        <span class='n'>content</span> <span class='o'>:=</span> <span class='n'>self</span> <span class='n'>doMessage</span><span class='o'>(</span><span class='n'>arg</span><span class='o'>)</span>
        <span class='k'>if</span><span class='o'>(</span><span class='n'>content</span> <span class='n'>type</span> <span class='o'>==</span> <span class='s'>&quot;Sequence&quot;</span><span class='o'>,</span> <span class='n'>writeln</span><span class='o'>(</span><span class='n'>makeIndent</span><span class='o'>()</span> <span class='o'>..</span> <span class='n'>content</span><span class='o'>))</span>
    <span class='o'>)</span>
    <span class='n'>indentLevel</span> <span class='o'>=</span> <span class='n'>indentLevel</span> <span class='o'>-</span> <span class='mf'>1</span>
    <span class='n'>writeln</span><span class='o'>(</span><span class='n'>makeIndent</span><span class='o'>()</span> <span class='o'>..</span> <span class='s'>&quot;&lt;/&quot;</span><span class='o'>,</span> <span class='n'>call</span> <span class='n'>message</span> <span class='n'>name</span><span class='o'>,</span> <span class='s'>&quot;&gt;&quot;</span><span class='o'>)</span>
<span class='o'>)</span>

<span class='s'>&quot;\nBuilder syntax with attributes:&quot;</span> <span class='n'>println</span>
<span class='n'>s</span> <span class='o'>:=</span> <span class='n'>File</span> <span class='n'>with</span><span class='o'>(</span><span class='s'>&quot;builderSyntax.txt&quot;</span><span class='o'>)</span> <span class='n'>openForReading</span> <span class='n'>contents</span>
<span class='n'>html</span> <span class='o'>:=</span> <span class='k'>doString</span><span class='o'>(</span><span class='n'>s</span><span class='o'>)</span>
<span class='n'>html</span> <span class='n'>println</span>
</code></pre>
</div>
<p>And the output:</p>

<pre><code>Indented builder syntax:
&lt;ul&gt;
  &lt;li&gt;
    Io
  &lt;/li&gt;
  &lt;li&gt;
    Lua
  &lt;/li&gt;
  &lt;li&gt;
    JavaScript
  &lt;/li&gt;
&lt;/ul&gt;

Bracket list syntax:
{1,2,3,4,5} println
list(1, 2, 3, 4, 5)
{&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;} println
list(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;)

Builder syntax with attributes:
&lt;ul&gt;
  &lt;li&gt;
    Io
  &lt;/li&gt;
  &lt;li display=&quot;none&quot;&gt;
    Lua
  &lt;/li&gt;
  &lt;li&gt;
    JavaScript
  &lt;/li&gt;
  &lt;book author=&quot;Tate&quot;&gt;
  &lt;/book&gt;
&lt;/ul&gt;
nil</code></pre>
  </div>

  <div style="margin-top:20px; font-size:14px;">
    <a href="/blog/2012/01/16/seven-languages-week-2-day-3/#disqus_thread" data-disqus-identifier="/blog/2012/01/16/seven-languages-week-2-day-3">Comments</a>
  </div>

    <hr class="fancyrule" />

  <div>
  <h1 style="margin:0px"><a href="/blog/2012/01/11/seven-languages-week-2-day-2/">
  Seven Languages: Week 2 (Io) - Day 2
  </a></h1>
  <div class="faded" style="font-size:14px; margin-bottom:5px;">11 Jan 2012</div>
  <p>Day 2 of Io was the most difficult (as well as the most fun) day yet. It took me quite a while to finish all the exercises to my satisfaction, and it also had the most interesting exercises so far. One in particular (transposing a matrix) was <a href='/blog/2011/12/30/transposing-a-matrix-in-io/'>my favorite.</a>.</p>
<div class='interjection'><p>
(This article is part of a series of posts I am doing about my journey through the exercises of the book <a href='http://pragprog.com/book/btlang/seven-languages-in-seven-weeks'>Seven Languages In Seven Weeks</a>. The article previous to this one is <a href='/blog/2011/12/18/seven-languages-week-2-day-1/'>Week 2 (Io) - Day 1</a>. For an overview see the <a href='/projects/seven-languages-in-seven-weeks/'>project page</a>.)
</p></div>
<h2 id='topics_covered'>Topics covered</h2>

<p>Day 2 of Io went over some basic topics (conditionals, loops and operators) as well as some more complex subjects (messages and reflection).</p>

<p>Messages are a fundamental part of Io - except for comments and commas, everything is a message. Once I began thinking like this, something clicked for me. I started to really grok the code examples, and thinking and coding in Io felt easier, more natural.</p>

<p>Io has simple, straightforward reflection: it actually isn&#8217;t a burden to use or read. Combined with Io&#8217;s other design decisions this gives you quite a lot of power. You get ultimate control over your code, and the power to do whatever you can think of with it - no restriction can stand in your way.</p>

<p>I wonder if this is how Lisp programmers have been feeling for decades.</p>

<h2 id='a_note_about_the_io_community'>A note about the Io community</h2>

<p>While trying to find a way to write a short solution to #5, I ran across what turned out to be a bug in Io&#8217;s Range library. Thanks to the well-thought out questions in Day 1, I already had a list of places to go for help. In the #io channel on freenode I had the good luck to run into <a href='http://jeremy.tregunna.ca/'>Jeremy Tregunna</a> and told him my problem. In a remarkably short period of time (minutes) he had confirmed that it was actually a bug, made the fix, and had a pull request created on the main Io repository on github. Shortly thereafter the patch was merged into the master branch where I downloaded it, compiled it, and could run my previously-broken code!</p>

<p>It was a surprising and pleasant experience for me, and I&#8217;d like to thank Jeremy in particular and the Io community in general for being so friendly, supportive, and quick. Thank you!</p>

<h2 id='highlights_from_exercises'>Highlights from exercises</h2>

<p>It was harder to pick out only a few to highlight - most of these questions were fun to solve and had interesting solutions.</p>

<p>The one that I liked best was <a href='/blog/2011/12/30/transposing-a-matrix-in-io/'>transposing a matrix</a>, and I felt there was enough good material in there to warrant an article of its own.</p>

<p>The solution for Question #2 was unexpectedly straightforward. Once again, Io&#8217;s absolute flexibility and willingness to let you shoot yourself in the foot pays off! The question was:</p>

<blockquote>
<p>2. How would you change / to return 0 if the denominator is zero?</p>
</blockquote>

<p>The answer was only two short lines of code:</p>
<div class='highlight'><pre><code class='io'>    <span class='n'>Number</span> <span class='n'>origDiv</span> <span class='o'>:=</span> <span class='n'>Number</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='s'>&quot;/&quot;</span><span class='o'>)</span>
    <span class='n'>Number</span> <span class='o'>/</span> <span class='o'>=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>denom</span><span class='o'>,</span> <span class='k'>if</span><span class='o'>(</span><span class='n'>denom</span> <span class='o'>==</span> <span class='mf'>0</span><span class='o'>,</span> <span class='mf'>0</span><span class='o'>,</span> <span class='n'>self</span> <span class='n'>origDiv</span><span class='o'>(</span><span class='n'>denom</span><span class='o'>)))</span>
</code></pre>
</div>
<p>The tricky part at first was figuring out how to save a reference to the original division method, but in retrospect it was blindingly obvious. It&#8217;s the same things I&#8217;ve been doing all along with Io: taking things out of slots and putting things in slots!</p>

<p>I would also like to highlight Question #3 to show off how clean writing in a functional style is in Io. The question was:</p>

<blockquote>
<p>3. Write a program to add up all of the numbers in a two-dimensional array.</p>
</blockquote>

<p>No loops needed here - Io has <code>map</code>, <code>filter</code>, <code>reduce</code>, and they mix <strong>well</strong> with Io&#8217;s syntax:</p>
<div class='highlight'><pre><code class='io'>    <span class='n'>addUp2DArray</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>array</span><span class='o'>,</span> <span class='n'>array</span> <span class='n'>flatten</span> <span class='n'>reduce</span><span class='o'>(+))</span>
</code></pre>
</div>
<h2 id='full_code_listing'>Full Code Listing</h2>

<p>That&#8217;s it for the highlights, but as I mentioned earlier, all of the exercises today were pretty interesting. Here is my full code listing for the exercises from Day 2 of Io. The home of this piece of code is with the other exercises <a href='https://github.com/nickknw/seven-languages-in-seven-weeks/blob/master/week-2-io/day2.io'>on github</a>. These exercises this week are really worth taking a look at, I hope you read through some of the following.</p>
<div class='highlight'><pre><code class='io'><span class='c1'># Do:</span>
<span class='c1'>#</span>
<span class='c1'># 1. Write a program to find the nth Fibonacci number. Fib(1) is 1, and fib(4)</span>
<span class='c1'># is 3. As a bonus, solve the problem with recursion and with loops.</span>

<span class='n'>fib_recur</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>num</span><span class='o'>,</span>
    <span class='k'>if</span><span class='o'>(</span><span class='n'>num</span> <span class='o'>&lt;=</span> <span class='mf'>1</span><span class='o'>,</span> <span class='n'>num</span><span class='o'>,</span> <span class='n'>fib_recur</span><span class='o'>(</span><span class='n'>num</span> <span class='o'>-</span> <span class='mf'>1</span><span class='o'>)</span> <span class='o'>+</span> <span class='n'>fib_recur</span><span class='o'>(</span><span class='n'>num</span> <span class='o'>-</span> <span class='mf'>2</span><span class='o'>)</span> <span class='o'>)</span>
<span class='o'>)</span>

<span class='n'>fib_loop</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>num</span><span class='o'>,</span>
    <span class='n'>old</span> <span class='o'>:=</span> <span class='mf'>0</span>
    <span class='n'>new</span> <span class='o'>:=</span> <span class='mf'>1</span>
    <span class='n'>next</span> <span class='o'>:=</span> <span class='mf'>0</span>
    <span class='k'>for</span><span class='o'>(</span><span class='n'>i</span><span class='o'>,</span> <span class='n'>num</span><span class='o'>,</span> <span class='mf'>1</span><span class='o'>,</span> <span class='o'>-</span><span class='mf'>1</span><span class='o'>,</span>
        <span class='n'>next</span> <span class='o'>=</span> <span class='n'>old</span> <span class='o'>+</span> <span class='n'>new</span>
        <span class='n'>old</span> <span class='o'>=</span> <span class='n'>new</span>
        <span class='n'>new</span> <span class='o'>=</span> <span class='n'>next</span>
    <span class='o'>)</span>
    <span class='n'>old</span>
<span class='o'>)</span>
<span class='s'>&quot;Fib 0&quot;</span> <span class='n'>println</span>
<span class='n'>fib_recur</span><span class='o'>(</span><span class='mf'>0</span><span class='o'>)</span> <span class='n'>println</span>
<span class='n'>fib_loop</span><span class='o'>(</span><span class='mf'>0</span><span class='o'>)</span> <span class='n'>println</span>

<span class='s'>&quot;Fib 4&quot;</span> <span class='n'>println</span>
<span class='n'>fib_recur</span><span class='o'>(</span><span class='mf'>4</span><span class='o'>)</span> <span class='n'>println</span>
<span class='n'>fib_loop</span><span class='o'>(</span><span class='mf'>4</span><span class='o'>)</span> <span class='n'>println</span>

<span class='s'>&quot;Fib 8&quot;</span> <span class='n'>println</span>
<span class='n'>fib_recur</span><span class='o'>(</span><span class='mf'>8</span><span class='o'>)</span> <span class='n'>println</span>
<span class='n'>fib_loop</span><span class='o'>(</span><span class='mf'>8</span><span class='o'>)</span> <span class='n'>println</span>

<span class='c1'># 2. How would you change / to return 0 if the denominator is zero?</span>
<span class='c1'>#</span>
<span class='c1'># The tricky bit is saving a reference to the old method:</span>
<span class='n'>Number</span> <span class='n'>origDiv</span> <span class='o'>:=</span> <span class='n'>Number</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='s'>&quot;/&quot;</span><span class='o'>)</span>

<span class='c1'># Overriding the / method is surprisingly straightforward</span>
<span class='n'>Number</span> <span class='o'>/</span> <span class='o'>=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>denom</span><span class='o'>,</span> <span class='k'>if</span><span class='o'>(</span><span class='n'>denom</span> <span class='o'>==</span> <span class='mf'>0</span><span class='o'>,</span> <span class='mf'>0</span><span class='o'>,</span> <span class='n'>self</span> <span class='n'>origDiv</span><span class='o'>(</span><span class='n'>denom</span><span class='o'>)))</span>

<span class='s'>&quot;Testing division&quot;</span> <span class='n'>println</span>
<span class='mf'>4</span> <span class='o'>/</span> <span class='mf'>2</span> <span class='n'>println</span>
<span class='mf'>4</span> <span class='o'>/</span> <span class='mf'>0</span> <span class='n'>println</span>

<span class='c1'># 3. Write a program to add up all of the numbers in a two-dimensional array.</span>
<span class='n'>addUp2DArray</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>array</span><span class='o'>,</span> <span class='n'>array</span> <span class='n'>flatten</span> <span class='n'>reduce</span><span class='o'>(+))</span>

<span class='s'>&quot;add up 2d array&quot;</span> <span class='n'>println</span>
<span class='n'>addUp2DArray</span><span class='o'>(</span><span class='n'>list</span><span class='o'>(</span><span class='mf'>2</span><span class='o'>,</span><span class='mf'>3</span><span class='o'>,</span><span class='mf'>4</span><span class='o'>,</span><span class='mf'>5</span><span class='o'>))</span> <span class='n'>println</span>
<span class='n'>addUp2DArray</span><span class='o'>(</span><span class='n'>list</span><span class='o'>(</span><span class='mf'>2</span><span class='o'>,</span><span class='mf'>3</span><span class='o'>,</span> <span class='n'>list</span><span class='o'>(</span><span class='mf'>1</span><span class='o'>,</span><span class='mf'>1</span><span class='o'>,</span><span class='mf'>1</span><span class='o'>),</span> <span class='mf'>4</span><span class='o'>,</span><span class='mf'>5</span><span class='o'>))</span> <span class='n'>println</span>

<span class='c1'># 4. Add a slot called myAverage to a list that computes the average of all the</span>
<span class='c1'># numbers in a list. What happens if there are no numbers in a list? (Bonus:</span>
<span class='c1'># Raise an Io exception if any item in the list is not a number.)</span>

<span class='c1'># Easy way:</span>
<span class='n'>List</span> <span class='n'>myAverage</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>self</span> <span class='n'>average</span><span class='o'>)</span>

<span class='c1'># Probably the way he meant (plus bonus):</span>
<span class='n'>List</span> <span class='n'>myAverage2</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
    <span class='n'>containsNonDigit</span> <span class='o'>:=</span> <span class='n'>select</span><span class='o'>(</span><span class='n'>x</span><span class='o'>,</span> <span class='n'>x</span> <span class='n'>asNumber</span><span class='o'>()</span> <span class='n'>isNan</span><span class='o'>())</span> <span class='n'>size</span> <span class='o'>&gt;</span> <span class='mf'>0</span>
    <span class='k'>if</span><span class='o'>(</span><span class='n'>containsNonDigit</span><span class='o'>,</span> <span class='n'>Exception</span> <span class='n'>raise</span><span class='o'>(</span><span class='s'>&quot;An item in the list is not a number&quot;</span><span class='o'>))</span>

    <span class='n'>flatList</span> <span class='o'>:=</span> <span class='n'>self</span> <span class='n'>flatten</span>
    <span class='n'>flatList</span> <span class='n'>reduce</span><span class='o'>(+)</span> <span class='o'>/</span> <span class='n'>flatList</span> <span class='n'>size</span>
<span class='o'>)</span>

<span class='s'>&quot;Averaging the numbers in a list&quot;</span> <span class='n'>println</span>
<span class='n'>list</span><span class='o'>(</span><span class='mf'>1</span><span class='o'>,</span><span class='mf'>2</span><span class='o'>,</span><span class='mf'>3</span><span class='o'>,</span><span class='mf'>4</span><span class='o'>)</span> <span class='n'>myAverage2</span> <span class='n'>println</span>
<span class='c1'>#list(1,2,3,4,&quot;a&quot;) myAverage2 println</span>

<span class='c1'># 5. Write a prototype for a two-dimensional list. The dim(x,y) method should</span>
<span class='c1'># allocate a list of y lists that are x elements long, set(x, y, value) should</span>
<span class='c1'># set a value, and get(x, y) should return that value.</span>
<span class='c1'>#</span>
<span class='n'>List2D</span> <span class='o'>:=</span> <span class='n'>List</span> <span class='k'>clone</span>
<span class='n'>List2D</span> <span class='n'>transposed</span> <span class='o'>:=</span> <span class='no'>false</span>

<span class='n'>List2D</span> <span class='n'>dim</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>x</span><span class='o'>,</span> <span class='n'>y</span><span class='o'>,</span>
    <span class='n'>y</span> <span class='n'>repeat</span><span class='o'>(</span>
        <span class='n'>inner</span> <span class='o'>:=</span> <span class='n'>list</span><span class='o'>()</span>
        <span class='n'>x</span> <span class='n'>repeat</span><span class='o'>(</span><span class='n'>inner</span> <span class='n'>push</span><span class='o'>(</span><span class='no'>nil</span><span class='o'>))</span>
        <span class='n'>self</span> <span class='n'>append</span><span class='o'>(</span><span class='n'>inner</span><span class='o'>)</span>
    <span class='o'>)</span>
<span class='o'>)</span>

<span class='c1'># Hmmm, let&#39;s try this again</span>

<span class='c1'># Make sure you have this commit before using this solution</span>
<span class='c1'># https://github.com/stevedekorte/io/commit/4907d9d618499daa8973c0db380317678c0abd51</span>
<span class='n'>List2D</span> <span class='n'>dim2</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>x</span><span class='o'>,</span> <span class='n'>y</span><span class='o'>,</span>
    <span class='n'>y</span> <span class='n'>repeat</span><span class='o'>(</span><span class='n'>self</span> <span class='n'>append</span><span class='o'>(</span><span class='n'>Range</span> <span class='mf'>0</span> <span class='n'>to</span><span class='o'>(</span><span class='n'>x</span><span class='o'>)</span> <span class='n'>asList</span><span class='o'>()</span> <span class='n'>map</span><span class='o'>(</span><span class='no'>nil</span><span class='o'>)))</span>
<span class='o'>)</span>

<span class='s'>&quot;Creating matrices&quot;</span> <span class='n'>println</span>
<span class='n'>firstMatrix</span> <span class='o'>:=</span> <span class='n'>List2D</span> <span class='k'>clone</span>
<span class='n'>firstMatrix</span> <span class='n'>dim</span><span class='o'>(</span><span class='mf'>6</span><span class='o'>,</span><span class='mf'>7</span><span class='o'>)</span> <span class='n'>println</span>
<span class='s'>&quot;&quot;</span> <span class='n'>println</span>

<span class='n'>secondMatrix</span> <span class='o'>:=</span> <span class='n'>List2D</span> <span class='k'>clone</span>
<span class='n'>secondMatrix</span> <span class='n'>dim2</span><span class='o'>(</span><span class='mf'>6</span><span class='o'>,</span><span class='mf'>7</span><span class='o'>)</span> <span class='n'>println</span>
<span class='s'>&quot;&quot;</span> <span class='n'>println</span>

<span class='c1'># The below will cause infinite loop until you apply the change in the</span>
<span class='c1'># commit above</span>
<span class='n'>testBounds</span> <span class='o'>:=</span> <span class='n'>List2D</span> <span class='k'>clone</span>
<span class='n'>testBounds</span> <span class='n'>dim2</span><span class='o'>(</span><span class='mf'>0</span><span class='o'>,</span> <span class='mf'>2</span><span class='o'>)</span>
<span class='n'>testBounds</span> <span class='n'>dim2</span><span class='o'>(</span><span class='mf'>0</span><span class='o'>,</span> <span class='mf'>2</span><span class='o'>)</span>

<span class='n'>List2D</span> <span class='n'>set</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>x</span><span class='o'>,</span> <span class='n'>y</span><span class='o'>,</span> <span class='n'>value</span><span class='o'>,</span>
    <span class='n'>self</span> <span class='n'>at</span><span class='o'>(</span><span class='n'>x</span><span class='o'>)</span> <span class='n'>atPut</span><span class='o'>(</span><span class='n'>y</span><span class='o'>,</span> <span class='n'>value</span><span class='o'>)</span>
<span class='o'>)</span>

<span class='n'>List2D</span> <span class='n'>get</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>x</span><span class='o'>,</span> <span class='n'>y</span><span class='o'>,</span>
    <span class='n'>self</span> <span class='n'>at</span><span class='o'>(</span><span class='n'>x</span><span class='o'>)</span> <span class='n'>at</span><span class='o'>(</span><span class='n'>y</span><span class='o'>)</span>
<span class='o'>)</span>

<span class='s'>&quot;Setting and getting a matrix&quot;</span> <span class='n'>println</span>
<span class='n'>firstMatrix</span> <span class='n'>set</span><span class='o'>(</span><span class='mf'>2</span><span class='o'>,</span><span class='mf'>4</span><span class='o'>,</span><span class='s'>&quot;asdfad&quot;</span><span class='o'>)</span>
<span class='n'>firstMatrix</span> <span class='n'>println</span>
<span class='s'>&quot;&quot;</span> <span class='n'>println</span>

<span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>2</span><span class='o'>,</span><span class='mf'>4</span><span class='o'>)</span> <span class='n'>println</span>
<span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>1</span><span class='o'>,</span><span class='mf'>2</span><span class='o'>)</span> <span class='n'>println</span>

<span class='c1'># 6. Bonus: Write a transpose method so that (new_matrix get(y, x)) ==</span>
<span class='c1'># matrix get(x,y) on the original list</span>

<span class='n'>flipFirstTwoArgs</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>,</span>
    <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>setArgumentNames</span><span class='o'>(</span> <span class='n'>list</span><span class='o'>(</span>
        <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>at</span><span class='o'>(</span><span class='mf'>1</span><span class='o'>),</span>
        <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>at</span><span class='o'>(</span><span class='mf'>0</span><span class='o'>),</span>
        <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>rest</span> <span class='n'>rest</span>
    <span class='o'>)</span> <span class='n'>flatten</span><span class='o'>)</span>
<span class='o'>)</span>

<span class='n'>List2D</span> <span class='n'>transpose</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
    <span class='n'>self</span> <span class='n'>get</span> <span class='o'>=</span> <span class='n'>flipFirstTwoArgs</span><span class='o'>(</span><span class='s'>&quot;get&quot;</span><span class='o'>)</span>
    <span class='n'>self</span> <span class='n'>set</span> <span class='o'>=</span> <span class='n'>flipFirstTwoArgs</span><span class='o'>(</span><span class='s'>&quot;set&quot;</span><span class='o'>)</span>
<span class='o'>)</span>

<span class='s'>&quot;Transposing a matrix&quot;</span> <span class='n'>println</span>
<span class='s'>&quot;2, 4: &quot;</span> <span class='n'>print</span><span class='o'>;</span> <span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>2</span><span class='o'>,</span><span class='mf'>4</span><span class='o'>)</span> <span class='n'>println</span>
<span class='s'>&quot;4, 2: &quot;</span> <span class='n'>print</span><span class='o'>;</span> <span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>4</span><span class='o'>,</span><span class='mf'>2</span><span class='o'>)</span> <span class='n'>println</span>

<span class='s'>&quot;transpose!&quot;</span> <span class='n'>println</span>
<span class='n'>firstMatrix</span> <span class='n'>transpose</span>

<span class='s'>&quot;2, 4: &quot;</span> <span class='n'>print</span><span class='o'>;</span> <span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>2</span><span class='o'>,</span><span class='mf'>4</span><span class='o'>)</span> <span class='n'>println</span>
<span class='s'>&quot;4, 2: &quot;</span> <span class='n'>print</span><span class='o'>;</span> <span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>4</span><span class='o'>,</span><span class='mf'>2</span><span class='o'>)</span> <span class='n'>println</span>
<span class='s'>&quot;Set 5, 3 to NEW&quot;</span> <span class='n'>println</span><span class='o'>;</span> <span class='n'>firstMatrix</span> <span class='n'>set</span><span class='o'>(</span><span class='mf'>5</span><span class='o'>,</span><span class='mf'>3</span><span class='o'>,</span> <span class='s'>&quot;NEW&quot;</span><span class='o'>)</span>
<span class='s'>&quot;5, 3: &quot;</span> <span class='n'>print</span><span class='o'>;</span> <span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>5</span><span class='o'>,</span><span class='mf'>3</span><span class='o'>)</span> <span class='n'>println</span>
<span class='s'>&quot;3, 5: &quot;</span> <span class='n'>print</span><span class='o'>;</span> <span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>3</span><span class='o'>,</span><span class='mf'>5</span><span class='o'>)</span> <span class='n'>println</span>

<span class='s'>&quot;transpose again!&quot;</span> <span class='n'>println</span>
<span class='n'>firstMatrix</span> <span class='n'>transpose</span>

<span class='s'>&quot;2, 4: &quot;</span> <span class='n'>print</span><span class='o'>;</span> <span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>2</span><span class='o'>,</span><span class='mf'>4</span><span class='o'>)</span> <span class='n'>println</span>
<span class='s'>&quot;4, 2: &quot;</span> <span class='n'>print</span><span class='o'>;</span> <span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>4</span><span class='o'>,</span><span class='mf'>2</span><span class='o'>)</span> <span class='n'>println</span>
<span class='s'>&quot;5, 3: &quot;</span> <span class='n'>print</span><span class='o'>;</span> <span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>5</span><span class='o'>,</span><span class='mf'>3</span><span class='o'>)</span> <span class='n'>println</span>
<span class='s'>&quot;3, 5: &quot;</span> <span class='n'>print</span><span class='o'>;</span> <span class='n'>firstMatrix</span> <span class='n'>get</span><span class='o'>(</span><span class='mf'>3</span><span class='o'>,</span><span class='mf'>5</span><span class='o'>)</span> <span class='n'>println</span>

<span class='c1'># 7. Write the matrix to a file, and read a matrix from a file.</span>

<span class='s'>&quot;Writing and reading a matrix from a file&quot;</span> <span class='n'>println</span>
<span class='n'>file</span> <span class='o'>:=</span> <span class='n'>File</span> <span class='n'>with</span><span class='o'>(</span><span class='s'>&quot;matrix.txt&quot;</span><span class='o'>)</span>
<span class='n'>file</span> <span class='n'>remove</span>
<span class='n'>file</span> <span class='n'>openForUpdating</span>
<span class='n'>file</span> <span class='n'>write</span><span class='o'>(</span><span class='n'>firstMatrix</span> <span class='n'>join</span><span class='o'>(</span><span class='s'>&quot;, &quot;</span><span class='o'>))</span>
<span class='n'>file</span> <span class='n'>close</span>

<span class='n'>file</span> <span class='o'>=</span> <span class='n'>File</span> <span class='n'>with</span><span class='o'>(</span><span class='s'>&quot;matrix.txt&quot;</span><span class='o'>)</span>
<span class='n'>file</span> <span class='n'>openForReading</span>
<span class='n'>lines</span> <span class='o'>:=</span> <span class='n'>file</span> <span class='n'>readLines</span>
<span class='n'>file</span> <span class='n'>close</span>
<span class='n'>lines</span> <span class='n'>at</span><span class='o'>(</span><span class='mf'>0</span><span class='o'>)</span> <span class='n'>type</span> <span class='n'>println</span>
<span class='n'>matrixFromFile</span> <span class='o'>:=</span> <span class='n'>lines</span> <span class='n'>at</span><span class='o'>(</span><span class='mf'>0</span><span class='o'>)</span> <span class='n'>split</span><span class='o'>(</span><span class='s'>&quot;, &quot;</span><span class='o'>)</span>
<span class='n'>matrixFromFile</span> <span class='n'>type</span> <span class='n'>println</span>
<span class='n'>matrixFromFile</span> <span class='n'>println</span>

<span class='c1'># 8. Write a program that gives you ten tries to guess a random number from</span>
<span class='c1'># 1-100. If you would like, give a hint of &quot;hotter&quot; or &quot;colder&quot; after the first</span>
<span class='c1'># guess.</span>

<span class='s'>&quot;Random number guesser&quot;</span> <span class='n'>println</span>
<span class='n'>randomNumber</span> <span class='o'>:=</span> <span class='o'>((</span><span class='n'>Random</span> <span class='n'>value</span><span class='o'>)</span> <span class='o'>*</span> <span class='mf'>100</span> <span class='o'>+</span> <span class='mf'>1</span><span class='o'>)</span> <span class='n'>floor</span>

<span class='n'>i</span> <span class='o'>:=</span> <span class='mf'>0</span>
<span class='n'>guess</span> <span class='o'>:=</span> <span class='mf'>0</span>
<span class='n'>while</span><span class='o'>(</span><span class='n'>i</span> <span class='o'>&lt;</span> <span class='mf'>10</span> <span class='n'>and</span> <span class='n'>guess</span> <span class='o'>!=</span> <span class='n'>randomNumber</span><span class='o'>,</span>
    <span class='o'>(</span><span class='s'>&quot;Guess a number between 1 and 100: (guess &quot;</span> <span class='o'>..</span> <span class='n'>i</span><span class='o'>+</span><span class='mf'>1</span> <span class='o'>..</span> <span class='s'>&quot; of 10): &quot;</span><span class='o'>)</span> <span class='n'>print</span>
    <span class='n'>guess</span> <span class='o'>=</span> <span class='n'>ReadLine</span> <span class='n'>readLine</span>
    <span class='n'>guess</span> <span class='o'>=</span> <span class='k'>if</span><span class='o'>(</span><span class='n'>guess</span> <span class='n'>asNumber</span> <span class='n'>isNan</span><span class='o'>,</span> <span class='mf'>0</span><span class='o'>,</span> <span class='n'>guess</span> <span class='n'>asNumber</span><span class='o'>)</span>
    <span class='k'>if</span><span class='o'>(</span><span class='n'>guess</span> <span class='o'>&gt;</span> <span class='n'>randomNumber</span><span class='o'>,</span> <span class='s'>&quot;Too high&quot;</span> <span class='n'>println</span><span class='o'>)</span>
    <span class='k'>if</span><span class='o'>(</span><span class='n'>guess</span> <span class='o'>&lt;</span> <span class='n'>randomNumber</span><span class='o'>,</span> <span class='s'>&quot;Too low&quot;</span> <span class='n'>println</span><span class='o'>)</span>
    <span class='n'>i</span> <span class='o'>=</span> <span class='n'>i</span> <span class='o'>+</span> <span class='mf'>1</span>
<span class='o'>)</span>

<span class='k'>if</span><span class='o'>(</span><span class='n'>guess</span> <span class='o'>==</span> <span class='n'>randomNumber</span><span class='o'>,</span>
    <span class='s'>&quot;Congrats, you did it!&quot;</span> <span class='n'>println</span><span class='o'>,</span>
    <span class='s'>&quot;Too bad, maybe next time&quot;</span> <span class='n'>println</span><span class='o'>)</span>
</code></pre>
</div>
<p>And the output:</p>
<div class='highlight'><pre><code class='bash'><span class='nv'>$ </span>io day2.io
Fib 0
0
0
Fib 4
3
3
Fib 8
21
21
Testing division
2
0
add up 2d array
14
17
Averaging the numbers in a list
2.5
Creating matrices
list<span class='o'>(</span>list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>))</span>

list<span class='o'>(</span>list<span class='o'>(</span>nil, nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil, nil<span class='o'>))</span>

Setting and getting a matrix
list<span class='o'>(</span>list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, asdfad, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>))</span>

asdfad
nil
Transposing a matrix
2, 4: asdfad
4, 2: nil
transpose!
2, 4: nil
4, 2: asdfad
Set 5, 3 to NEW
5, 3: NEW
3, 5: nil
transpose again!
2, 4: asdfad
4, 2: nil
5, 3: nil
3, 5: NEW
Writing and reading a matrix from a file
Sequence
List
list<span class='o'>(</span>list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, asdfad, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, NEW<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>)</span>, list<span class='o'>(</span>nil, nil, nil, nil, nil, nil<span class='o'>))</span>
Random number guesser
Guess a number between 1 and 100: <span class='o'>(</span>guess 1 of 10<span class='o'>)</span>: 50
Too high
Guess a number between 1 and 100: <span class='o'>(</span>guess 2 of 10<span class='o'>)</span>: 25
Too low
Guess a number between 1 and 100: <span class='o'>(</span>guess 3 of 10<span class='o'>)</span>: 38
Too low
Guess a number between 1 and 100: <span class='o'>(</span>guess 4 of 10<span class='o'>)</span>: 44
Too high
Guess a number between 1 and 100: <span class='o'>(</span>guess 5 of 10<span class='o'>)</span>: 41
Too low
Guess a number between 1 and 100: <span class='o'>(</span>guess 6 of 10<span class='o'>)</span>: 43
Congrats, you did it!
</code></pre>
</div>
<p>Next in this series: <a href='/blog/2012/01/16/seven-languages-week-2-day-3/'>Day 3 of Io</a></p>
  </div>

  <div style="margin-top:20px; font-size:14px;">
    <a href="/blog/2012/01/11/seven-languages-week-2-day-2/#disqus_thread" data-disqus-identifier="/blog/2012/01/11/seven-languages-week-2-day-2">Comments</a>
  </div>

    <hr class="fancyrule" />

  <div>
  <h1 style="margin:0px"><a href="/blog/2011/12/30/transposing-a-matrix-in-io/">
  Transposing a matrix in Io
  </a></h1>
  <div class="faded" style="font-size:14px; margin-bottom:5px;">30 Dec 2011</div>
  <p>While doing the exercises from Seven Languages In Seven Weeks, I came up with a neat solution to transposing a matrix that was encouraged by Io&#8217;s flexibility and free-wheeling nature. Instead of creating a new transposed matrix or attempting a complicated in-place transpose, I did something that executes in O(1), uses a negligible amount of memory, and is very short and simple.</p>

<p>What? How is it possible to transpose a matrix of 1,000,000 elements in the same time it takes to transpose a matrix of 4?</p>

<p>By cheating! I <strong>don&#8217;t</strong> transpose the matrix, I modify the element accessor methods so that they interpret the <code>x</code> parameter as <code>y</code>, and vice versa. To my dismay, I later found that <a href='http://en.wikipedia.org/wiki/Transpose#Implementation_of_matrix_transposition_on_computers'>this isn&#8217;t a new approach</a> to solving this problem.</p>

<p>However, my implementation in Io still has something going for it. Because of Io&#8217;s extreme malleability, I can write my <code>transpose</code> method such that calling it permanently swaps the argument order in the <code>get</code> and <code>set</code> methods of that individual matrix object. In most other languages <a href='#footnote-1' class='super' id='footnote-1-link'>[1]</a> , writing this kind of fake transpose would require keeping track of state with if statements to check if a given matrix is currently &#8216;transposed&#8217; or not. This is, conceptually, nonsense: transposing is something you <em>do to</em> matrices, not a <em>property</em> of them.</p>

<p>Io lets you write this fake transpose in a way that is fun, short, and elegant.</p>

<h2 id='the_solution'>The Solution</h2>

<p>Here is the problem statement from the book:</p>

<blockquote>
<p>Write a transpose method so that (new_matrix get(y, x)) == matrix get(x,y) on the original list</p>
</blockquote>

<p>Before we get started, this is what the final solution looks like. Try and become a little familiar with this before we move on (it will all be explained in detail below, don&#8217;t worry).</p>
<div class='highlight'><pre><code class='io'><span class='n'>flipFirstTwoArgs</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>,</span>
    <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>setArgumentNames</span><span class='o'>(</span> <span class='n'>list</span><span class='o'>(</span>
        <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>at</span><span class='o'>(</span><span class='mf'>1</span><span class='o'>),</span>
        <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>at</span><span class='o'>(</span><span class='mf'>0</span><span class='o'>),</span>
        <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>rest</span> <span class='n'>rest</span>
    <span class='o'>)</span> <span class='n'>flatten</span><span class='o'>)</span>
<span class='o'>)</span>

<span class='n'>List2D</span> <span class='n'>transpose</span> <span class='o'>:=</span> <span class='k'>method</span><span class='o'>(</span>
    <span class='n'>self</span> <span class='n'>get</span> <span class='o'>=</span> <span class='n'>flipFirstTwoArgs</span><span class='o'>(</span><span class='s'>&quot;get&quot;</span><span class='o'>)</span>
    <span class='n'>self</span> <span class='n'>set</span> <span class='o'>=</span> <span class='n'>flipFirstTwoArgs</span><span class='o'>(</span><span class='s'>&quot;set&quot;</span><span class='o'>)</span>
<span class='o'>)</span>
</code></pre>
</div>
<p>List2D is a simple matrix prototype from the previous exercise. It is the thing that is being transposed.</p>

<p>The <code>transpose</code> method itself is simple enough: most of the heavy lifting is done in a helper method I created, <code>flipFirstTwoArgs</code>. From its name and the name of its argument, we can tell this method is saying: &#8220;give me the name of a slot that holds a method and I will flip the first two arguments of that method&#8221;.</p>

<p>Okay. So, how?</p>

<h2 id='the_explanation'>The Explanation</h2>

<p>The following line of code gets the method we are going to modify and sets the names of its arguments.</p>

<p><strong>Line 1:</strong></p>
<div class='highlight'><pre><code class='io'>    <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>setArgumentNames</span><span class='o'>(</span> 
        <span class='c1'>#list of argument names goes here </span>
    <span class='o'>)</span>
</code></pre>
</div>
<p>For a concrete example, if I just wanted to change the argument names for my &#8220;get&#8221; method from get(x, y) to get(y, x) I could hardcode in some values and call it like this:</p>
<div class='highlight'><pre><code class='io'>    <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='s'>&quot;get&quot;</span><span class='o'>)</span> <span class='n'>setArgumentNames</span><span class='o'>(</span>
        <span class='n'>list</span><span class='o'>(</span><span class='s'>&quot;y&quot;</span><span class='o'>,</span> <span class='s'>&quot;x&quot;</span><span class='o'>)</span>
    <span class='o'>)</span>
</code></pre>
</div>
<p>But that wouldn&#8217;t quite be fancy enough. I&#8217;d rather write a method that would let me swap the first two arguments of <strong>any</strong> method. So, going back to the snippet above, that&#8217;s what the next two lines do:</p>

<p><strong>Lines 2-3:</strong></p>
<div class='highlight'><pre><code class='io'>    <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>at</span><span class='o'>(</span><span class='mf'>1</span><span class='o'>),</span>
    <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>at</span><span class='o'>(</span><span class='mf'>0</span><span class='o'>),</span>
</code></pre>
</div>
<p>If I wanted to keep the arguments in the same order I would have put the <code>0</code> in the first line, then the <code>1</code> in the second line. Make sense so far?</p>

<p>I could have left it here, but then what would happen if I told it to change a method that looked like <code>doSomething(x, y, z)</code>? It would take the argument at position <code>1</code>, then the argument at position <code>0</code>. The <code>z</code> would get discarded and that method wouldn&#8217;t be very useful anymore. Hence the next line:</p>

<p><strong>Line 4:</strong></p>
<div class='highlight'><pre><code class='io'>    <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>rest</span> <span class='n'>rest</span>
</code></pre>
</div>
<p><code>rest</code> is Io&#8217;s version of <code>cdr</code> or <code>tail</code>. It is a method that returns everything except for the first element of a list. So if you call <code>rest</code> on the result of <code>rest</code> you get a list that has all its elements except for the first two.</p>

<p>Let&#8217;s recap. If I call this method we&#8217;re defining with my fictitious <code>doSomething(x, y, z)</code> method as the argument, these previous lines would resolve into:</p>
<div class='highlight'><pre><code class='io'>    <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='s'>&quot;doSomething&quot;</span><span class='o'>)</span> <span class='n'>setArgumentNames</span><span class='o'>(</span> <span class='n'>list</span><span class='o'>(</span>
        <span class='s'>&quot;y&quot;</span><span class='o'>,</span> 
        <span class='s'>&quot;x&quot;</span><span class='o'>,</span> 
        <span class='n'>list</span><span class='o'>(</span><span class='s'>&quot;z&quot;</span><span class='o'>)</span>
    <span class='o'>)</span> <span class='o'>)</span>
</code></pre>
</div>
<p>That&#8217;s not quite right, <code>setArgumentNames</code> is expecting a simple flat list, none of this nested list stuff. So let&#8217;s flatten the list of argument names before giving it to <code>setArgumentNames</code>.</p>

<p><strong>Line 5:</strong></p>
<div class='highlight'><pre><code class='io'>    <span class='o'>)</span> <span class='n'>flatten</span> <span class='o'>)</span>
</code></pre>
</div>
<p>If we apply it to the <code>doSomething</code> example, the code now looks like this:</p>
<div class='highlight'><pre><code class='io'>    <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='s'>&quot;doSomething&quot;</span><span class='o'>)</span> <span class='n'>setArgumentNames</span><span class='o'>(</span> <span class='n'>list</span><span class='o'>(</span>
        <span class='s'>&quot;y&quot;</span><span class='o'>,</span> 
        <span class='s'>&quot;x&quot;</span><span class='o'>,</span> 
        <span class='n'>list</span><span class='o'>(</span><span class='s'>&quot;z&quot;</span><span class='o'>)</span>
    <span class='o'>)</span> <span class='n'>flatten</span> <span class='o'>)</span> 
</code></pre>
</div>
<p>Which would end up resolving into:</p>
<div class='highlight'><pre><code class='io'>    <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='s'>&quot;doSomething&quot;</span><span class='o'>)</span> <span class='n'>setArgumentNames</span><span class='o'>(</span>
        <span class='n'>list</span><span class='o'>(</span><span class='s'>&quot;y&quot;</span><span class='o'>,</span> <span class='s'>&quot;x&quot;</span><span class='o'>,</span> <span class='s'>&quot;z&quot;</span><span class='o'>)</span> 
    <span class='o'>)</span>
</code></pre>
</div>
<p>There, much better. And that explains the last line!</p>

<h2 id='wrapup'>Wrap-up</h2>

<p>Now, putting back together all the lines I&#8217;ve explained, here is the body of the <code>flipFirstTwoArgs</code> method again:</p>
<div class='highlight'><pre><code class='io'>    <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>setArgumentNames</span><span class='o'>(</span> <span class='n'>list</span><span class='o'>(</span>
        <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>at</span><span class='o'>(</span><span class='mf'>1</span><span class='o'>),</span>
        <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>at</span><span class='o'>(</span><span class='mf'>0</span><span class='o'>),</span>
        <span class='n'>self</span> <span class='n'>getSlot</span><span class='o'>(</span><span class='n'>slotName</span><span class='o'>)</span> <span class='n'>argumentNames</span> <span class='n'>rest</span> <span class='n'>rest</span>
    <span class='o'>)</span> <span class='n'>flatten</span><span class='o'>)</span>
</code></pre>
</div>
<p>If I&#8217;ve done my job right, it should make a lot more sense this time.</p>

<p>You can find the rest of the code (including the List2D prototype) on github - a good place to start is <a href='https://github.com/nickknw/seven-languages-in-seven-weeks/blob/master/week-2-io/day2.io#L72'>line 72 of day2.io</a>. To read more I&#8217;ve written about solving these exercises, check my <a href='/projects/seven-languages-in-seven-weeks/'>project page for Seven Languages in Seven Weeks</a>.</p>
<h3>Footnotes</h3><ol><li>There are exceptions of course. I'm sure any lisp would be great at this, as well as Ruby, Groovy, and other languages with powerful metaprogramming capabilities. <a href='#footnote-1-link' id='footnote-1'>↩</a></li></ol>
  </div>

  <div style="margin-top:20px; font-size:14px;">
    <a href="/blog/2011/12/30/transposing-a-matrix-in-io/#disqus_thread" data-disqus-identifier="/blog/2011/12/30/transposing-a-matrix-in-io">Comments</a>
  </div>

    <hr class="fancyrule" />


<a href="/blog/archive/">← Older posts</a>

  <script type="text/javascript">
      var disqus_shortname = 'nickknowlson'; 
  
      (function () {
          var s = document.createElement('script'); s.async = true;
          s.type = 'text/javascript';
          s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
          (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
  </script>

            </div>
        </div>
        <div id="footer">&copy; Copyright 2012 2012 Nick Knowlson</div>
        <div style="display: none;">Content by Nick Knowlson: <a href="https://plus.google.com/111820015518413982003?rel=author">Google+</a></div>
    </body>
</html>
