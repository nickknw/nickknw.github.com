<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
    <head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
        <meta name="description" content="">

        <title>Word Frequency | Nick Knowlson</title>

        <link rel="stylesheet" type="text/css" href="/css/inuit.css" >
        <link rel="stylesheet" type="text/css" href="/css/style.css" >
        <link rel="stylesheet" type="text/css" href="/css/syntax.css" >
	<link rel="shortcut icon" href="/favicon.ico" />
	<link rel="apple-touch-icon-precomposed" href="/favicon.ico" >
        <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Blog ATOM Feed" />
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>

        
        <link rel="stylesheet" type="text/css" href="/css/jquery.lightbox-0.5.css" >
        <script src="/js/jquery.lightbox-0.5.pack.js"></script>
        <script type="text/javascript">
            $(function() { 
                $('#gallery a').lightBox({
                    fixedNavigation:true,
                    imageLoading: '/img/lightbox-ico-loading.gif',
                    imageBlank: '/img/lightbox-blank.gif',
                    imageBtnClose: '/img/lightbox-btn-close.gif',
                    imageBtnPrev: '/img/lightbox-btn-prev.gif',
                    imageBtnNext: '/img/lightbox-btn-next.gif'
                });
            });
        </script>
        
        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-24781362-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>
    </head>
    <body>
	<div id="header" class="grid grid-16">
            <a href="/"><img src="/img/logo3.png" alt="logo" /></a>
            <ul id="nav">
                <li><a class="" href="/">Home</a></li>
                <li><a class="" href="/about/">About</a></li>
                <li><a class="selected" href="/projects/">Projects</a></li>
                <li><a class="" href="/blog/">Blog</a></li>
                <li><a class="" href="/contact/">Contact</a></li>
            </ul>
	</div>

        <div id="content" class="grid grid-16" style="background-color:white; clear:both;">
            <div style="padding:25px">
                <p> <a href="/projects/">&laquo; Back to projects</a></p>

<img class="project_thumbnail" style="float: right;" src="/img/thumb_word_frequency.png">
<h1 style="">Word Frequency</h1>
<div><strong>Languages: </strong>Ruby</div>
<div><strong>Summary: </strong>Scripts to conveniently do word and string frequency analysis on source code.</div>

<div style="margin-bottom:.75em;"><strong>Source code: </strong><a href="http://github.com/nickknw/word_frequency">github</a> <span style="font-size:.85em">[<a href="http://github.com/nickknw/word_frequency/tarball/master">.tar.gz</a> / <a href="http://github.com/nickknw/word_frequency/zipball/master">.zip</a>]</span></div>


<h2>Details</h2>
<p><p>My word_frequency script counts the number of times a each word (or phrase) occurs in a programming project and produces a sorted list of which ones appear most frequently. It helps identify simple trends and recurring patterns and is most useful when trying to get familiar with a new codebase.</p><p>It answers the questions &#8220;What is the most frequently occurring phrase in this project that is 1 word long? What about 2 words long? What about 8?&#8221; etc.</p><p>At low word counts, it mostly reflects the keywords of the language, as you would expect. Once you get into higher counts it can reveal interesting things about patterns in the code, as well as code duplication.</p><h2 id='usage'>Usage</h2><div class='highlight'><pre><code class='bash'><span class='nb'>cd </span>my_csharp_project
ruby word_frequency.rb 1 cs

<span class='nb'>cd</span> ../my_website
ruby word_frequency.rb 5 js
</code></pre>
</div><h2 id='string_frequency'>String Frequency</h2><p>I made an alternate version of the previous tool with one modification: it only searches inside of string literals in the source code. It is good for finding out there are 89 occurrences of <code>&quot;SELECT * FROM&quot;</code> (among other things). This version might be more useful for finding actual problems with code than the initial version.</p><p>It should ideally be merged with <code>word_frequency.rb</code> and be enabled with a flag, but for now it works well enough as is.</p><h2 id='example'>Example</h2><p>I&#8217;m going to use <a href='http://sourceforge.net/projects/dwsim/'>DWSIM</a> for this example. DWSIM is an open source chemical process simulator written in VB.NET. I am using it as an example for my VB.NET Signature Survey project because it is big, open source, and written in VB.NET. Since I already had it handy for that one, I&#8217;ll use it here too.</p><p><strong>Generate the word frequency files</strong></p><p>I started out by creating a convenience script for running word_frequency and string_frequency multiple times:</p><div class='highlight'><pre><code class='ruby'><span class='n'>ext</span> <span class='o'>=</span> <span class='no'>ARGV</span><span class='o'>[</span><span class='mi'>0</span><span class='o'>]</span>

<span class='p'>(</span><span class='mi'>1</span><span class='o'>.</span><span class='n'>.</span><span class='mi'>10</span><span class='p'>)</span><span class='o'>.</span><span class='n'>each</span> <span class='p'>{</span><span class='o'>|</span><span class='n'>num</span><span class='o'>|</span>
    <span class='nb'>puts</span> <span class='sb'>`ruby -E &#39;iso-8859-1&#39; word_frequency.rb </span><span class='si'>#{</span><span class='n'>num</span><span class='si'>}</span><span class='sb'> </span><span class='si'>#{</span><span class='n'>ext</span><span class='si'>}</span><span class='sb'>`</span>
<span class='p'>}</span>

<span class='p'>(</span><span class='mi'>1</span><span class='o'>.</span><span class='n'>.</span><span class='mi'>10</span><span class='p'>)</span><span class='o'>.</span><span class='n'>each</span> <span class='p'>{</span><span class='o'>|</span><span class='n'>num</span><span class='o'>|</span>
    <span class='nb'>puts</span> <span class='sb'>`ruby -E &#39;iso-8859-1&#39; string_frequency.rb </span><span class='si'>#{</span><span class='n'>num</span><span class='si'>}</span><span class='sb'> </span><span class='si'>#{</span><span class='n'>ext</span><span class='si'>}</span><span class='sb'>`</span>
<span class='p'>}</span>
</code></pre>
</div><p>For now I have to specify the external encoding when running the scripts, as the default behavior for ruby is to assume the files are UTF-8. This ends up in my script throwing an error when it gets to a character like &#169;. There must be a better way to handle files with unknown encodings from within the script, but for now this works.</p><p>So, I copied the above script along with <code>word_frequency.rb</code> and <code>string_frequency.rb</code> to the root of the DWSIM project and ran it:</p><div class='highlight'><pre><code class='bash'>ruby runboth.rb vb
</code></pre>
</div><p>The script should have created a subdirectory called <code>wordfreq</code> in the current directory. Let&#8217;s see what&#8217;s in there:</p><div class='highlight'><pre><code class='bash'>nick@Mengsk:~/prog/word_frequency/dwsim<span class='nv'>$ </span>ls -lh wordfreq/
total 12M
-rw-r--r-- 1 nick nick  802K 2011-08-01 15:22 dwsim-01words.vb.wordfreq
-rw-r--r-- 1 nick nick  1.3M 2011-08-01 15:22 dwsim-02words.vb.wordfreq
-rw-r--r-- 1 nick nick  1.5M 2011-08-01 15:22 dwsim-03words.vb.wordfreq
-rw-r--r-- 1 nick nick  1.4M 2011-08-01 15:23 dwsim-04words.vb.wordfreq
-rw-r--r-- 1 nick nick  1.3M 2011-08-01 15:23 dwsim-05words.vb.wordfreq
-rw-r--r-- 1 nick nick  1.2M 2011-08-01 15:23 dwsim-06words.vb.wordfreq
-rw-r--r-- 1 nick nick  1.1M 2011-08-01 15:23 dwsim-07words.vb.wordfreq
-rw-r--r-- 1 nick nick 1014K 2011-08-01 15:23 dwsim-08words.vb.wordfreq
-rw-r--r-- 1 nick nick  950K 2011-08-01 15:23 dwsim-09words.vb.wordfreq
-rw-r--r-- 1 nick nick  873K 2011-08-01 15:23 dwsim-10words.vb.wordfreq
-rw-r--r-- 1 nick nick   75K 2011-08-01 15:23 dwsim-stringsonly-01words.vb.wordfreq
-rw-r--r-- 1 nick nick   34K 2011-08-01 15:23 dwsim-stringsonly-02words.vb.wordfreq
-rw-r--r-- 1 nick nick   26K 2011-08-01 15:23 dwsim-stringsonly-03words.vb.wordfreq
-rw-r--r-- 1 nick nick   22K 2011-08-01 15:23 dwsim-stringsonly-04words.vb.wordfreq
-rw-r--r-- 1 nick nick   20K 2011-08-01 15:23 dwsim-stringsonly-05words.vb.wordfreq
-rw-r--r-- 1 nick nick   20K 2011-08-01 15:23 dwsim-stringsonly-06words.vb.wordfreq
-rw-r--r-- 1 nick nick   19K 2011-08-01 15:23 dwsim-stringsonly-07words.vb.wordfreq
-rw-r--r-- 1 nick nick   19K 2011-08-01 15:23 dwsim-stringsonly-08words.vb.wordfreq
-rw-r--r-- 1 nick nick   18K 2011-08-01 15:23 dwsim-stringsonly-09words.vb.wordfreq
-rw-r--r-- 1 nick nick   17K 2011-08-01 15:23 dwsim-stringsonly-10words.vb.wordfreq
</code></pre>
</div><p>Looks correct to me. One interesting thing to note is the file size will tend to decrease as the number of words in a phrase increases.</p><p><strong>Analyze the generated files</strong></p><p>Now on to the interesting part!</p><p>I&#8217;m going to start at the top and work my way downwards.</p><p>In <code>dwsim-01words.vb.wordfreq</code>, the top few results are pretty predictable:</p><pre><code>Word Frequency List:
  72445: = 
  29758: As 
  19457: End 
  16282: * 
  14307: If 
  13604: + 
  12354: &#39; 
  11034: Dim </code></pre><p>Language keywords and operators. I&#8217;d worry if this wasn&#8217;t the case.</p><p>Now for some more interesting results:</p><pre><code>   7904: Public 
   1655: Private 
    743: Protected </code></pre><p>There are quite a lot more public functions than private ones. It doesn&#8217;t say much by itself, but learning the reason this project has this ratio could be enlightening. It might be an indicator of poor encapsulation, or just that this project has a large public API.</p><pre><code>   4969: Sub 
   3515: Function </code></pre><p>In VB.NET, a Sub is just a Function that doesn&#8217;t return any values. In C-style languages this is represented by using a <code>void</code> return type. This suggests that most methods rely on modifying shared state to make their results known. It might be explained by other things as well, but this is something I&#8217;d keep an eye out for while reading through the code.</p><pre><code>   5986: ByVal 
    491: ByRef </code></pre><p>In VB.NET you only need to use ByRef if you want to modify a passed in <em>value</em> type (not reference type). It&#8217;s not something that should usually happen a lot, so seeing a lot of usages of ByRef could indicate a misunderstanding of what that keyword actually does or an alarming amount of modifying value type parameters.</p><p>02</p><pre><code>362: CSng(X + 
356: Width), CSng(Y 
355: obj As 
355: R * 
348: * 1.25 
348: 1.25 * 
346: 2 + 
334: Or Vids(i) 
330: Return valor 
325: (1 + 
289: = temp1(2, </code></pre><p>03</p><p>2192: i = 0 1521: = n + 1510: n + 1 348: * 1.25 * 1022: &#8216;UPGRADE_WARNING: Couldn&#8217;t resolve</p><p>04 285: Until j = n 285: j = n + 257: RET_VKij(), RET_VTC, RET_VPC, RET_VW,</p></p>


<div id="gallery">
    <ul>
        
    </ul>
</div>




            </div>
        </div>
        <div id="footer">&copy; Copyright 2011 Nick Knowlson</div>
        <!--  " - 2011" -->
    </body>
</html>
