<html><head><title>./dwsim/dwsim/DWSIM/Classes/Math/LM</title> 
	<style type="text/css">
	    body { font-family: georgia, serif; }
	    h1 { color: #111111 }
	    li { font-family: Consolas, monospace; font-size: 14px; margin-bottom:20px; list-style-type: none; word-wrap:break-word; }
	    .line_count { color: #000080; font-family: Consolas, monospace;}
	    .method_count { color: #008080; font-family: Consolas, monospace;}
	    .signature { font-size: 12px; }
	    .inside_method { background-color: #eeeeee; }
	    .detail_page { font-family: Consolas, monospace; font-size: 14px; word-wrap: break-word}
	    .method_name { background-color: #ccccee ; font-weight: bold; }
	    .type { background-color: aaffbb; font-weight: bold; }
	    .inside_if { background-color:#CCEECC; }
	    .inside_loop { background-color:#EECCCC; }
	    .inside_loop .inside_if { background-color:#BBBBAA; }
	    .inside_if .inside_loop { background-color:#CCAAAA; }
	    .comment { color: #777777; }
	    p { display: inline; margin: 0px; padding: 0px; }
	    div { display: inline; margin: 0px; padding: 0px; }
	    #legend { font-family: Consolas, monospace; font-size: 14px; margin-bottom:10px; }
	    #legend td { padding-right: 15px; }
	</style></head><body>
<h2>./dwsim/dwsim/DWSIM/Classes/Math/LM: <span class='method_count'>10m</span> <span class='line_count'>&nbsp;1118L&nbsp;&nbsp;</span></h2><div class='detail_page'>

    <table id="legend">
	<tr><td style="padding-bottom:10px;"><span style="font-size:18px; font-family: georgia, serif; font-weight: bold;">Legend</span></td></tr>
	<tr><td><span class="method_count">14m</span> means 14 methods</td> <td><span class="line_count">294L</span> means 294 lines</td> </tr>
	<tr><td>a space is a blank line</td><td>. is a (non-blank) line</td> </tr>
	<tr><td><span class='inside_if'>?</span> is a single line If statement</td><td>' is a commented line</td></tr>
        <tr><td><span class='inside_if'>|</span> is an Else or Case statement</td><td><div class='inside_method'>{Inside a method}</div></td></tr>
	<tr><td><span class='inside_if'>(Inside an if block)</span></td><td><p class='inside_loop'>[Inside a loop]</p></td></tr>
	<tr><td><p class='inside_loop'><span class='inside_if'>[(An if block inside a loop)]</span></p></td><td> <span class='inside_if'><p class='inside_loop'>([A loop inside an if block])</p></span></td></tr>
    </table>
. . <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<br>Delegate Sub <span class='method_name'>funcvecjacdelegate</span>&#40;ByRef x <span class='type'>As Double</span><span class='inside_if'>()</span>, ByRef fvec <span class='type'>As Double</span><span class='inside_if'>()</span>, ByRef fjac <span class='type'>As Double</span><span class='inside_if'>(,)</span>, ByRef iflag <span class='type'>As Integer</span>)</span><br> <br>Sub <span class='method_name'>New</span>&#40;)</span><br> <br>End Sub<br> <br>Sub <span class='method_name'>DefineFuncGradDelegate</span>&#40;ByVal fvj <span class='type'>As funcvecjacdelegate</span>)</span><br>.<br>End Sub<br> <br>Public Sub <span class='method_name'>funcvecjac</span>&#40;ByRef x <span class='type'>As Double</span><span class='inside_if'>()</span>, ByRef fvec <span class='type'>As Double</span><span class='inside_if'>()</span>, ByRef fjac <span class='type'>As Double</span><span class='inside_if'>(,)</span>, ByRef iflag <span class='type'>As Integer</span>)</span><br><span class='inside_if'>?</span><br>End Sub<br> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span> <br>Public Sub <span class='method_name'>levenbergmarquardtminimize</span>&#40;ByVal n <span class='type'>As Integer</span>, ByVal m <span class='type'>As Integer</span>, ByRef x <span class='type'>As Double</span><span class='inside_if'>()</span>, ByVal epsg <span class='type'>As Double</span>, ByVal epsf <span class='type'>As Double</span>, ByVal epsx <span class='type'>As Double</span>, _<br>................<span class='inside_if'>?</span>........................&nbsp;&nbsp;<span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>...............<span class='inside_if'>?</span>.. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(..)</span><span class='inside_if'>(..)</span><span class='inside_if'>(..)</span><span class='inside_if'>(<p class='inside_loop'>[<span class='inside_if'>(..)</span>]</p>)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>?</span><span class='inside_if'>?</span>.<span class='inside_if'>(..)</span>.<p class='inside_loop'>[.]</p>. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[ <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>?</span><span class='inside_if'>?</span>.<span class='inside_if'>(..)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(<span class='inside_if'>(<p class='inside_loop'>[.<span class='inside_if'>(.)</span>]</p>)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[.]</p>.<p class='inside_loop'>[.]</p>..<span class='inside_if'>(.)</span>)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[.]</p><p class='inside_loop'>[<span class='inside_if'>(.<p class='inside_loop'>[.]</p>.<p class='inside_loop'>[.]</p>)</span>..]</p> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<span class='inside_if'>(<p class='inside_loop'>[.<span class='inside_if'>(.<p class='inside_loop'>[.]</p>.)</span>]</p>)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(.)</span><span class='inside_if'>(.)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(<p class='inside_loop'>[.]</p>)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[ <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[...]</p>.<p class='inside_loop'>[.]</p>. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(.)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>?</span><span class='inside_if'>?</span>.<span class='inside_if'>(..)</span>.<p class='inside_loop'>[.]</p>. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<span class='inside_if'>(.)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[...<p class='inside_loop'>[.]</p>]</p>.<p class='inside_loop'>[.]</p>.... <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<span class='inside_if'>(.)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(<span class='inside_if'>(..)</span>|<span class='inside_if'>(.)</span><span class='inside_if'>(.)</span><span class='inside_if'>(.)</span>..)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>( <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[..]</p><p class='inside_loop'>[.]</p>.<p class='inside_loop'>[.]</p>...)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(.)</span><span class='inside_if'>(.)</span><span class='inside_if'>(.)</span><span class='inside_if'>(.)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(.)</span><span class='inside_if'>(.)</span><span class='inside_if'>(.)</span><span class='inside_if'>(.)</span><span class='inside_if'>(.)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(<p class='inside_loop'>[)</span><p class='inside_loop'>[]</p> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(..)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>]</p><br>End Sub<br>&nbsp;&nbsp;<br>Private Shared Sub <span class='method_name'>levenbergmarquardtqrfac</span>&#40;ByVal m <span class='type'>As Integer</span>, ByVal n <span class='type'>As Integer</span>, ByRef a <span class='type'>As Double</span><span class='inside_if'>(,)</span>, ByVal pivot <span class='type'>As Boolean</span>, ByRef ipvt <span class='type'>As Integer</span><span class='inside_if'>()</span>, ByRef rdiag <span class='type'>As Double</span><span class='inside_if'>()</span>, _<br>............&nbsp;&nbsp;<span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[<p class='inside_loop'>[.]</p>]</p> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[.<p class='inside_loop'>[.]</p>...<span class='inside_if'>(.)</span>]</p> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<p class='inside_loop'>[<span class='inside_if'>( <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<p class='inside_loop'>[<span class='inside_if'>(.)</span>]</p><span class='inside_if'>(<p class='inside_loop'>[...]</p>.....)</span>)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<p class='inside_loop'>[.]</p>.<span class='inside_if'>(<span class='inside_if'>(.)</span>.<p class='inside_loop'>[.]</p>. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<span class='inside_if'>(<p class='inside_loop'>[.<p class='inside_loop'>[.]</p>.<p class='inside_loop'>[.]</p><span class='inside_if'>(..<span class='inside_if'>(.<p class='inside_loop'>[.]</p>..)</span>)</span>]</p>)</span>)</span>.]</p> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[<p class='inside_loop'>[.]</p>]</p><br>End Sub<br>&nbsp;&nbsp;<br>Private Shared Sub <span class='method_name'>levenbergmarquardtqrsolv</span>&#40;ByVal n <span class='type'>As Integer</span>, ByRef r <span class='type'>As Double</span><span class='inside_if'>(,)</span>, ByRef ipvt <span class='type'>As Integer</span><span class='inside_if'>()</span>, ByRef diag <span class='type'>As Double</span><span class='inside_if'>()</span>, ByRef qtb <span class='type'>As Double</span><span class='inside_if'>()</span>, ByRef x <span class='type'>As Double</span><span class='inside_if'>()</span>, _<br>...............&nbsp;&nbsp;<span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[<p class='inside_loop'>[.]</p>..]</p> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[ <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<span class='inside_if'>(<p class='inside_loop'>[.]</p>. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<p class='inside_loop'>[ <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(<span class='inside_if'>(...|...)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.... <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<span class='inside_if'>(<p class='inside_loop'>[...]</p>)</span>)</span>]</p>)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>..]</p> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<p class='inside_loop'>[<span class='inside_if'>(.)</span><span class='inside_if'>(.)</span>]</p><span class='inside_if'>(<p class='inside_loop'>[...<span class='inside_if'>(<p class='inside_loop'>[.]</p>)</span>.]</p>)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[..]</p><br>End Sub<br>&nbsp;&nbsp;<br>Private Shared Sub <span class='method_name'>levenbergmarquardtpar</span>&#40;ByVal n <span class='type'>As Integer</span>, ByRef r <span class='type'>As Double</span><span class='inside_if'>(,)</span>, ByRef ipvt <span class='type'>As Integer</span><span class='inside_if'>()</span>, ByRef diag <span class='type'>As Double</span><span class='inside_if'>()</span>, ByRef qtb <span class='type'>As Double</span><span class='inside_if'>()</span>, ByVal delta <span class='type'>As Double</span>, _<br>.................... . <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<p class='inside_loop'>[.<span class='inside_if'>(.)</span><span class='inside_if'>(.)</span>]</p><span class='inside_if'>(<p class='inside_loop'>[....<span class='inside_if'>(<p class='inside_loop'>[.]</p>)</span>]</p>)</span><p class='inside_loop'>[..]</p> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<p class='inside_loop'>[.]</p>.<p class='inside_loop'>[.]</p>..<span class='inside_if'>( <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(.)</span>.)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>.<span class='inside_if'>(<p class='inside_loop'>[..]</p><p class='inside_loop'>[..<span class='inside_if'>(<p class='inside_loop'>[.]</p>)</span>.]</p>.<p class='inside_loop'>[.]</p>..)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[.<p class='inside_loop'>[.]</p>..]</p>.<p class='inside_loop'>[.]</p>..<span class='inside_if'>(.)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>..<span class='inside_if'>(.)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(.)</span>.<p class='inside_loop'>[.]</p>..<p class='inside_loop'>[.]</p>.<p class='inside_loop'>[.]</p>... <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(<p class='inside_loop'>[)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><p class='inside_loop'>[..]</p><p class='inside_loop'>[...<span class='inside_if'>(<p class='inside_loop'>[.]</p>)</span>]</p>.<p class='inside_loop'>[.]</p>.. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(.)</span><span class='inside_if'>(.)</span> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>. <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span>]</p> <span class='comment'>'</span><span class='comment'>'</span><span class='comment'>'</span><span class='inside_if'>(.)</span><br>End Sub<br>&nbsp;&nbsp;<br>Private Shared Sub <span class='method_name'>levenbergmarquardtnewiteration</span>&#40;ByRef x <span class='type'>As Double</span><span class='inside_if'>()</span>)</span><br><br>End Sub<br>&nbsp;&nbsp;<br>Private Shared Function <span class='method_name'>additionallevenbergmarquardtstoppingcriterion</span>&#40;ByVal iter <span class='type'>As Integer</span>&#41; <span class='type'>As Boolean</span><br>. ..<br>End Function<br>.&nbsp;&nbsp;.
</div></body></html>
